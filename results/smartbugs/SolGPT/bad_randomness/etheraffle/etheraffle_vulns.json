{"success": true, "error": null, "results": {"detectors": [{"elements": [{"type": "function", "name": "endRaffle", "source_mapping": {"start": 4168, "length": 651, "filename_relative": "shared/bad_randomness/etheraffle.sol", "filename_absolute": "/home/ethsec/shared/bad_randomness/etheraffle.sol", "filename_short": "shared/bad_randomness/etheraffle.sol", "is_dependency": false, "lines": [143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "Ethraffle_v4b", "source_mapping": {"start": 291, "length": 4777, "filename_relative": "shared/bad_randomness/etheraffle.sol", "filename_absolute": "/home/ethsec/shared/bad_randomness/etheraffle.sol", "filename_short": "shared/bad_randomness/etheraffle.sol", "is_dependency": false, "lines": [10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174], "starting_column": 1, "ending_column": 2}}, "signature": "endRaffle()"}}, {"type": "node", "name": "contestants[i].addr.transfer(pricePerTicket)", "source_mapping": {"start": 4467, "length": 44, "filename_relative": "shared/bad_randomness/etheraffle.sol", "filename_absolute": "/home/ethsec/shared/bad_randomness/etheraffle.sol", "filename_short": "shared/bad_randomness/etheraffle.sol", "is_dependency": false, "lines": [150], "starting_column": 21, "ending_column": 65}, "type_specific_fields": {"parent": {"type": "function", "name": "endRaffle", "source_mapping": {"start": 4168, "length": 651, "filename_relative": "shared/bad_randomness/etheraffle.sol", "filename_absolute": "/home/ethsec/shared/bad_randomness/etheraffle.sol", "filename_short": "shared/bad_randomness/etheraffle.sol", "is_dependency": false, "lines": [143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "Ethraffle_v4b", "source_mapping": {"start": 291, "length": 4777, "filename_relative": "shared/bad_randomness/etheraffle.sol", "filename_absolute": "/home/ethsec/shared/bad_randomness/etheraffle.sol", "filename_short": "shared/bad_randomness/etheraffle.sol", "is_dependency": false, "lines": [10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174], "starting_column": 1, "ending_column": 2}}, "signature": "endRaffle()"}}}}], "description": "Ethraffle_v4b.endRaffle() (shared/bad_randomness/etheraffle.sol#143-161) has external calls inside a loop: contestants[i].addr.transfer(pricePerTicket) (shared/bad_randomness/etheraffle.sol#150)\n", "markdown": "[Ethraffle_v4b.endRaffle()](shared/bad_randomness/etheraffle.sol#L143-L161) has external calls inside a loop: [contestants[i].addr.transfer(pricePerTicket)](shared/bad_randomness/etheraffle.sol#L150)\n", "first_markdown_element": "shared/bad_randomness/etheraffle.sol#L143-L161", "id": "ddfed7fbc560895ee6689a83a63317286b6d48f33ce1f771c865dcf9ed060b4e", "check": "calls-loop", "impact": "Low", "confidence": "Medium"}, {"elements": [{"type": "function", "name": "buyTickets", "source_mapping": {"start": 1579, "length": 919, "filename_relative": "shared/bad_randomness/etheraffle.sol", "filename_absolute": "/home/ethsec/shared/bad_randomness/etheraffle.sol", "filename_short": "shared/bad_randomness/etheraffle.sol", "is_dependency": false, "lines": [64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "Ethraffle_v4b", "source_mapping": {"start": 291, "length": 4777, "filename_relative": "shared/bad_randomness/etheraffle.sol", "filename_absolute": "/home/ethsec/shared/bad_randomness/etheraffle.sol", "filename_short": "shared/bad_randomness/etheraffle.sol", "is_dependency": false, "lines": [10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174], "starting_column": 1, "ending_column": 2}}, "signature": "buyTickets()"}}, {"type": "node", "name": "currTicket = nextTicket ++", "source_mapping": {"start": 2013, "length": 25, "filename_relative": "shared/bad_randomness/etheraffle.sol", "filename_absolute": "/home/ethsec/shared/bad_randomness/etheraffle.sol", "filename_short": "shared/bad_randomness/etheraffle.sol", "is_dependency": false, "lines": [78], "starting_column": 17, "ending_column": 42}, "type_specific_fields": {"parent": {"type": "function", "name": "buyTickets", "source_mapping": {"start": 1579, "length": 919, "filename_relative": "shared/bad_randomness/etheraffle.sol", "filename_absolute": "/home/ethsec/shared/bad_randomness/etheraffle.sol", "filename_short": "shared/bad_randomness/etheraffle.sol", "is_dependency": false, "lines": [64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "Ethraffle_v4b", "source_mapping": {"start": 291, "length": 4777, "filename_relative": "shared/bad_randomness/etheraffle.sol", "filename_absolute": "/home/ethsec/shared/bad_randomness/etheraffle.sol", "filename_short": "shared/bad_randomness/etheraffle.sol", "is_dependency": false, "lines": [10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174], "starting_column": 1, "ending_column": 2}}, "signature": "buyTickets()"}}}}], "description": "Ethraffle_v4b.buyTickets() (shared/bad_randomness/etheraffle.sol#64-95) has costly operations inside a loop:\n\t- currTicket = nextTicket ++ (shared/bad_randomness/etheraffle.sol#78)\n", "markdown": "[Ethraffle_v4b.buyTickets()](shared/bad_randomness/etheraffle.sol#L64-L95) has costly operations inside a loop:\n\t- [currTicket = nextTicket ++](shared/bad_randomness/etheraffle.sol#L78)\n", "first_markdown_element": "shared/bad_randomness/etheraffle.sol#L64-L95", "id": "3acaab194311fee16f666abe00dcaed51412a2383510490a0edd2e84a51fdae8", "check": "costly-loop", "impact": "Informational", "confidence": "Medium"}, {"elements": [], "description": "solc-0.4.16 is not recommended for deployment\n", "markdown": "solc-0.4.16 is not recommended for deployment\n", "first_markdown_element": "", "id": "82db78248a4c50d5946da334523137ab7364cea2cdbdab8869e6a42d2060c9bc", "check": "solc-version", "impact": "Informational", "confidence": "High"}, {"elements": [{"type": "pragma", "name": "^0.4.16", "source_mapping": {"start": 265, "length": 24, "filename_relative": "shared/bad_randomness/etheraffle.sol", "filename_absolute": "/home/ethsec/shared/bad_randomness/etheraffle.sol", "filename_short": "shared/bad_randomness/etheraffle.sol", "is_dependency": false, "lines": [8], "starting_column": 2, "ending_column": 26}, "type_specific_fields": {"directive": ["solidity", "^", "0.4", ".16"]}}], "description": "Pragma version^0.4.16 (shared/bad_randomness/etheraffle.sol#8) allows old versions\n", "markdown": "Pragma version[^0.4.16](shared/bad_randomness/etheraffle.sol#L8) allows old versions\n", "first_markdown_element": "shared/bad_randomness/etheraffle.sol#L8", "id": "927c0187d1a95169a042f3d690771f118caa24f92a238d09121572fcbde43b67", "check": "solc-version", "impact": "Informational", "confidence": "High"}, {"elements": [{"type": "contract", "name": "Ethraffle_v4b", "source_mapping": {"start": 291, "length": 4777, "filename_relative": "shared/bad_randomness/etheraffle.sol", "filename_absolute": "/home/ethsec/shared/bad_randomness/etheraffle.sol", "filename_short": "shared/bad_randomness/etheraffle.sol", "is_dependency": false, "lines": [10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174], "starting_column": 1, "ending_column": 2}, "additional_fields": {"target": "contract", "convention": "CapWords"}}], "description": "Contract Ethraffle_v4b (shared/bad_randomness/etheraffle.sol#10-174) is not in CapWords\n", "markdown": "Contract [Ethraffle_v4b](shared/bad_randomness/etheraffle.sol#L10-L174) is not in CapWords\n", "first_markdown_element": "shared/bad_randomness/etheraffle.sol#L10-L174", "id": "ac89b9546c1c525a289f1ff7376b838953ffcb6897527bc8b096e6083ed1f5df", "check": "naming-convention", "impact": "Informational", "confidence": "High"}, {"elements": [{"type": "function", "name": "endRaffle", "source_mapping": {"start": 4168, "length": 651, "filename_relative": "shared/bad_randomness/etheraffle.sol", "filename_absolute": "/home/ethsec/shared/bad_randomness/etheraffle.sol", "filename_short": "shared/bad_randomness/etheraffle.sol", "is_dependency": false, "lines": [143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "Ethraffle_v4b", "source_mapping": {"start": 291, "length": 4777, "filename_relative": "shared/bad_randomness/etheraffle.sol", "filename_absolute": "/home/ethsec/shared/bad_randomness/etheraffle.sol", "filename_short": "shared/bad_randomness/etheraffle.sol", "is_dependency": false, "lines": [10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174], "starting_column": 1, "ending_column": 2}}, "signature": "endRaffle()"}}, {"type": "node", "name": "contestants[i].addr.transfer(pricePerTicket)", "source_mapping": {"start": 4467, "length": 44, "filename_relative": "shared/bad_randomness/etheraffle.sol", "filename_absolute": "/home/ethsec/shared/bad_randomness/etheraffle.sol", "filename_short": "shared/bad_randomness/etheraffle.sol", "is_dependency": false, "lines": [150], "starting_column": 21, "ending_column": 65}, "type_specific_fields": {"parent": {"type": "function", "name": "endRaffle", "source_mapping": {"start": 4168, "length": 651, "filename_relative": "shared/bad_randomness/etheraffle.sol", "filename_absolute": "/home/ethsec/shared/bad_randomness/etheraffle.sol", "filename_short": "shared/bad_randomness/etheraffle.sol", "is_dependency": false, "lines": [143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "Ethraffle_v4b", "source_mapping": {"start": 291, "length": 4777, "filename_relative": "shared/bad_randomness/etheraffle.sol", "filename_absolute": "/home/ethsec/shared/bad_randomness/etheraffle.sol", "filename_short": "shared/bad_randomness/etheraffle.sol", "is_dependency": false, "lines": [10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174], "starting_column": 1, "ending_column": 2}}, "signature": "endRaffle()"}}}, "additional_fields": {"underlying_type": "external_calls"}}, {"type": "node", "name": "blockNumber = block.number", "source_mapping": {"start": 4747, "length": 26, "filename_relative": "shared/bad_randomness/etheraffle.sol", "filename_absolute": "/home/ethsec/shared/bad_randomness/etheraffle.sol", "filename_short": "shared/bad_randomness/etheraffle.sol", "is_dependency": false, "lines": [158], "starting_column": 13, "ending_column": 39}, "type_specific_fields": {"parent": {"type": "function", "name": "endRaffle", "source_mapping": {"start": 4168, "length": 651, "filename_relative": "shared/bad_randomness/etheraffle.sol", "filename_absolute": "/home/ethsec/shared/bad_randomness/etheraffle.sol", "filename_short": "shared/bad_randomness/etheraffle.sol", "is_dependency": false, "lines": [143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "Ethraffle_v4b", "source_mapping": {"start": 291, "length": 4777, "filename_relative": "shared/bad_randomness/etheraffle.sol", "filename_absolute": "/home/ethsec/shared/bad_randomness/etheraffle.sol", "filename_short": "shared/bad_randomness/etheraffle.sol", "is_dependency": false, "lines": [10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174], "starting_column": 1, "ending_column": 2}}, "signature": "endRaffle()"}}}, "additional_fields": {"underlying_type": "variables_written", "variable_name": "blockNumber"}}, {"type": "node", "name": "gaps.length = 0", "source_mapping": {"start": 4787, "length": 15, "filename_relative": "shared/bad_randomness/etheraffle.sol", "filename_absolute": "/home/ethsec/shared/bad_randomness/etheraffle.sol", "filename_short": "shared/bad_randomness/etheraffle.sol", "is_dependency": false, "lines": [159], "starting_column": 13, "ending_column": 28}, "type_specific_fields": {"parent": {"type": "function", "name": "endRaffle", "source_mapping": {"start": 4168, "length": 651, "filename_relative": "shared/bad_randomness/etheraffle.sol", "filename_absolute": "/home/ethsec/shared/bad_randomness/etheraffle.sol", "filename_short": "shared/bad_randomness/etheraffle.sol", "is_dependency": false, "lines": [143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "Ethraffle_v4b", "source_mapping": {"start": 291, "length": 4777, "filename_relative": "shared/bad_randomness/etheraffle.sol", "filename_absolute": "/home/ethsec/shared/bad_randomness/etheraffle.sol", "filename_short": "shared/bad_randomness/etheraffle.sol", "is_dependency": false, "lines": [10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174], "starting_column": 1, "ending_column": 2}}, "signature": "endRaffle()"}}}, "additional_fields": {"underlying_type": "variables_written", "variable_name": "gaps"}}, {"type": "node", "name": "nextTicket = 0", "source_mapping": {"start": 4674, "length": 14, "filename_relative": "shared/bad_randomness/etheraffle.sol", "filename_absolute": "/home/ethsec/shared/bad_randomness/etheraffle.sol", "filename_short": "shared/bad_randomness/etheraffle.sol", "is_dependency": false, "lines": [156], "starting_column": 13, "ending_column": 27}, "type_specific_fields": {"parent": {"type": "function", "name": "endRaffle", "source_mapping": {"start": 4168, "length": 651, "filename_relative": "shared/bad_randomness/etheraffle.sol", "filename_absolute": "/home/ethsec/shared/bad_randomness/etheraffle.sol", "filename_short": "shared/bad_randomness/etheraffle.sol", "is_dependency": false, "lines": [143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "Ethraffle_v4b", "source_mapping": {"start": 291, "length": 4777, "filename_relative": "shared/bad_randomness/etheraffle.sol", "filename_absolute": "/home/ethsec/shared/bad_randomness/etheraffle.sol", "filename_short": "shared/bad_randomness/etheraffle.sol", "is_dependency": false, "lines": [10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174], "starting_column": 1, "ending_column": 2}}, "signature": "endRaffle()"}}}, "additional_fields": {"underlying_type": "variables_written", "variable_name": "nextTicket"}}, {"type": "node", "name": "raffleId ++", "source_mapping": {"start": 4650, "length": 10, "filename_relative": "shared/bad_randomness/etheraffle.sol", "filename_absolute": "/home/ethsec/shared/bad_randomness/etheraffle.sol", "filename_short": "shared/bad_randomness/etheraffle.sol", "is_dependency": false, "lines": [155], "starting_column": 13, "ending_column": 23}, "type_specific_fields": {"parent": {"type": "function", "name": "endRaffle", "source_mapping": {"start": 4168, "length": 651, "filename_relative": "shared/bad_randomness/etheraffle.sol", "filename_absolute": "/home/ethsec/shared/bad_randomness/etheraffle.sol", "filename_short": "shared/bad_randomness/etheraffle.sol", "is_dependency": false, "lines": [143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "Ethraffle_v4b", "source_mapping": {"start": 291, "length": 4777, "filename_relative": "shared/bad_randomness/etheraffle.sol", "filename_absolute": "/home/ethsec/shared/bad_randomness/etheraffle.sol", "filename_short": "shared/bad_randomness/etheraffle.sol", "is_dependency": false, "lines": [10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174], "starting_column": 1, "ending_column": 2}}, "signature": "endRaffle()"}}}, "additional_fields": {"underlying_type": "variables_written", "variable_name": "raffleId"}}, {"type": "node", "name": "RaffleResult(raffleId,totalTickets,address(0),address(0),address(0),0,0)", "source_mapping": {"start": 4558, "length": 78, "filename_relative": "shared/bad_randomness/etheraffle.sol", "filename_absolute": "/home/ethsec/shared/bad_randomness/etheraffle.sol", "filename_short": "shared/bad_randomness/etheraffle.sol", "is_dependency": false, "lines": [154], "starting_column": 13, "ending_column": 91}, "type_specific_fields": {"parent": {"type": "function", "name": "endRaffle", "source_mapping": {"start": 4168, "length": 651, "filename_relative": "shared/bad_randomness/etheraffle.sol", "filename_absolute": "/home/ethsec/shared/bad_randomness/etheraffle.sol", "filename_short": "shared/bad_randomness/etheraffle.sol", "is_dependency": false, "lines": [143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "Ethraffle_v4b", "source_mapping": {"start": 291, "length": 4777, "filename_relative": "shared/bad_randomness/etheraffle.sol", "filename_absolute": "/home/ethsec/shared/bad_randomness/etheraffle.sol", "filename_short": "shared/bad_randomness/etheraffle.sol", "is_dependency": false, "lines": [10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174], "starting_column": 1, "ending_column": 2}}, "signature": "endRaffle()"}}}, "additional_fields": {"underlying_type": "event"}}, {"type": "node", "name": "TicketRefund(raffleId,contestants[i].addr,i)", "source_mapping": {"start": 4399, "length": 46, "filename_relative": "shared/bad_randomness/etheraffle.sol", "filename_absolute": "/home/ethsec/shared/bad_randomness/etheraffle.sol", "filename_short": "shared/bad_randomness/etheraffle.sol", "is_dependency": false, "lines": [149], "starting_column": 21, "ending_column": 67}, "type_specific_fields": {"parent": {"type": "function", "name": "endRaffle", "source_mapping": {"start": 4168, "length": 651, "filename_relative": "shared/bad_randomness/etheraffle.sol", "filename_absolute": "/home/ethsec/shared/bad_randomness/etheraffle.sol", "filename_short": "shared/bad_randomness/etheraffle.sol", "is_dependency": false, "lines": [143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "Ethraffle_v4b", "source_mapping": {"start": 291, "length": 4777, "filename_relative": "shared/bad_randomness/etheraffle.sol", "filename_absolute": "/home/ethsec/shared/bad_randomness/etheraffle.sol", "filename_short": "shared/bad_randomness/etheraffle.sol", "is_dependency": false, "lines": [10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174], "starting_column": 1, "ending_column": 2}}, "signature": "endRaffle()"}}}, "additional_fields": {"underlying_type": "event"}}], "description": "Reentrancy in Ethraffle_v4b.endRaffle() (shared/bad_randomness/etheraffle.sol#143-161):\n\tExternal calls:\n\t- contestants[i].addr.transfer(pricePerTicket) (shared/bad_randomness/etheraffle.sol#150)\n\tState variables written after the call(s):\n\t- blockNumber = block.number (shared/bad_randomness/etheraffle.sol#158)\n\t- gaps.length = 0 (shared/bad_randomness/etheraffle.sol#159)\n\t- nextTicket = 0 (shared/bad_randomness/etheraffle.sol#156)\n\t- raffleId ++ (shared/bad_randomness/etheraffle.sol#155)\n\tEvent emitted after the call(s):\n\t- RaffleResult(raffleId,totalTickets,address(0),address(0),address(0),0,0) (shared/bad_randomness/etheraffle.sol#154)\n\t- TicketRefund(raffleId,contestants[i].addr,i) (shared/bad_randomness/etheraffle.sol#149)\n", "markdown": "Reentrancy in [Ethraffle_v4b.endRaffle()](shared/bad_randomness/etheraffle.sol#L143-L161):\n\tExternal calls:\n\t- [contestants[i].addr.transfer(pricePerTicket)](shared/bad_randomness/etheraffle.sol#L150)\n\tState variables written after the call(s):\n\t- [blockNumber = block.number](shared/bad_randomness/etheraffle.sol#L158)\n\t- [gaps.length = 0](shared/bad_randomness/etheraffle.sol#L159)\n\t- [nextTicket = 0](shared/bad_randomness/etheraffle.sol#L156)\n\t- [raffleId ++](shared/bad_randomness/etheraffle.sol#L155)\n\tEvent emitted after the call(s):\n\t- [RaffleResult(raffleId,totalTickets,address(0),address(0),address(0),0,0)](shared/bad_randomness/etheraffle.sol#L154)\n\t- [TicketRefund(raffleId,contestants[i].addr,i)](shared/bad_randomness/etheraffle.sol#L149)\n", "first_markdown_element": "shared/bad_randomness/etheraffle.sol#L143-L161", "id": "b51aa2d0e221b7605550485dec8ecb0379a7b7db791716be29c7bd399a2a71c3", "check": "reentrancy-unlimited-gas", "impact": "Informational", "confidence": "Medium"}]}}