2024-07-04 18:56:09,953 - root - INFO - 
Reading file 'phishable.sol' 

2024-07-04 18:56:09,954 - root - INFO - 
Pragma: 0.4.22 

2024-07-04 18:56:09,954 - root - INFO - 
Processing /home/mokita/sc_study/smartbugs-curated/dataset/access_control/phishable.sol 

2024-07-04 18:56:09,954 - root - INFO - 
try 1/4: /home/mokita/sc_study/smartbugs-curated/dataset/access_control/phishable_1round.sol  

2024-07-04 18:56:09,962 - root - INFO - 

        Docker container name: slither
        Docker image name: trailofbits/eth-security-toolbox
        Docker shared folder: /home/mokita/sc_study/smartbugs-curated/dataset:/home/ethsec/shared
        Docker command: None
         

2024-07-04 18:56:09,965 - root - INFO - 
Running command: solc-select use --always-install 0.4.22 

2024-07-04 18:56:10,203 - root - INFO - 
Running command: slither shared/access_control/phishable.sol --json - 

2024-07-04 18:56:10,932 - root - INFO - 
b'{"success": true, "error": null, "results": {"detectors": [{"elements": [{"type": "function", "name": "withdrawAll", "source_mapping": {"start": 307, "length": 176, "filename_relative": "shared/access_control/phishable.sol", "filename_absolute": "/home/ethsec/shared/access_control/phishable.sol", "filename_short": "shared/access_control/phishable.sol", "is_dependency": false, "lines": [18, 19, 20, 21, 22], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "Phishable", "source_mapping": {"start": 137, "length": 348, "filename_relative": "shared/access_control/phishable.sol", "filename_absolute": "/home/ethsec/shared/access_control/phishable.sol", "filename_short": "shared/access_control/phishable.sol", "is_dependency": false, "lines": [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23], "starting_column": 2, "ending_column": 2}}, "signature": "withdrawAll(address)"}}, {"type": "node", "name": "_recipient.transfer(this.balance)", "source_mapping": {"start": 443, "length": 33, "filename_relative": "shared/access_control/phishable.sol", "filename_absolute": "/home/ethsec/shared/access_control/phishable.sol", "filename_short": "shared/access_control/phishable.sol", "is_dependency": false, "lines": [21], "starting_column": 9, "ending_column": 42}, "type_specific_fields": {"parent": {"type": "function", "name": "withdrawAll", "source_mapping": {"start": 307, "length": 176, "filename_relative": "shared/access_control/phishable.sol", "filename_absolute": "/home/ethsec/shared/access_control/phishable.sol", "filename_short": "shared/access_control/phishable.sol", "is_dependency": false, "lines": [18, 19, 20, 21, 22], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "Phishable", "source_mapping": {"start": 137, "length": 348, "filename_relative": "shared/access_control/phishable.sol", "filename_absolute": "/home/ethsec/shared/access_control/phishable.sol", "filename_short": "shared/access_control/phishable.sol", "is_dependency": false, "lines": [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23], "starting_column": 2, "ending_column": 2}}, "signature": "withdrawAll(address)"}}}}], "description": "Phishable.withdrawAll(address) (shared/access_control/phishable.sol#18-22) sends eth to arbitrary user\\n\\tDangerous calls:\\n\\t- _recipient.transfer(this.balance) (shared/access_control/phishable.sol#21)\\n", "markdown": "[Phishable.withdrawAll(address)](shared/access_control/phishable.sol#L18-L22) sends eth to arbitrary user\\n\\tDangerous calls:\\n\\t- [_recipient.transfer(this.balance)](shared/access_control/phishable.sol#L21)\\n", "first_markdown_element": "shared/access_control/phishable.sol#L18-L22", "id": "5697044f6e677990afc09c429d0b8b11eda5cb5b11204ebd04b52dc823e7ffa3", "check": "arbitrary-send-eth", "impact": "High", "confidence": "Medium"}, {"elements": [{"type": "function", "name": "withdrawAll", "source_mapping": {"start": 307, "length": 176, "filename_relative": "shared/access_control/phishable.sol", "filename_absolute": "/home/ethsec/shared/access_control/phishable.sol", "filename_short": "shared/access_control/phishable.sol", "is_dependency": false, "lines": [18, 19, 20, 21, 22], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "Phishable", "source_mapping": {"start": 137, "length": 348, "filename_relative": "shared/access_control/phishable.sol", "filename_absolute": "/home/ethsec/shared/access_control/phishable.sol", "filename_short": "shared/access_control/phishable.sol", "is_dependency": false, "lines": [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23], "starting_column": 2, "ending_column": 2}}, "signature": "withdrawAll(address)"}}, {"type": "node", "name": "require(bool)(tx.origin == owner)", "source_mapping": {"start": 406, "length": 27, "filename_relative": "shared/access_control/phishable.sol", "filename_absolute": "/home/ethsec/shared/access_control/phishable.sol", "filename_short": "shared/access_control/phishable.sol", "is_dependency": false, "lines": [20], "starting_column": 9, "ending_column": 36}, "type_specific_fields": {"parent": {"type": "function", "name": "withdrawAll", "source_mapping": {"start": 307, "length": 176, "filename_relative": "shared/access_control/phishable.sol", "filename_absolute": "/home/ethsec/shared/access_control/phishable.sol", "filename_short": "shared/access_control/phishable.sol", "is_dependency": false, "lines": [18, 19, 20, 21, 22], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "Phishable", "source_mapping": {"start": 137, "length": 348, "filename_relative": "shared/access_control/phishable.sol", "filename_absolute": "/home/ethsec/shared/access_control/phishable.sol", "filename_short": "shared/access_control/phishable.sol", "is_dependency": false, "lines": [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23], "starting_column": 2, "ending_column": 2}}, "signature": "withdrawAll(address)"}}}}], "description": "Phishable.withdrawAll(address) (shared/access_control/phishable.sol#18-22) uses tx.origin for authorization: require(bool)(tx.origin == owner) (shared/access_control/phishable.sol#20)\\n", "markdown": "[Phishable.withdrawAll(address)](shared/access_control/phishable.sol#L18-L22) uses tx.origin for authorization: [require(bool)(tx.origin == owner)](shared/access_control/phishable.sol#L20)\\n", "first_markdown_element": "shared/access_control/phishable.sol#L18-L22", "id": "f74ee589d060e2627b38056ae9aca72bcc3871129f5244f7405d44f9eccccaad", "check": "tx-origin", "impact": "Medium", "confidence": "Medium"}, {"elements": [{"type": "variable", "name": "_recipient", "source_mapping": {"start": 328, "length": 18, "filename_relative": "shared/access_control/phishable.sol", "filename_absolute": "/home/ethsec/shared/access_control/phishable.sol", "filename_short": "shared/access_control/phishable.sol", "is_dependency": false, "lines": [18], "starting_column": 26, "ending_column": 44}, "type_specific_fields": {"parent": {"type": "function", "name": "withdrawAll", "source_mapping": {"start": 307, "length": 176, "filename_relative": "shared/access_control/phishable.sol", "filename_absolute": "/home/ethsec/shared/access_control/phishable.sol", "filename_short": "shared/access_control/phishable.sol", "is_dependency": false, "lines": [18, 19, 20, 21, 22], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "Phishable", "source_mapping": {"start": 137, "length": 348, "filename_relative": "shared/access_control/phishable.sol", "filename_absolute": "/home/ethsec/shared/access_control/phishable.sol", "filename_short": "shared/access_control/phishable.sol", "is_dependency": false, "lines": [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23], "starting_column": 2, "ending_column": 2}}, "signature": "withdrawAll(address)"}}}}, {"type": "node", "name": "_recipient.transfer(this.balance)", "source_mapping": {"start": 443, "length": 33, "filename_relative": "shared/access_control/phishable.sol", "filename_absolute": "/home/ethsec/shared/access_control/phishable.sol", "filename_short": "shared/access_control/phishable.sol", "is_dependency": false, "lines": [21], "starting_column": 9, "ending_column": 42}, "type_specific_fields": {"parent": {"type": "function", "name": "withdrawAll", "source_mapping": {"start": 307, "length": 176, "filename_relative": "shared/access_control/phishable.sol", "filename_absolute": "/home/ethsec/shared/access_control/phishable.sol", "filename_short": "shared/access_control/phishable.sol", "is_dependency": false, "lines": [18, 19, 20, 21, 22], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "Phishable", "source_mapping": {"start": 137, "length": 348, "filename_relative": "shared/access_control/phishable.sol", "filename_absolute": "/home/ethsec/shared/access_control/phishable.sol", "filename_short": "shared/access_control/phishable.sol", "is_dependency": false, "lines": [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23], "starting_column": 2, "ending_column": 2}}, "signature": "withdrawAll(address)"}}}}], "description": "Phishable.withdrawAll(address)._recipient (shared/access_control/phishable.sol#18) lacks a zero-check on :\\n\\t\\t- _recipient.transfer(this.balance) (shared/access_control/phishable.sol#21)\\n", "markdown": "[Phishable.withdrawAll(address)._recipient](shared/access_control/phishable.sol#L18) lacks a zero-check on :\\n\\t\\t- [_recipient.transfer(this.balance)](shared/access_control/phishable.sol#L21)\\n", "first_markdown_element": "shared/access_control/phishable.sol#L18", "id": "3dda2b4f12359977c0a20debae7bbdae80642b3c13cf141aff5c92a2cf6b03b3", "check": "missing-zero-check", "impact": "Low", "confidence": "Medium"}, {"elements": [{"type": "variable", "name": "_owner", "source_mapping": {"start": 202, "length": 14, "filename_relative": "shared/access_control/phishable.sol", "filename_absolute": "/home/ethsec/shared/access_control/phishable.sol", "filename_short": "shared/access_control/phishable.sol", "is_dependency": false, "lines": [12], "starting_column": 18, "ending_column": 32}, "type_specific_fields": {"parent": {"type": "function", "name": "constructor", "source_mapping": {"start": 189, "length": 60, "filename_relative": "shared/access_control/phishable.sol", "filename_absolute": "/home/ethsec/shared/access_control/phishable.sol", "filename_short": "shared/access_control/phishable.sol", "is_dependency": false, "lines": [12, 13, 14], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "Phishable", "source_mapping": {"start": 137, "length": 348, "filename_relative": "shared/access_control/phishable.sol", "filename_absolute": "/home/ethsec/shared/access_control/phishable.sol", "filename_short": "shared/access_control/phishable.sol", "is_dependency": false, "lines": [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23], "starting_column": 2, "ending_column": 2}}, "signature": "constructor(address)"}}}}, {"type": "node", "name": "owner = _owner", "source_mapping": {"start": 228, "length": 14, "filename_relative": "shared/access_control/phishable.sol", "filename_absolute": "/home/ethsec/shared/access_control/phishable.sol", "filename_short": "shared/access_control/phishable.sol", "is_dependency": false, "lines": [13], "starting_column": 9, "ending_column": 23}, "type_specific_fields": {"parent": {"type": "function", "name": "constructor", "source_mapping": {"start": 189, "length": 60, "filename_relative": "shared/access_control/phishable.sol", "filename_absolute": "/home/ethsec/shared/access_control/phishable.sol", "filename_short": "shared/access_control/phishable.sol", "is_dependency": false, "lines": [12, 13, 14], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "Phishable", "source_mapping": {"start": 137, "length": 348, "filename_relative": "shared/access_control/phishable.sol", "filename_absolute": "/home/ethsec/shared/access_control/phishable.sol", "filename_short": "shared/access_control/phishable.sol", "is_dependency": false, "lines": [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23], "starting_column": 2, "ending_column": 2}}, "signature": "constructor(address)"}}}}], "description": "Phishable.constructor(address)._owner (shared/access_control/phishable.sol#12) lacks a zero-check on :\\n\\t\\t- owner = _owner (shared/access_control/phishable.sol#13)\\n", "markdown": "[Phishable.constructor(address)._owner](shared/access_control/phishable.sol#L12) lacks a zero-check on :\\n\\t\\t- [owner = _owner](shared/access_control/phishable.sol#L13)\\n", "first_markdown_element": "shared/access_control/phishable.sol#L12", "id": "e04de587223ef17fe47dec5ad7814bec598cd2abd7ad2bf4806f3f18ae9118c4", "check": "missing-zero-check", "impact": "Low", "confidence": "Medium"}, {"elements": [], "description": "solc-0.4.22 is known to contain severe issues (https://solidity.readthedocs.io/en/latest/bugs.html)", "markdown": "solc-0.4.22 is known to contain severe issues (https://solidity.readthedocs.io/en/latest/bugs.html)", "first_markdown_element": "", "id": "113041d02ad8d8c1f0a9137c4392269953828a030c22dc283813c1c6df7f407e", "check": "solc-version", "impact": "Informational", "confidence": "High"}, {"elements": [{"type": "pragma", "name": "^0.4.22", "source_mapping": {"start": 110, "length": 24, "filename_relative": "shared/access_control/phishable.sol", "filename_absolute": "/home/ethsec/shared/access_control/phishable.sol", "filename_short": "shared/access_control/phishable.sol", "is_dependency": false, "lines": [7], "starting_column": 2, "ending_column": 26}, "type_specific_fields": {"directive": ["solidity", "^", "0.4", ".22"]}}], "description": "Pragma version^0.4.22 (shared/access_control/phishable.sol#7) is known to contain severe issues (https://solidity.readthedocs.io/en/latest/bugs.html)\\n", "markdown": "Pragma version[^0.4.22](shared/access_control/phishable.sol#L7) is known to contain severe issues (https://solidity.readthedocs.io/en/latest/bugs.html)\\n", "first_markdown_element": "shared/access_control/phishable.sol#L7", "id": "45984b5902dd41160458437f72c5450d6c289d9099fa858dc250539931df6707", "check": "solc-version", "impact": "Informational", "confidence": "High"}, {"elements": [{"type": "variable", "name": "_recipient", "source_mapping": {"start": 328, "length": 18, "filename_relative": "shared/access_control/phishable.sol", "filename_absolute": "/home/ethsec/shared/access_control/phishable.sol", "filename_short": "shared/access_control/phishable.sol", "is_dependency": false, "lines": [18], "starting_column": 26, "ending_column": 44}, "type_specific_fields": {"parent": {"type": "function", "name": "withdrawAll", "source_mapping": {"start": 307, "length": 176, "filename_relative": "shared/access_control/phishable.sol", "filename_absolute": "/home/ethsec/shared/access_control/phishable.sol", "filename_short": "shared/access_control/phishable.sol", "is_dependency": false, "lines": [18, 19, 20, 21, 22], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "Phishable", "source_mapping": {"start": 137, "length": 348, "filename_relative": "shared/access_control/phishable.sol", "filename_absolute": "/home/ethsec/shared/access_control/phishable.sol", "filename_short": "shared/access_control/phishable.sol", "is_dependency": false, "lines": [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23], "starting_column": 2, "ending_column": 2}}, "signature": "withdrawAll(address)"}}}, "additional_fields": {"target": "parameter", "convention": "mixedCase"}}], "description": "Parameter Phishable.withdrawAll(address)._recipient (shared/access_control/phishable.sol#18) is not in mixedCase\\n", "markdown": "Parameter [Phishable.withdrawAll(address)._recipient](shared/access_control/phishable.sol#L18) is not in mixedCase\\n", "first_markdown_element": "shared/access_control/phishable.sol#L18", "id": "2700e29905556c658df8cb6d8f0fd2a99efdc03a50d267cb999954f45765f50a", "check": "naming-convention", "impact": "Informational", "confidence": "High"}]}}\n' 

2024-07-04 18:56:10,935 - root - INFO - 
Found 2 vulnerabilities of severity Medium 

2024-07-04 18:56:12,166 - root - INFO - 
NEW CODE: pragma solidity ^0.4.22;

contract Phishable {
    address public owner;

    constructor (address _owner) {
        owner = _owner;
    }

    function () public payable {} 

    function withdrawAll(address _recipient) public {
        require(msg.sender == owner);
        _recipient.transfer(this.balance);
    }
} 

2024-07-04 18:56:12,166 - root - INFO - 
try 2/4: /home/mokita/sc_study/smartbugs-curated/dataset/access_control/phishable_2round.sol  

2024-07-04 18:56:12,167 - root - INFO - 
Found 2 vulnerabilities of severity Medium 

2024-07-04 18:56:13,394 - root - INFO - 
NEW CODE: pragma solidity ^0.4.22;

contract Phishable {
    address public owner;

    constructor (address _owner) {
        owner = _owner;
    }

    function () public payable {} 

    function withdrawAll(address _recipient) public {
        require(msg.sender == owner);
        _recipient.transfer(this.balance);
    }
} 

2024-07-04 18:56:13,394 - root - INFO - 
try 3/4: /home/mokita/sc_study/smartbugs-curated/dataset/access_control/phishable_3round.sol  

2024-07-04 18:56:13,394 - root - INFO - 
Found 2 vulnerabilities of severity Medium 

2024-07-04 18:56:14,725 - root - INFO - 
NEW CODE: pragma solidity ^0.4.22;

contract Phishable {
    address public owner;

    constructor (address _owner) {
        owner = _owner;
    }

    function () public payable {} 

    function withdrawAll(address _recipient) public {
        require(msg.sender == owner);
        _recipient.transfer(this.balance);
    }
} 

2024-07-04 18:56:14,726 - root - INFO - 
try 4/4: /home/mokita/sc_study/smartbugs-curated/dataset/access_control/phishable_4round.sol  

2024-07-04 18:56:14,726 - root - INFO - 
Found 2 vulnerabilities of severity Medium 

2024-07-04 18:56:15,952 - root - INFO - 
NEW CODE: pragma solidity ^0.4.22;

contract Phishable {
    address public owner;

    constructor (address _owner) {
        owner = _owner;
    }

    function () public payable {} 

    function withdrawAll(address _recipient) public {
        require(msg.sender == owner);
        _recipient.transfer(this.balance);
    }
} 

