2024-07-04 19:00:49,353 - root - INFO - 
Reading file 'FibonacciBalance.sol' 

2024-07-04 19:00:49,355 - root - INFO - 
Pragma: 0.4.22 

2024-07-04 19:00:49,355 - root - INFO - 
Processing /home/mokita/sc_study/smartbugs-curated/dataset/access_control/FibonacciBalance.sol 

2024-07-04 19:00:49,355 - root - INFO - 
try 1/4: /home/mokita/sc_study/smartbugs-curated/dataset/access_control/FibonacciBalance_1round.sol  

2024-07-04 19:00:49,362 - root - INFO - 

        Docker container name: slither
        Docker image name: trailofbits/eth-security-toolbox
        Docker shared folder: /home/mokita/sc_study/smartbugs-curated/dataset:/home/ethsec/shared
        Docker command: None
         

2024-07-04 19:00:49,364 - root - INFO - 
Running command: solc-select use --always-install 0.4.22 

2024-07-04 19:00:49,526 - root - INFO - 
Running command: slither shared/access_control/FibonacciBalance.sol --json - 

2024-07-04 19:00:50,222 - root - INFO - 
b'{"success": true, "error": null, "results": {"detectors": [{"elements": [{"type": "function", "name": "withdraw", "source_mapping": {"start": 710, "length": 350, "filename_relative": "shared/access_control/FibonacciBalance.sol", "filename_absolute": "/home/ethsec/shared/access_control/FibonacciBalance.sol", "filename_short": "shared/access_control/FibonacciBalance.sol", "is_dependency": false, "lines": [26, 27, 28, 29, 30, 31, 32, 33], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "FibonacciBalance", "source_mapping": {"start": 174, "length": 1073, "filename_relative": "shared/access_control/FibonacciBalance.sol", "filename_absolute": "/home/ethsec/shared/access_control/FibonacciBalance.sol", "filename_short": "shared/access_control/FibonacciBalance.sol", "is_dependency": false, "lines": [10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40], "starting_column": 1, "ending_column": 2}}, "signature": "withdraw()"}}, {"type": "node", "name": "msg.sender.transfer(calculatedFibNumber * 1000000000000000000)", "source_mapping": {"start": 1003, "length": 50, "filename_relative": "shared/access_control/FibonacciBalance.sol", "filename_absolute": "/home/ethsec/shared/access_control/FibonacciBalance.sol", "filename_short": "shared/access_control/FibonacciBalance.sol", "is_dependency": false, "lines": [32], "starting_column": 9, "ending_column": 59}, "type_specific_fields": {"parent": {"type": "function", "name": "withdraw", "source_mapping": {"start": 710, "length": 350, "filename_relative": "shared/access_control/FibonacciBalance.sol", "filename_absolute": "/home/ethsec/shared/access_control/FibonacciBalance.sol", "filename_short": "shared/access_control/FibonacciBalance.sol", "is_dependency": false, "lines": [26, 27, 28, 29, 30, 31, 32, 33], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "FibonacciBalance", "source_mapping": {"start": 174, "length": 1073, "filename_relative": "shared/access_control/FibonacciBalance.sol", "filename_absolute": "/home/ethsec/shared/access_control/FibonacciBalance.sol", "filename_short": "shared/access_control/FibonacciBalance.sol", "is_dependency": false, "lines": [10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40], "starting_column": 1, "ending_column": 2}}, "signature": "withdraw()"}}}}], "description": "FibonacciBalance.withdraw() (shared/access_control/FibonacciBalance.sol#26-33) sends eth to arbitrary user\\n\\tDangerous calls:\\n\\t- msg.sender.transfer(calculatedFibNumber * 1000000000000000000) (shared/access_control/FibonacciBalance.sol#32)\\n", "markdown": "[FibonacciBalance.withdraw()](shared/access_control/FibonacciBalance.sol#L26-L33) sends eth to arbitrary user\\n\\tDangerous calls:\\n\\t- [msg.sender.transfer(calculatedFibNumber * 1000000000000000000)](shared/access_control/FibonacciBalance.sol#L32)\\n", "first_markdown_element": "shared/access_control/FibonacciBalance.sol#L26-L33", "id": "1644208c97e31d53087e09b7063d8ac0b34dbc76690f3781f5ebc2cd51f1c68a", "check": "arbitrary-send-eth", "impact": "High", "confidence": "Medium"}, {"elements": [{"type": "function", "name": "withdraw", "source_mapping": {"start": 710, "length": 350, "filename_relative": "shared/access_control/FibonacciBalance.sol", "filename_absolute": "/home/ethsec/shared/access_control/FibonacciBalance.sol", "filename_short": "shared/access_control/FibonacciBalance.sol", "is_dependency": false, "lines": [26, 27, 28, 29, 30, 31, 32, 33], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "FibonacciBalance", "source_mapping": {"start": 174, "length": 1073, "filename_relative": "shared/access_control/FibonacciBalance.sol", "filename_absolute": "/home/ethsec/shared/access_control/FibonacciBalance.sol", "filename_short": "shared/access_control/FibonacciBalance.sol", "is_dependency": false, "lines": [10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40], "starting_column": 1, "ending_column": 2}}, "signature": "withdraw()"}}, {"type": "node", "name": "require(bool)(fibonacciLibrary.delegatecall(fibSig,withdrawalCounter))", "source_mapping": {"start": 928, "length": 65, "filename_relative": "shared/access_control/FibonacciBalance.sol", "filename_absolute": "/home/ethsec/shared/access_control/FibonacciBalance.sol", "filename_short": "shared/access_control/FibonacciBalance.sol", "is_dependency": false, "lines": [31], "starting_column": 9, "ending_column": 74}, "type_specific_fields": {"parent": {"type": "function", "name": "withdraw", "source_mapping": {"start": 710, "length": 350, "filename_relative": "shared/access_control/FibonacciBalance.sol", "filename_absolute": "/home/ethsec/shared/access_control/FibonacciBalance.sol", "filename_short": "shared/access_control/FibonacciBalance.sol", "is_dependency": false, "lines": [26, 27, 28, 29, 30, 31, 32, 33], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "FibonacciBalance", "source_mapping": {"start": 174, "length": 1073, "filename_relative": "shared/access_control/FibonacciBalance.sol", "filename_absolute": "/home/ethsec/shared/access_control/FibonacciBalance.sol", "filename_short": "shared/access_control/FibonacciBalance.sol", "is_dependency": false, "lines": [10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40], "starting_column": 1, "ending_column": 2}}, "signature": "withdraw()"}}}}], "description": "FibonacciBalance.withdraw() (shared/access_control/FibonacciBalance.sol#26-33) uses delegatecall to a input-controlled function id\\n\\t- require(bool)(fibonacciLibrary.delegatecall(fibSig,withdrawalCounter)) (shared/access_control/FibonacciBalance.sol#31)\\n", "markdown": "[FibonacciBalance.withdraw()](shared/access_control/FibonacciBalance.sol#L26-L33) uses delegatecall to a input-controlled function id\\n\\t- [require(bool)(fibonacciLibrary.delegatecall(fibSig,withdrawalCounter))](shared/access_control/FibonacciBalance.sol#L31)\\n", "first_markdown_element": "shared/access_control/FibonacciBalance.sol#L26-L33", "id": "4d360c6909f953b0243b697a82843f1fe7e7ded628b542036eea6e9296f424be", "check": "controlled-delegatecall", "impact": "High", "confidence": "Medium"}, {"elements": [{"type": "function", "name": "fallback", "source_mapping": {"start": 1121, "length": 124, "filename_relative": "shared/access_control/FibonacciBalance.sol", "filename_absolute": "/home/ethsec/shared/access_control/FibonacciBalance.sol", "filename_short": "shared/access_control/FibonacciBalance.sol", "is_dependency": false, "lines": [36, 37, 38, 39], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "FibonacciBalance", "source_mapping": {"start": 174, "length": 1073, "filename_relative": "shared/access_control/FibonacciBalance.sol", "filename_absolute": "/home/ethsec/shared/access_control/FibonacciBalance.sol", "filename_short": "shared/access_control/FibonacciBalance.sol", "is_dependency": false, "lines": [10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40], "starting_column": 1, "ending_column": 2}}, "signature": "fallback()"}}, {"type": "node", "name": "require(bool)(fibonacciLibrary.delegatecall(msg.data))", "source_mapping": {"start": 1190, "length": 48, "filename_relative": "shared/access_control/FibonacciBalance.sol", "filename_absolute": "/home/ethsec/shared/access_control/FibonacciBalance.sol", "filename_short": "shared/access_control/FibonacciBalance.sol", "is_dependency": false, "lines": [38], "starting_column": 9, "ending_column": 57}, "type_specific_fields": {"parent": {"type": "function", "name": "fallback", "source_mapping": {"start": 1121, "length": 124, "filename_relative": "shared/access_control/FibonacciBalance.sol", "filename_absolute": "/home/ethsec/shared/access_control/FibonacciBalance.sol", "filename_short": "shared/access_control/FibonacciBalance.sol", "is_dependency": false, "lines": [36, 37, 38, 39], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "FibonacciBalance", "source_mapping": {"start": 174, "length": 1073, "filename_relative": "shared/access_control/FibonacciBalance.sol", "filename_absolute": "/home/ethsec/shared/access_control/FibonacciBalance.sol", "filename_short": "shared/access_control/FibonacciBalance.sol", "is_dependency": false, "lines": [10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40], "starting_column": 1, "ending_column": 2}}, "signature": "fallback()"}}}}], "description": "FibonacciBalance.fallback() (shared/access_control/FibonacciBalance.sol#36-39) uses delegatecall to a input-controlled function id\\n\\t- require(bool)(fibonacciLibrary.delegatecall(msg.data)) (shared/access_control/FibonacciBalance.sol#38)\\n", "markdown": "[FibonacciBalance.fallback()](shared/access_control/FibonacciBalance.sol#L36-L39) uses delegatecall to a input-controlled function id\\n\\t- [require(bool)(fibonacciLibrary.delegatecall(msg.data))](shared/access_control/FibonacciBalance.sol#L38)\\n", "first_markdown_element": "shared/access_control/FibonacciBalance.sol#L36-L39", "id": "a52436693e231a72f564a03f7bc0c91c8dcbdb46dae4de535e72f7295597c85a", "check": "controlled-delegatecall", "impact": "High", "confidence": "Medium"}, {"elements": [{"type": "variable", "name": "calculatedFibNumber", "source_mapping": {"start": 292, "length": 31, "filename_relative": "shared/access_control/FibonacciBalance.sol", "filename_absolute": "/home/ethsec/shared/access_control/FibonacciBalance.sol", "filename_short": "shared/access_control/FibonacciBalance.sol", "is_dependency": false, "lines": [14], "starting_column": 5, "ending_column": 36}, "type_specific_fields": {"parent": {"type": "contract", "name": "FibonacciBalance", "source_mapping": {"start": 174, "length": 1073, "filename_relative": "shared/access_control/FibonacciBalance.sol", "filename_absolute": "/home/ethsec/shared/access_control/FibonacciBalance.sol", "filename_short": "shared/access_control/FibonacciBalance.sol", "is_dependency": false, "lines": [10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40], "starting_column": 1, "ending_column": 2}}}}, {"type": "function", "name": "withdraw", "source_mapping": {"start": 710, "length": 350, "filename_relative": "shared/access_control/FibonacciBalance.sol", "filename_absolute": "/home/ethsec/shared/access_control/FibonacciBalance.sol", "filename_short": "shared/access_control/FibonacciBalance.sol", "is_dependency": false, "lines": [26, 27, 28, 29, 30, 31, 32, 33], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "FibonacciBalance", "source_mapping": {"start": 174, "length": 1073, "filename_relative": "shared/access_control/FibonacciBalance.sol", "filename_absolute": "/home/ethsec/shared/access_control/FibonacciBalance.sol", "filename_short": "shared/access_control/FibonacciBalance.sol", "is_dependency": false, "lines": [10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40], "starting_column": 1, "ending_column": 2}}, "signature": "withdraw()"}}], "description": "FibonacciBalance.calculatedFibNumber (shared/access_control/FibonacciBalance.sol#14) is never initialized. It is used in:\\n\\t- FibonacciBalance.withdraw() (shared/access_control/FibonacciBalance.sol#26-33)\\n", "markdown": "[FibonacciBalance.calculatedFibNumber](shared/access_control/FibonacciBalance.sol#L14) is never initialized. It is used in:\\n\\t- [FibonacciBalance.withdraw()](shared/access_control/FibonacciBalance.sol#L26-L33)\\n", "first_markdown_element": "shared/access_control/FibonacciBalance.sol#L14", "id": "312653536edca9c058f963361df1f5be5b8e191e5cb8b66899acac391e6f4784", "check": "uninitialized-state", "impact": "High", "confidence": "High"}, {"elements": [{"type": "variable", "name": "_fibonacciLibrary", "source_mapping": {"start": 609, "length": 25, "filename_relative": "shared/access_control/FibonacciBalance.sol", "filename_absolute": "/home/ethsec/shared/access_control/FibonacciBalance.sol", "filename_short": "shared/access_control/FibonacciBalance.sol", "is_dependency": false, "lines": [22], "starting_column": 17, "ending_column": 42}, "type_specific_fields": {"parent": {"type": "function", "name": "constructor", "source_mapping": {"start": 597, "length": 107, "filename_relative": "shared/access_control/FibonacciBalance.sol", "filename_absolute": "/home/ethsec/shared/access_control/FibonacciBalance.sol", "filename_short": "shared/access_control/FibonacciBalance.sol", "is_dependency": false, "lines": [22, 23, 24], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "FibonacciBalance", "source_mapping": {"start": 174, "length": 1073, "filename_relative": "shared/access_control/FibonacciBalance.sol", "filename_absolute": "/home/ethsec/shared/access_control/FibonacciBalance.sol", "filename_short": "shared/access_control/FibonacciBalance.sol", "is_dependency": false, "lines": [10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40], "starting_column": 1, "ending_column": 2}}, "signature": "constructor(address)"}}}}, {"type": "node", "name": "fibonacciLibrary = _fibonacciLibrary", "source_mapping": {"start": 661, "length": 36, "filename_relative": "shared/access_control/FibonacciBalance.sol", "filename_absolute": "/home/ethsec/shared/access_control/FibonacciBalance.sol", "filename_short": "shared/access_control/FibonacciBalance.sol", "is_dependency": false, "lines": [23], "starting_column": 9, "ending_column": 45}, "type_specific_fields": {"parent": {"type": "function", "name": "constructor", "source_mapping": {"start": 597, "length": 107, "filename_relative": "shared/access_control/FibonacciBalance.sol", "filename_absolute": "/home/ethsec/shared/access_control/FibonacciBalance.sol", "filename_short": "shared/access_control/FibonacciBalance.sol", "is_dependency": false, "lines": [22, 23, 24], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "FibonacciBalance", "source_mapping": {"start": 174, "length": 1073, "filename_relative": "shared/access_control/FibonacciBalance.sol", "filename_absolute": "/home/ethsec/shared/access_control/FibonacciBalance.sol", "filename_short": "shared/access_control/FibonacciBalance.sol", "is_dependency": false, "lines": [10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40], "starting_column": 1, "ending_column": 2}}, "signature": "constructor(address)"}}}}], "description": "FibonacciBalance.constructor(address)._fibonacciLibrary (shared/access_control/FibonacciBalance.sol#22) lacks a zero-check on :\\n\\t\\t- fibonacciLibrary = _fibonacciLibrary (shared/access_control/FibonacciBalance.sol#23)\\n", "markdown": "[FibonacciBalance.constructor(address)._fibonacciLibrary](shared/access_control/FibonacciBalance.sol#L22) lacks a zero-check on :\\n\\t\\t- [fibonacciLibrary = _fibonacciLibrary](shared/access_control/FibonacciBalance.sol#L23)\\n", "first_markdown_element": "shared/access_control/FibonacciBalance.sol#L22", "id": "9e4f0abff06930d1caa44523a4d14b7bd1fa0f8398fa2d3f7024a57ceb7acc14", "check": "missing-zero-check", "impact": "Low", "confidence": "Medium"}, {"elements": [{"type": "node", "name": "fibSig = bytes4(sha3()(setFibonacci(uint256)))", "source_mapping": {"start": 477, "length": 62, "filename_relative": "shared/access_control/FibonacciBalance.sol", "filename_absolute": "/home/ethsec/shared/access_control/FibonacciBalance.sol", "filename_short": "shared/access_control/FibonacciBalance.sol", "is_dependency": false, "lines": [19], "starting_column": 5, "ending_column": 67}, "type_specific_fields": {"parent": {"type": "function", "name": "slitherConstructorConstantVariables", "source_mapping": {"start": 174, "length": 1073, "filename_relative": "shared/access_control/FibonacciBalance.sol", "filename_absolute": "/home/ethsec/shared/access_control/FibonacciBalance.sol", "filename_short": "shared/access_control/FibonacciBalance.sol", "is_dependency": false, "lines": [10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40], "starting_column": 1, "ending_column": 2}, "type_specific_fields": {"parent": {"type": "contract", "name": "FibonacciBalance", "source_mapping": {"start": 174, "length": 1073, "filename_relative": "shared/access_control/FibonacciBalance.sol", "filename_absolute": "/home/ethsec/shared/access_control/FibonacciBalance.sol", "filename_short": "shared/access_control/FibonacciBalance.sol", "is_dependency": false, "lines": [10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40], "starting_column": 1, "ending_column": 2}}, "signature": "slitherConstructorConstantVariables()"}}}}], "description": "Deprecated standard detected fibSig = bytes4(sha3()(setFibonacci(uint256))) (shared/access_control/FibonacciBalance.sol#19):\\n\\t- Usage of \\"sha3()\\" should be replaced with \\"keccak256()\\"\\n", "markdown": "Deprecated standard detected [fibSig = bytes4(sha3()(setFibonacci(uint256)))](shared/access_control/FibonacciBalance.sol#L19):\\n\\t- Usage of \\"sha3()\\" should be replaced with \\"keccak256()\\"\\n", "first_markdown_element": "shared/access_control/FibonacciBalance.sol#L19", "id": "706d1eac44cbee4eca22b162b9444f91fddf4451a6742dffd167a09537d3b9b4", "check": "deprecated-standards", "impact": "Informational", "confidence": "High"}, {"elements": [{"type": "variable", "name": "fibSig", "source_mapping": {"start": 477, "length": 62, "filename_relative": "shared/access_control/FibonacciBalance.sol", "filename_absolute": "/home/ethsec/shared/access_control/FibonacciBalance.sol", "filename_short": "shared/access_control/FibonacciBalance.sol", "is_dependency": false, "lines": [19], "starting_column": 5, "ending_column": 67}, "type_specific_fields": {"parent": {"type": "contract", "name": "FibonacciBalance", "source_mapping": {"start": 174, "length": 1073, "filename_relative": "shared/access_control/FibonacciBalance.sol", "filename_absolute": "/home/ethsec/shared/access_control/FibonacciBalance.sol", "filename_short": "shared/access_control/FibonacciBalance.sol", "is_dependency": false, "lines": [10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40], "starting_column": 1, "ending_column": 2}}}}], "description": "Deprecated standard detected FibonacciBalance.fibSig (shared/access_control/FibonacciBalance.sol#19):\\n\\t- Usage of \\"sha3()\\" should be replaced with \\"keccak256()\\"\\n", "markdown": "Deprecated standard detected [FibonacciBalance.fibSig](shared/access_control/FibonacciBalance.sol#L19):\\n\\t- Usage of \\"sha3()\\" should be replaced with \\"keccak256()\\"\\n", "first_markdown_element": "shared/access_control/FibonacciBalance.sol#L19", "id": "8a5395cffe27ced43e7bb1dc7540d804ccc4a5c06f53d11afcd29511c7b8dd5d", "check": "deprecated-standards", "impact": "Informational", "confidence": "High"}, {"elements": [], "description": "solc-0.4.22 is known to contain severe issues (https://solidity.readthedocs.io/en/latest/bugs.html)", "markdown": "solc-0.4.22 is known to contain severe issues (https://solidity.readthedocs.io/en/latest/bugs.html)", "first_markdown_element": "", "id": "113041d02ad8d8c1f0a9137c4392269953828a030c22dc283813c1c6df7f407e", "check": "solc-version", "impact": "Informational", "confidence": "High"}, {"elements": [{"type": "pragma", "name": "^0.4.22", "source_mapping": {"start": 148, "length": 24, "filename_relative": "shared/access_control/FibonacciBalance.sol", "filename_absolute": "/home/ethsec/shared/access_control/FibonacciBalance.sol", "filename_short": "shared/access_control/FibonacciBalance.sol", "is_dependency": false, "lines": [8], "starting_column": 1, "ending_column": 25}, "type_specific_fields": {"directive": ["solidity", "^", "0.4", ".22"]}}], "description": "Pragma version^0.4.22 (shared/access_control/FibonacciBalance.sol#8) is known to contain severe issues (https://solidity.readthedocs.io/en/latest/bugs.html)\\n", "markdown": "Pragma version[^0.4.22](shared/access_control/FibonacciBalance.sol#L8) is known to contain severe issues (https://solidity.readthedocs.io/en/latest/bugs.html)\\n", "first_markdown_element": "shared/access_control/FibonacciBalance.sol#L8", "id": "7b7ab036485b88682d46fe8e80833305e261727eef3b6ba0277aeab0f1276d63", "check": "solc-version", "impact": "Informational", "confidence": "High"}, {"elements": [{"type": "function", "name": "fallback", "source_mapping": {"start": 1121, "length": 124, "filename_relative": "shared/access_control/FibonacciBalance.sol", "filename_absolute": "/home/ethsec/shared/access_control/FibonacciBalance.sol", "filename_short": "shared/access_control/FibonacciBalance.sol", "is_dependency": false, "lines": [36, 37, 38, 39], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "FibonacciBalance", "source_mapping": {"start": 174, "length": 1073, "filename_relative": "shared/access_control/FibonacciBalance.sol", "filename_absolute": "/home/ethsec/shared/access_control/FibonacciBalance.sol", "filename_short": "shared/access_control/FibonacciBalance.sol", "is_dependency": false, "lines": [10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40], "starting_column": 1, "ending_column": 2}}, "signature": "fallback()"}}, {"type": "node", "name": "require(bool)(fibonacciLibrary.delegatecall(msg.data))", "source_mapping": {"start": 1190, "length": 48, "filename_relative": "shared/access_control/FibonacciBalance.sol", "filename_absolute": "/home/ethsec/shared/access_control/FibonacciBalance.sol", "filename_short": "shared/access_control/FibonacciBalance.sol", "is_dependency": false, "lines": [38], "starting_column": 9, "ending_column": 57}, "type_specific_fields": {"parent": {"type": "function", "name": "fallback", "source_mapping": {"start": 1121, "length": 124, "filename_relative": "shared/access_control/FibonacciBalance.sol", "filename_absolute": "/home/ethsec/shared/access_control/FibonacciBalance.sol", "filename_short": "shared/access_control/FibonacciBalance.sol", "is_dependency": false, "lines": [36, 37, 38, 39], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "FibonacciBalance", "source_mapping": {"start": 174, "length": 1073, "filename_relative": "shared/access_control/FibonacciBalance.sol", "filename_absolute": "/home/ethsec/shared/access_control/FibonacciBalance.sol", "filename_short": "shared/access_control/FibonacciBalance.sol", "is_dependency": false, "lines": [10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40], "starting_column": 1, "ending_column": 2}}, "signature": "fallback()"}}}}], "description": "Low level call in FibonacciBalance.fallback() (shared/access_control/FibonacciBalance.sol#36-39):\\n\\t- require(bool)(fibonacciLibrary.delegatecall(msg.data)) (shared/access_control/FibonacciBalance.sol#38)\\n", "markdown": "Low level call in [FibonacciBalance.fallback()](shared/access_control/FibonacciBalance.sol#L36-L39):\\n\\t- [require(bool)(fibonacciLibrary.delegatecall(msg.data))](shared/access_control/FibonacciBalance.sol#L38)\\n", "first_markdown_element": "shared/access_control/FibonacciBalance.sol#L36-L39", "id": "18205643b96fe3a9f9ffb17adaab0b323ba9971706ae773b77db9878fb917701", "check": "low-level-calls", "impact": "Informational", "confidence": "High"}, {"elements": [{"type": "function", "name": "withdraw", "source_mapping": {"start": 710, "length": 350, "filename_relative": "shared/access_control/FibonacciBalance.sol", "filename_absolute": "/home/ethsec/shared/access_control/FibonacciBalance.sol", "filename_short": "shared/access_control/FibonacciBalance.sol", "is_dependency": false, "lines": [26, 27, 28, 29, 30, 31, 32, 33], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "FibonacciBalance", "source_mapping": {"start": 174, "length": 1073, "filename_relative": "shared/access_control/FibonacciBalance.sol", "filename_absolute": "/home/ethsec/shared/access_control/FibonacciBalance.sol", "filename_short": "shared/access_control/FibonacciBalance.sol", "is_dependency": false, "lines": [10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40], "starting_column": 1, "ending_column": 2}}, "signature": "withdraw()"}}, {"type": "node", "name": "require(bool)(fibonacciLibrary.delegatecall(fibSig,withdrawalCounter))", "source_mapping": {"start": 928, "length": 65, "filename_relative": "shared/access_control/FibonacciBalance.sol", "filename_absolute": "/home/ethsec/shared/access_control/FibonacciBalance.sol", "filename_short": "shared/access_control/FibonacciBalance.sol", "is_dependency": false, "lines": [31], "starting_column": 9, "ending_column": 74}, "type_specific_fields": {"parent": {"type": "function", "name": "withdraw", "source_mapping": {"start": 710, "length": 350, "filename_relative": "shared/access_control/FibonacciBalance.sol", "filename_absolute": "/home/ethsec/shared/access_control/FibonacciBalance.sol", "filename_short": "shared/access_control/FibonacciBalance.sol", "is_dependency": false, "lines": [26, 27, 28, 29, 30, 31, 32, 33], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "FibonacciBalance", "source_mapping": {"start": 174, "length": 1073, "filename_relative": "shared/access_control/FibonacciBalance.sol", "filename_absolute": "/home/ethsec/shared/access_control/FibonacciBalance.sol", "filename_short": "shared/access_control/FibonacciBalance.sol", "is_dependency": false, "lines": [10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40], "starting_column": 1, "ending_column": 2}}, "signature": "withdraw()"}}}}], "description": "Low level call in FibonacciBalance.withdraw() (shared/access_control/FibonacciBalance.sol#26-33):\\n\\t- require(bool)(fibonacciLibrary.delegatecall(fibSig,withdrawalCounter)) (shared/access_control/FibonacciBalance.sol#31)\\n", "markdown": "Low level call in [FibonacciBalance.withdraw()](shared/access_control/FibonacciBalance.sol#L26-L33):\\n\\t- [require(bool)(fibonacciLibrary.delegatecall(fibSig,withdrawalCounter))](shared/access_control/FibonacciBalance.sol#L31)\\n", "first_markdown_element": "shared/access_control/FibonacciBalance.sol#L26-L33", "id": "29669056144857560fa36e1d66280315cdc3269ab934965d1a3c2b6988aac085", "check": "low-level-calls", "impact": "Informational", "confidence": "High"}, {"elements": [{"type": "variable", "name": "fibSig", "source_mapping": {"start": 477, "length": 62, "filename_relative": "shared/access_control/FibonacciBalance.sol", "filename_absolute": "/home/ethsec/shared/access_control/FibonacciBalance.sol", "filename_short": "shared/access_control/FibonacciBalance.sol", "is_dependency": false, "lines": [19], "starting_column": 5, "ending_column": 67}, "type_specific_fields": {"parent": {"type": "contract", "name": "FibonacciBalance", "source_mapping": {"start": 174, "length": 1073, "filename_relative": "shared/access_control/FibonacciBalance.sol", "filename_absolute": "/home/ethsec/shared/access_control/FibonacciBalance.sol", "filename_short": "shared/access_control/FibonacciBalance.sol", "is_dependency": false, "lines": [10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40], "starting_column": 1, "ending_column": 2}}}, "additional_fields": {"target": "variable_constant", "convention": "UPPER_CASE_WITH_UNDERSCORES"}}], "description": "Constant FibonacciBalance.fibSig (shared/access_control/FibonacciBalance.sol#19) is not in UPPER_CASE_WITH_UNDERSCORES\\n", "markdown": "Constant [FibonacciBalance.fibSig](shared/access_control/FibonacciBalance.sol#L19) is not in UPPER_CASE_WITH_UNDERSCORES\\n", "first_markdown_element": "shared/access_control/FibonacciBalance.sol#L19", "id": "7c0efa7a72810048baeb8e796fad3a535ca0ada99c1c9223c98fd3f97fe11cbd", "check": "naming-convention", "impact": "Informational", "confidence": "High"}, {"elements": [{"type": "variable", "name": "_start", "source_mapping": {"start": 1514, "length": 11, "filename_relative": "shared/access_control/FibonacciBalance.sol", "filename_absolute": "/home/ethsec/shared/access_control/FibonacciBalance.sol", "filename_short": "shared/access_control/FibonacciBalance.sol", "is_dependency": false, "lines": [49], "starting_column": 23, "ending_column": 34}, "type_specific_fields": {"parent": {"type": "function", "name": "setStart", "source_mapping": {"start": 1496, "length": 69, "filename_relative": "shared/access_control/FibonacciBalance.sol", "filename_absolute": "/home/ethsec/shared/access_control/FibonacciBalance.sol", "filename_short": "shared/access_control/FibonacciBalance.sol", "is_dependency": false, "lines": [49, 50, 51], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "FibonacciLib", "source_mapping": {"start": 1306, "length": 553, "filename_relative": "shared/access_control/FibonacciBalance.sol", "filename_absolute": "/home/ethsec/shared/access_control/FibonacciBalance.sol", "filename_short": "shared/access_control/FibonacciBalance.sol", "is_dependency": false, "lines": [43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62], "starting_column": 1, "ending_column": 2}}, "signature": "setStart(uint256)"}}}, "additional_fields": {"target": "parameter", "convention": "mixedCase"}}], "description": "Parameter FibonacciLib.setStart(uint256)._start (shared/access_control/FibonacciBalance.sol#49) is not in mixedCase\\n", "markdown": "Parameter [FibonacciLib.setStart(uint256)._start](shared/access_control/FibonacciBalance.sol#L49) is not in mixedCase\\n", "first_markdown_element": "shared/access_control/FibonacciBalance.sol#L49", "id": "f1fc25fa6e8ae994a8236a26370a8b7091037aef93952bc2a76b42ac32bc3eca", "check": "naming-convention", "impact": "Informational", "confidence": "High"}, {"elements": [{"type": "variable", "name": "start", "source_mapping": {"start": 375, "length": 21, "filename_relative": "shared/access_control/FibonacciBalance.sol", "filename_absolute": "/home/ethsec/shared/access_control/FibonacciBalance.sol", "filename_short": "shared/access_control/FibonacciBalance.sol", "is_dependency": false, "lines": [16], "starting_column": 5, "ending_column": 26}, "type_specific_fields": {"parent": {"type": "contract", "name": "FibonacciBalance", "source_mapping": {"start": 174, "length": 1073, "filename_relative": "shared/access_control/FibonacciBalance.sol", "filename_absolute": "/home/ethsec/shared/access_control/FibonacciBalance.sol", "filename_short": "shared/access_control/FibonacciBalance.sol", "is_dependency": false, "lines": [10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40], "starting_column": 1, "ending_column": 2}}}}], "description": "FibonacciBalance.start (shared/access_control/FibonacciBalance.sol#16) should be constant \\n", "markdown": "[FibonacciBalance.start](shared/access_control/FibonacciBalance.sol#L16) should be constant \\n", "first_markdown_element": "shared/access_control/FibonacciBalance.sol#L16", "id": "30530b8e0be5ac8b54c72c4856adbaa809d037b71dcf93d691d6161dbaa55522", "check": "constable-states", "impact": "Optimization", "confidence": "High"}, {"elements": [{"type": "variable", "name": "calculatedFibNumber", "source_mapping": {"start": 292, "length": 31, "filename_relative": "shared/access_control/FibonacciBalance.sol", "filename_absolute": "/home/ethsec/shared/access_control/FibonacciBalance.sol", "filename_short": "shared/access_control/FibonacciBalance.sol", "is_dependency": false, "lines": [14], "starting_column": 5, "ending_column": 36}, "type_specific_fields": {"parent": {"type": "contract", "name": "FibonacciBalance", "source_mapping": {"start": 174, "length": 1073, "filename_relative": "shared/access_control/FibonacciBalance.sol", "filename_absolute": "/home/ethsec/shared/access_control/FibonacciBalance.sol", "filename_short": "shared/access_control/FibonacciBalance.sol", "is_dependency": false, "lines": [10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40], "starting_column": 1, "ending_column": 2}}}}], "description": "FibonacciBalance.calculatedFibNumber (shared/access_control/FibonacciBalance.sol#14) should be constant \\n", "markdown": "[FibonacciBalance.calculatedFibNumber](shared/access_control/FibonacciBalance.sol#L14) should be constant \\n", "first_markdown_element": "shared/access_control/FibonacciBalance.sol#L14", "id": "ec6a03ff33129452be0d50848a887bb134b534f334a2e5ba69f587482b2cb934", "check": "constable-states", "impact": "Optimization", "confidence": "High"}]}}\n' 

2024-07-04 19:00:50,226 - root - INFO - 
Found 4 vulnerabilities of severity Medium 

2024-07-04 19:00:54,996 - root - INFO - 
NEW CODE: pragma solidity ^0.4.22;

contract FibonacciBalance {

    address public fibonacciLibrary;

    uint public calculatedFibNumber;

    uint public start = 3;
    uint public withdrawalCounter;

    bytes4 constant fibSig = bytes4(keccak256("setFibonacci(uint256)"));

    constructor(address _fibonacciLibrary) public payable {
        fibonacciLibrary = _fibonacciLibrary;
    }

    function withdraw() {
        withdrawalCounter += 1;

        require(fibonacciLibrary.delegatecall(fibSig, withdrawalCounter));
        require(calculatedFibNumber > 0); // Check if calculatedFibNumber is greater than 0
        msg.sender.transfer(calculatedFibNumber * 1 ether);
    }

    function() public {
        require(fibonacciLibrary.delegatecall(msg.data));
    }
}

contract FibonacciLib {

    uint public start;
    uint public calculatedFibNumber;

    function setStart(uint _start) public {
        start = _start;
    }

    function setFibonacci(uint n) public {
        calculatedFibNumber = fibonacci(n);
    }

    function fibonacci(uint n) internal returns (uint) {
        if (n == 0) return start;
        else if (n == 1) return start + 1;
        else return fibonacci(n - 1) + fibonacci(n - 2);
    }
} 

2024-07-04 19:00:54,997 - root - INFO - 
try 2/4: /home/mokita/sc_study/smartbugs-curated/dataset/access_control/FibonacciBalance_2round.sol  

2024-07-04 19:00:54,997 - root - INFO - 
Found 4 vulnerabilities of severity Medium 

2024-07-04 19:00:58,578 - root - INFO - 
NEW CODE: pragma solidity ^0.4.22;

contract FibonacciBalance {

    address public fibonacciLibrary;

    uint public calculatedFibNumber;

    uint public start = 3;
    uint public withdrawalCounter;

    bytes4 constant fibSig = bytes4(keccak256("setFibonacci(uint256)"));


    constructor(address _fibonacciLibrary) public payable {
        fibonacciLibrary = _fibonacciLibrary;
    }

    function withdraw() {
        withdrawalCounter += 1;

        require(fibonacciLibrary.delegatecall(fibSig, withdrawalCounter));
        require(calculatedFibNumber != 0); // Check if calculatedFibNumber is not zero
        msg.sender.transfer(calculatedFibNumber * 1 ether);
    }

    function() public {
        require(fibonacciLibrary.delegatecall(msg.data));
    }
}


contract FibonacciLib {

    uint public start;
    uint public calculatedFibNumber;

    function setStart(uint _start) public {
        start = _start;
    }

    function setFibonacci(uint n) public {
        calculatedFibNumber = fibonacci(n);
    }

    function fibonacci(uint n) internal returns (uint) {
        if (n == 0) return start;
        else if (n == 1) return start + 1;
        else return fibonacci(n - 1) + fibonacci(n - 2);
    }
} 

2024-07-04 19:00:58,579 - root - INFO - 
try 3/4: /home/mokita/sc_study/smartbugs-curated/dataset/access_control/FibonacciBalance_3round.sol  

2024-07-04 19:00:58,579 - root - INFO - 
Found 4 vulnerabilities of severity Medium 

2024-07-04 19:01:02,674 - root - INFO - 
NEW CODE: pragma solidity ^0.4.22;

contract FibonacciBalance {

    address public fibonacciLibrary;

    uint public calculatedFibNumber;

    uint public start = 3;
    uint public withdrawalCounter;

    bytes4 constant fibSig = bytes4(keccak256("setFibonacci(uint256)"));


    constructor(address _fibonacciLibrary) public payable {
        fibonacciLibrary = _fibonacciLibrary;
    }

    function withdraw() {
        withdrawalCounter += 1;

        require(fibonacciLibrary.delegatecall(fibSig, withdrawalCounter));
        require(calculatedFibNumber != 0); // Check if calculatedFibNumber is not zero
        msg.sender.transfer(calculatedFibNumber * 1 ether);
    }

    function() public {
        require(fibonacciLibrary.delegatecall(msg.data));
    }
}


contract FibonacciLib {

    uint public start;
    uint public calculatedFibNumber;

    function setStart(uint _start) public {
        start = _start;
    }

    function setFibonacci(uint n) public {
        calculatedFibNumber = fibonacci(n);
    }

    function fibonacci(uint n) internal returns (uint) {
        if (n == 0) return start;
        else if (n == 1) return start + 1;
        else return fibonacci(n - 1) + fibonacci(n - 2);
    }
} 

2024-07-04 19:01:02,675 - root - INFO - 
try 4/4: /home/mokita/sc_study/smartbugs-curated/dataset/access_control/FibonacciBalance_4round.sol  

2024-07-04 19:01:02,675 - root - INFO - 
Found 4 vulnerabilities of severity Medium 

2024-07-04 19:01:07,077 - root - INFO - 
NEW CODE: pragma solidity ^0.4.22;

contract FibonacciBalance {

    address public fibonacciLibrary;

    uint public calculatedFibNumber;

    uint public start = 3;
    uint public withdrawalCounter;

    bytes4 constant fibSig = bytes4(keccak256("setFibonacci(uint256)"));

    constructor(address _fibonacciLibrary) public payable {
        fibonacciLibrary = _fibonacciLibrary;
    }

    function withdraw() {
        withdrawalCounter += 1;

        require(fibonacciLibrary.delegatecall(fibSig, withdrawalCounter));
        require(calculatedFibNumber != 0); // Check if calculatedFibNumber is not zero
        msg.sender.transfer(calculatedFibNumber * 1 ether);
    }

    function() public {
        require(fibonacciLibrary.delegatecall(msg.data));
    }
}

contract FibonacciLib {

    uint public start;
    uint public calculatedFibNumber;

    function setStart(uint _start) public {
        start = _start;
    }

    function setFibonacci(uint n) public {
        calculatedFibNumber = fibonacci(n);
    }

    function fibonacci(uint n) internal returns (uint) {
        if (n == 0) return start;
        else if (n == 1) return start + 1;
        else return fibonacci(n - 1) + fibonacci(n - 2);
    }
} 

