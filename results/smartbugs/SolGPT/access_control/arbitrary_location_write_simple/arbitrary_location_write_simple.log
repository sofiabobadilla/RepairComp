2024-07-04 18:58:55,269 - root - INFO - 
Reading file 'arbitrary_location_write_simple.sol' 

2024-07-04 18:58:55,270 - root - INFO - 
Pragma: 0.4.25 

2024-07-04 18:58:55,270 - root - INFO - 
Processing /home/mokita/sc_study/smartbugs-curated/dataset/access_control/arbitrary_location_write_simple.sol 

2024-07-04 18:58:55,270 - root - INFO - 
try 1/4: /home/mokita/sc_study/smartbugs-curated/dataset/access_control/arbitrary_location_write_simple_1round.sol  

2024-07-04 18:58:55,278 - root - INFO - 

        Docker container name: slither
        Docker image name: trailofbits/eth-security-toolbox
        Docker shared folder: /home/mokita/sc_study/smartbugs-curated/dataset:/home/ethsec/shared
        Docker command: None
         

2024-07-04 18:58:55,281 - root - INFO - 
Running command: solc-select use --always-install 0.4.25 

2024-07-04 18:58:55,449 - root - INFO - 
Running command: slither shared/access_control/arbitrary_location_write_simple.sol --json - 

2024-07-04 18:58:56,293 - root - INFO - 
b'{"success": true, "error": null, "results": {"detectors": [{"elements": [{"type": "contract", "name": "Wallet", "source_mapping": {"start": 204, "length": 872, "filename_relative": "shared/access_control/arbitrary_location_write_simple.sol", "filename_absolute": "/home/ethsec/shared/access_control/arbitrary_location_write_simple.sol", "filename_short": "shared/access_control/arbitrary_location_write_simple.sol", "is_dependency": false, "lines": [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40], "starting_column": 2, "ending_column": 3}}, {"type": "node", "name": "bonusCodes.push(c)", "source_mapping": {"start": 481, "length": 18, "filename_relative": "shared/access_control/arbitrary_location_write_simple.sol", "filename_absolute": "/home/ethsec/shared/access_control/arbitrary_location_write_simple.sol", "filename_short": "shared/access_control/arbitrary_location_write_simple.sol", "is_dependency": false, "lines": [22], "starting_column": 10, "ending_column": 28}, "type_specific_fields": {"parent": {"type": "function", "name": "PushBonusCode", "source_mapping": {"start": 432, "length": 75, "filename_relative": "shared/access_control/arbitrary_location_write_simple.sol", "filename_absolute": "/home/ethsec/shared/access_control/arbitrary_location_write_simple.sol", "filename_short": "shared/access_control/arbitrary_location_write_simple.sol", "is_dependency": false, "lines": [21, 22, 23], "starting_column": 6, "ending_column": 7}, "type_specific_fields": {"parent": {"type": "contract", "name": "Wallet", "source_mapping": {"start": 204, "length": 872, "filename_relative": "shared/access_control/arbitrary_location_write_simple.sol", "filename_absolute": "/home/ethsec/shared/access_control/arbitrary_location_write_simple.sol", "filename_short": "shared/access_control/arbitrary_location_write_simple.sol", "is_dependency": false, "lines": [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40], "starting_column": 2, "ending_column": 3}}, "signature": "PushBonusCode(uint256)"}}}}], "description": "Wallet (shared/access_control/arbitrary_location_write_simple.sol#9-40) contract sets array length with a user-controlled value:\\n\\t- bonusCodes.push(c) (shared/access_control/arbitrary_location_write_simple.sol#22)\\n", "markdown": "[Wallet](shared/access_control/arbitrary_location_write_simple.sol#L9-L40) contract sets array length with a user-controlled value:\\n\\t- [bonusCodes.push(c)](shared/access_control/arbitrary_location_write_simple.sol#L22)\\n", "first_markdown_element": "shared/access_control/arbitrary_location_write_simple.sol#L9-L40", "id": "4a68d88a58705b6632d2b6aff531bd899df8300f0c8afb9be08dd46f8f27e881", "check": "controlled-array-length", "impact": "High", "confidence": "Medium"}, {"elements": [{"type": "function", "name": "PopBonusCode", "source_mapping": {"start": 514, "length": 254, "filename_relative": "shared/access_control/arbitrary_location_write_simple.sol", "filename_absolute": "/home/ethsec/shared/access_control/arbitrary_location_write_simple.sol", "filename_short": "shared/access_control/arbitrary_location_write_simple.sol", "is_dependency": false, "lines": [25, 26, 27, 28, 29], "starting_column": 6, "ending_column": 7}, "type_specific_fields": {"parent": {"type": "contract", "name": "Wallet", "source_mapping": {"start": 204, "length": 872, "filename_relative": "shared/access_control/arbitrary_location_write_simple.sol", "filename_absolute": "/home/ethsec/shared/access_control/arbitrary_location_write_simple.sol", "filename_short": "shared/access_control/arbitrary_location_write_simple.sol", "is_dependency": false, "lines": [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40], "starting_column": 2, "ending_column": 3}}, "signature": "PopBonusCode()"}}, {"type": "node", "name": "require(bool)(0 <= bonusCodes.length)", "source_mapping": {"start": 598, "length": 31, "filename_relative": "shared/access_control/arbitrary_location_write_simple.sol", "filename_absolute": "/home/ethsec/shared/access_control/arbitrary_location_write_simple.sol", "filename_short": "shared/access_control/arbitrary_location_write_simple.sol", "is_dependency": false, "lines": [27], "starting_column": 10, "ending_column": 41}, "type_specific_fields": {"parent": {"type": "function", "name": "PopBonusCode", "source_mapping": {"start": 514, "length": 254, "filename_relative": "shared/access_control/arbitrary_location_write_simple.sol", "filename_absolute": "/home/ethsec/shared/access_control/arbitrary_location_write_simple.sol", "filename_short": "shared/access_control/arbitrary_location_write_simple.sol", "is_dependency": false, "lines": [25, 26, 27, 28, 29], "starting_column": 6, "ending_column": 7}, "type_specific_fields": {"parent": {"type": "contract", "name": "Wallet", "source_mapping": {"start": 204, "length": 872, "filename_relative": "shared/access_control/arbitrary_location_write_simple.sol", "filename_absolute": "/home/ethsec/shared/access_control/arbitrary_location_write_simple.sol", "filename_short": "shared/access_control/arbitrary_location_write_simple.sol", "is_dependency": false, "lines": [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40], "starting_column": 2, "ending_column": 3}}, "signature": "PopBonusCode()"}}}}], "description": "Wallet.PopBonusCode() (shared/access_control/arbitrary_location_write_simple.sol#25-29) contains a tautology or contradiction:\\n\\t- require(bool)(0 <= bonusCodes.length) (shared/access_control/arbitrary_location_write_simple.sol#27)\\n", "markdown": "[Wallet.PopBonusCode()](shared/access_control/arbitrary_location_write_simple.sol#L25-L29) contains a tautology or contradiction:\\n\\t- [require(bool)(0 <= bonusCodes.length)](shared/access_control/arbitrary_location_write_simple.sol#L27)\\n", "first_markdown_element": "shared/access_control/arbitrary_location_write_simple.sol#L25-L29", "id": "6550387f712d554fd04faf9dc6568d9666e393f0d6818b60b4b5b7fc26028e6e", "check": "tautology", "impact": "Medium", "confidence": "High"}, {"elements": [], "description": "solc-0.4.25 is not recommended for deployment\\n", "markdown": "solc-0.4.25 is not recommended for deployment\\n", "first_markdown_element": "", "id": "4d64003d70a62b1c6963f871e841b6cbd633d07d95554e1a50e0f25d9b71ebb3", "check": "solc-version", "impact": "Informational", "confidence": "High"}, {"elements": [{"type": "pragma", "name": "^0.4.25", "source_mapping": {"start": 177, "length": 24, "filename_relative": "shared/access_control/arbitrary_location_write_simple.sol", "filename_absolute": "/home/ethsec/shared/access_control/arbitrary_location_write_simple.sol", "filename_short": "shared/access_control/arbitrary_location_write_simple.sol", "is_dependency": false, "lines": [7], "starting_column": 2, "ending_column": 26}, "type_specific_fields": {"directive": ["solidity", "^", "0.4", ".25"]}}], "description": "Pragma version^0.4.25 (shared/access_control/arbitrary_location_write_simple.sol#7) allows old versions\\n", "markdown": "Pragma version[^0.4.25](shared/access_control/arbitrary_location_write_simple.sol#L7) allows old versions\\n", "first_markdown_element": "shared/access_control/arbitrary_location_write_simple.sol#L7", "id": "8275d8402346ae47059ebd29fc6b1c6f321406405e3d36a26bf76471a9eb9656", "check": "solc-version", "impact": "Informational", "confidence": "High"}, {"elements": [{"type": "function", "name": "UpdateBonusCodeAt", "source_mapping": {"start": 775, "length": 183, "filename_relative": "shared/access_control/arbitrary_location_write_simple.sol", "filename_absolute": "/home/ethsec/shared/access_control/arbitrary_location_write_simple.sol", "filename_short": "shared/access_control/arbitrary_location_write_simple.sol", "is_dependency": false, "lines": [31, 32, 33, 34], "starting_column": 6, "ending_column": 7}, "type_specific_fields": {"parent": {"type": "contract", "name": "Wallet", "source_mapping": {"start": 204, "length": 872, "filename_relative": "shared/access_control/arbitrary_location_write_simple.sol", "filename_absolute": "/home/ethsec/shared/access_control/arbitrary_location_write_simple.sol", "filename_short": "shared/access_control/arbitrary_location_write_simple.sol", "is_dependency": false, "lines": [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40], "starting_column": 2, "ending_column": 3}}, "signature": "UpdateBonusCodeAt(uint256,uint256)"}, "additional_fields": {"target": "function", "convention": "mixedCase"}}], "description": "Function Wallet.UpdateBonusCodeAt(uint256,uint256) (shared/access_control/arbitrary_location_write_simple.sol#31-34) is not in mixedCase\\n", "markdown": "Function [Wallet.UpdateBonusCodeAt(uint256,uint256)](shared/access_control/arbitrary_location_write_simple.sol#L31-L34) is not in mixedCase\\n", "first_markdown_element": "shared/access_control/arbitrary_location_write_simple.sol#L31-L34", "id": "0ce24aeca443251f1b2c8d0134a512576472a392e9e2c8c7681da21b9ffc569e", "check": "naming-convention", "impact": "Informational", "confidence": "High"}, {"elements": [{"type": "function", "name": "PopBonusCode", "source_mapping": {"start": 514, "length": 254, "filename_relative": "shared/access_control/arbitrary_location_write_simple.sol", "filename_absolute": "/home/ethsec/shared/access_control/arbitrary_location_write_simple.sol", "filename_short": "shared/access_control/arbitrary_location_write_simple.sol", "is_dependency": false, "lines": [25, 26, 27, 28, 29], "starting_column": 6, "ending_column": 7}, "type_specific_fields": {"parent": {"type": "contract", "name": "Wallet", "source_mapping": {"start": 204, "length": 872, "filename_relative": "shared/access_control/arbitrary_location_write_simple.sol", "filename_absolute": "/home/ethsec/shared/access_control/arbitrary_location_write_simple.sol", "filename_short": "shared/access_control/arbitrary_location_write_simple.sol", "is_dependency": false, "lines": [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40], "starting_column": 2, "ending_column": 3}}, "signature": "PopBonusCode()"}, "additional_fields": {"target": "function", "convention": "mixedCase"}}], "description": "Function Wallet.PopBonusCode() (shared/access_control/arbitrary_location_write_simple.sol#25-29) is not in mixedCase\\n", "markdown": "Function [Wallet.PopBonusCode()](shared/access_control/arbitrary_location_write_simple.sol#L25-L29) is not in mixedCase\\n", "first_markdown_element": "shared/access_control/arbitrary_location_write_simple.sol#L25-L29", "id": "9b1d3b01887a306eed9ed73df110a402dbdc75acd8e85f317c511bb0c01fa06d", "check": "naming-convention", "impact": "Informational", "confidence": "High"}, {"elements": [{"type": "function", "name": "PushBonusCode", "source_mapping": {"start": 432, "length": 75, "filename_relative": "shared/access_control/arbitrary_location_write_simple.sol", "filename_absolute": "/home/ethsec/shared/access_control/arbitrary_location_write_simple.sol", "filename_short": "shared/access_control/arbitrary_location_write_simple.sol", "is_dependency": false, "lines": [21, 22, 23], "starting_column": 6, "ending_column": 7}, "type_specific_fields": {"parent": {"type": "contract", "name": "Wallet", "source_mapping": {"start": 204, "length": 872, "filename_relative": "shared/access_control/arbitrary_location_write_simple.sol", "filename_absolute": "/home/ethsec/shared/access_control/arbitrary_location_write_simple.sol", "filename_short": "shared/access_control/arbitrary_location_write_simple.sol", "is_dependency": false, "lines": [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40], "starting_column": 2, "ending_column": 3}}, "signature": "PushBonusCode(uint256)"}, "additional_fields": {"target": "function", "convention": "mixedCase"}}], "description": "Function Wallet.PushBonusCode(uint256) (shared/access_control/arbitrary_location_write_simple.sol#21-23) is not in mixedCase\\n", "markdown": "Function [Wallet.PushBonusCode(uint256)](shared/access_control/arbitrary_location_write_simple.sol#L21-L23) is not in mixedCase\\n", "first_markdown_element": "shared/access_control/arbitrary_location_write_simple.sol#L21-L23", "id": "9d3caf6c24af2e4b75079fc1d134142e7a5084859fbfb0f8e9f50a964d2c447c", "check": "naming-convention", "impact": "Informational", "confidence": "High"}, {"elements": [{"type": "function", "name": "Destroy", "source_mapping": {"start": 965, "length": 108, "filename_relative": "shared/access_control/arbitrary_location_write_simple.sol", "filename_absolute": "/home/ethsec/shared/access_control/arbitrary_location_write_simple.sol", "filename_short": "shared/access_control/arbitrary_location_write_simple.sol", "is_dependency": false, "lines": [36, 37, 38, 39], "starting_column": 6, "ending_column": 7}, "type_specific_fields": {"parent": {"type": "contract", "name": "Wallet", "source_mapping": {"start": 204, "length": 872, "filename_relative": "shared/access_control/arbitrary_location_write_simple.sol", "filename_absolute": "/home/ethsec/shared/access_control/arbitrary_location_write_simple.sol", "filename_short": "shared/access_control/arbitrary_location_write_simple.sol", "is_dependency": false, "lines": [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40], "starting_column": 2, "ending_column": 3}}, "signature": "Destroy()"}, "additional_fields": {"target": "function", "convention": "mixedCase"}}], "description": "Function Wallet.Destroy() (shared/access_control/arbitrary_location_write_simple.sol#36-39) is not in mixedCase\\n", "markdown": "Function [Wallet.Destroy()](shared/access_control/arbitrary_location_write_simple.sol#L36-L39) is not in mixedCase\\n", "first_markdown_element": "shared/access_control/arbitrary_location_write_simple.sol#L36-L39", "id": "cdde32a4616eefc01dc27deafc9ef853c8d6a9d3a987e97fb6e10518a5293dad", "check": "naming-convention", "impact": "Informational", "confidence": "High"}]}}\n' 

2024-07-04 18:58:56,295 - root - INFO - 
Found 2 vulnerabilities of severity Medium 

2024-07-04 18:58:59,182 - root - INFO - 
NEW CODE: pragma solidity ^0.4.25;

contract Wallet {
    uint[] private bonusCodes;
    address private owner;

    constructor() public {
        bonusCodes = new uint[](0);
        owner = msg.sender;
    }

    function () public payable {
    }

    function PushBonusCode(uint c) public {
        bonusCodes.push(c);
    }

    function PopBonusCode() public {
        require(bonusCodes.length > 0); 
        bonusCodes.length--; 
    }

    function UpdateBonusCodeAt(uint idx, uint c) public {
        require(idx < bonusCodes.length);
        bonusCodes[idx] = c; 
    }

    function Destroy() public {
        require(msg.sender == owner);
        selfdestruct(msg.sender);
    }
} 

2024-07-04 18:58:59,182 - root - INFO - 
try 2/4: /home/mokita/sc_study/smartbugs-curated/dataset/access_control/arbitrary_location_write_simple_2round.sol  

2024-07-04 18:58:59,182 - root - INFO - 
Found 2 vulnerabilities of severity Medium 

2024-07-04 18:59:01,330 - root - INFO - 
NEW CODE: pragma solidity ^0.4.25;

contract Wallet {
    uint[] private bonusCodes;
    address private owner;

    constructor() public {
        bonusCodes = new uint[](0);
        owner = msg.sender;
    }

    function () public payable {
    }

    function PushBonusCode(uint c) public {
        bonusCodes.push(c);
    }

    function PopBonusCode() public {
        require(bonusCodes.length > 0); 
        bonusCodes.length--; 
    }

    function UpdateBonusCodeAt(uint idx, uint c) public {
        require(idx < bonusCodes.length);
        bonusCodes[idx] = c; 
    }

    function Destroy() public {
        require(msg.sender == owner);
        selfdestruct(msg.sender);
    }
} 

2024-07-04 18:59:01,331 - root - INFO - 
try 3/4: /home/mokita/sc_study/smartbugs-curated/dataset/access_control/arbitrary_location_write_simple_3round.sol  

2024-07-04 18:59:01,331 - root - INFO - 
Found 2 vulnerabilities of severity Medium 

2024-07-04 18:59:03,480 - root - INFO - 
NEW CODE: pragma solidity ^0.4.25;

contract Wallet {
    uint[] private bonusCodes;
    address private owner;

    constructor() public {
        bonusCodes = new uint[](0);
        owner = msg.sender;
    }

    function () public payable {
    }

    function PushBonusCode(uint c) public {
        bonusCodes.push(c);
    }

    function PopBonusCode() public {
        require(bonusCodes.length > 0); 
        bonusCodes.length--; 
    }

    function UpdateBonusCodeAt(uint idx, uint c) public {
        require(idx < bonusCodes.length);
        bonusCodes[idx] = c; 
    }

    function Destroy() public {
        require(msg.sender == owner);
        selfdestruct(msg.sender);
    }
} 

2024-07-04 18:59:03,481 - root - INFO - 
try 4/4: /home/mokita/sc_study/smartbugs-curated/dataset/access_control/arbitrary_location_write_simple_4round.sol  

2024-07-04 18:59:03,481 - root - INFO - 
Found 2 vulnerabilities of severity Medium 

2024-07-04 18:59:05,323 - root - INFO - 
NEW CODE: pragma solidity ^0.4.25;

contract Wallet {
    uint[] private bonusCodes;
    address private owner;

    constructor() public {
        bonusCodes = new uint[](0);
        owner = msg.sender;
    }

    function () public payable {
    }

    function PushBonusCode(uint c) public {
        bonusCodes.push(c);
    }

    function PopBonusCode() public {
        require(bonusCodes.length > 0); 
        bonusCodes.length--; 
    }

    function UpdateBonusCodeAt(uint idx, uint c) public {
        require(idx < bonusCodes.length);
        bonusCodes[idx] = c; 
    }

    function Destroy() public {
        require(msg.sender == owner);
        selfdestruct(msg.sender);
    }
} 

