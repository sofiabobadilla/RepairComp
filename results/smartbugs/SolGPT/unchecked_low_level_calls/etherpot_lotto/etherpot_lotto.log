2024-07-04 18:19:36,626 - root - INFO - 
Reading file 'etherpot_lotto.sol' 

2024-07-04 18:19:36,629 - root - INFO - 
Pragma: 0.4.11 

2024-07-04 18:19:36,629 - root - INFO - 
Processing /home/mokita/sc_study/smartbugs-curated/dataset/unchecked_low_level_calls/etherpot_lotto.sol 

2024-07-04 18:19:36,630 - root - INFO - 
try 1/4: /home/mokita/sc_study/smartbugs-curated/dataset/unchecked_low_level_calls/etherpot_lotto_1round.sol  

2024-07-04 18:19:36,639 - root - INFO - 

        Docker container name: slither
        Docker image name: trailofbits/eth-security-toolbox
        Docker shared folder: /home/mokita/sc_study/smartbugs-curated/dataset:/home/ethsec/shared
        Docker command: None
         

2024-07-04 18:19:36,641 - root - INFO - 
Running command: solc-select use --always-install 0.4.11 

2024-07-04 18:19:36,807 - root - INFO - 
Running command: slither shared/unchecked_low_level_calls/etherpot_lotto.sol --json - 

2024-07-04 18:19:37,690 - root - INFO - 
b'{"success": true, "error": null, "results": {"detectors": [{"elements": [{"type": "function", "name": "calculateWinner", "source_mapping": {"start": 1756, "length": 1067, "filename_relative": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_absolute": "/home/ethsec/shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_short": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "is_dependency": false, "lines": [47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70], "starting_column": 6, "ending_column": 7}, "type_specific_fields": {"parent": {"type": "contract", "name": "Lotto", "source_mapping": {"start": 189, "length": 5519, "filename_relative": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_absolute": "/home/ethsec/shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_short": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "is_dependency": false, "lines": [10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162], "starting_column": 2, "ending_column": 3}}, "signature": "calculateWinner(uint256,uint256)"}}, {"type": "node", "name": "winningTicketIndex = decisionBlockHash % rounds[roundIndex].ticketsCount", "source_mapping": {"start": 2290, "length": 74, "filename_relative": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_absolute": "/home/ethsec/shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_short": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "is_dependency": false, "lines": [57], "starting_column": 10, "ending_column": 84}, "type_specific_fields": {"parent": {"type": "function", "name": "calculateWinner", "source_mapping": {"start": 1756, "length": 1067, "filename_relative": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_absolute": "/home/ethsec/shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_short": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "is_dependency": false, "lines": [47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70], "starting_column": 6, "ending_column": 7}, "type_specific_fields": {"parent": {"type": "contract", "name": "Lotto", "source_mapping": {"start": 189, "length": 5519, "filename_relative": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_absolute": "/home/ethsec/shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_short": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "is_dependency": false, "lines": [10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162], "starting_column": 2, "ending_column": 3}}, "signature": "calculateWinner(uint256,uint256)"}}}}], "description": "Lotto.calculateWinner(uint256,uint256) (shared/unchecked_low_level_calls/etherpot_lotto.sol#47-70) uses a weak PRNG: \\"winningTicketIndex = decisionBlockHash % rounds[roundIndex].ticketsCount (shared/unchecked_low_level_calls/etherpot_lotto.sol#57)\\" \\n", "markdown": "[Lotto.calculateWinner(uint256,uint256)](shared/unchecked_low_level_calls/etherpot_lotto.sol#L47-L70) uses a weak PRNG: \\"[winningTicketIndex = decisionBlockHash % rounds[roundIndex].ticketsCount](shared/unchecked_low_level_calls/etherpot_lotto.sol#L57)\\" \\n", "first_markdown_element": "shared/unchecked_low_level_calls/etherpot_lotto.sol#L47-L70", "id": "12b1ac365defb2bb03624d9693d93ce3b5040caa8ac0b4c9362cf151c58fab0f", "check": "weak-prng", "impact": "High", "confidence": "Medium"}, {"elements": [{"type": "function", "name": "fallback", "source_mapping": {"start": 4698, "length": 1006, "filename_relative": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_absolute": "/home/ethsec/shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_short": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "is_dependency": false, "lines": [131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160], "starting_column": 6, "ending_column": 7}, "type_specific_fields": {"parent": {"type": "contract", "name": "Lotto", "source_mapping": {"start": 189, "length": 5519, "filename_relative": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_absolute": "/home/ethsec/shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_short": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "is_dependency": false, "lines": [10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162], "starting_column": 2, "ending_column": 3}}, "signature": "fallback()"}}, {"type": "node", "name": "msg.sender.send(msg.value - value)", "source_mapping": {"start": 5025, "length": 32, "filename_relative": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_absolute": "/home/ethsec/shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_short": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "is_dependency": false, "lines": [141], "starting_column": 14, "ending_column": 46}, "type_specific_fields": {"parent": {"type": "function", "name": "fallback", "source_mapping": {"start": 4698, "length": 1006, "filename_relative": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_absolute": "/home/ethsec/shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_short": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "is_dependency": false, "lines": [131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160], "starting_column": 6, "ending_column": 7}, "type_specific_fields": {"parent": {"type": "contract", "name": "Lotto", "source_mapping": {"start": 189, "length": 5519, "filename_relative": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_absolute": "/home/ethsec/shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_short": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "is_dependency": false, "lines": [10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162], "starting_column": 2, "ending_column": 3}}, "signature": "fallback()"}}}}], "description": "Lotto.fallback() (shared/unchecked_low_level_calls/etherpot_lotto.sol#131-160) ignores return value by msg.sender.send(msg.value - value) (shared/unchecked_low_level_calls/etherpot_lotto.sol#141)\\n", "markdown": "[Lotto.fallback()](shared/unchecked_low_level_calls/etherpot_lotto.sol#L131-L160) ignores return value by [msg.sender.send(msg.value - value)](shared/unchecked_low_level_calls/etherpot_lotto.sol#L141)\\n", "first_markdown_element": "shared/unchecked_low_level_calls/etherpot_lotto.sol#L131-L160", "id": "2bd1ba19246bc68276691dae37d03e2c10a7583f8fa05dd2b2ed0b999be54fef", "check": "unchecked-send", "impact": "Medium", "confidence": "Medium"}, {"elements": [{"type": "function", "name": "cash", "source_mapping": {"start": 3390, "length": 762, "filename_relative": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_absolute": "/home/ethsec/shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_short": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "is_dependency": false, "lines": [89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113], "starting_column": 6, "ending_column": 7}, "type_specific_fields": {"parent": {"type": "contract", "name": "Lotto", "source_mapping": {"start": 189, "length": 5519, "filename_relative": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_absolute": "/home/ethsec/shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_short": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "is_dependency": false, "lines": [10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162], "starting_column": 2, "ending_column": 3}}, "signature": "cash(uint256,uint256)"}}, {"type": "node", "name": "winner.send(subpot)", "source_mapping": {"start": 4030, "length": 19, "filename_relative": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_absolute": "/home/ethsec/shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_short": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "is_dependency": false, "lines": [109], "starting_column": 10, "ending_column": 29}, "type_specific_fields": {"parent": {"type": "function", "name": "cash", "source_mapping": {"start": 3390, "length": 762, "filename_relative": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_absolute": "/home/ethsec/shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_short": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "is_dependency": false, "lines": [89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113], "starting_column": 6, "ending_column": 7}, "type_specific_fields": {"parent": {"type": "contract", "name": "Lotto", "source_mapping": {"start": 189, "length": 5519, "filename_relative": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_absolute": "/home/ethsec/shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_short": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "is_dependency": false, "lines": [10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162], "starting_column": 2, "ending_column": 3}}, "signature": "cash(uint256,uint256)"}}}}], "description": "Lotto.cash(uint256,uint256) (shared/unchecked_low_level_calls/etherpot_lotto.sol#89-113) ignores return value by winner.send(subpot) (shared/unchecked_low_level_calls/etherpot_lotto.sol#109)\\n", "markdown": "[Lotto.cash(uint256,uint256)](shared/unchecked_low_level_calls/etherpot_lotto.sol#L89-L113) ignores return value by [winner.send(subpot)](shared/unchecked_low_level_calls/etherpot_lotto.sol#L109)\\n", "first_markdown_element": "shared/unchecked_low_level_calls/etherpot_lotto.sol#L89-L113", "id": "35d6ed057280f46f3751095f4647f45e419198ce4ccc98633b2d0db8b3c511fc", "check": "unchecked-send", "impact": "Medium", "confidence": "Medium"}, {"elements": [{"type": "node", "name": "uint256(block.blockhash(blockIndex))", "source_mapping": {"start": 4233, "length": 40, "filename_relative": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_absolute": "/home/ethsec/shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_short": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "is_dependency": false, "lines": [116], "starting_column": 10, "ending_column": 50}, "type_specific_fields": {"parent": {"type": "function", "name": "getHashOfBlock", "source_mapping": {"start": 4159, "length": 122, "filename_relative": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_absolute": "/home/ethsec/shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_short": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "is_dependency": false, "lines": [115, 116, 117], "starting_column": 6, "ending_column": 7}, "type_specific_fields": {"parent": {"type": "contract", "name": "Lotto", "source_mapping": {"start": 189, "length": 5519, "filename_relative": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_absolute": "/home/ethsec/shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_short": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "is_dependency": false, "lines": [10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162], "starting_column": 2, "ending_column": 3}}, "signature": "getHashOfBlock(uint256)"}}}}], "description": "Deprecated standard detected uint256(block.blockhash(blockIndex)) (shared/unchecked_low_level_calls/etherpot_lotto.sol#116):\\n\\t- Usage of \\"block.blockhash()\\" should be replaced with \\"blockhash()\\"\\n", "markdown": "Deprecated standard detected [uint256(block.blockhash(blockIndex))](shared/unchecked_low_level_calls/etherpot_lotto.sol#L116):\\n\\t- Usage of \\"block.blockhash()\\" should be replaced with \\"blockhash()\\"\\n", "first_markdown_element": "shared/unchecked_low_level_calls/etherpot_lotto.sol#L116", "id": "c8ffaf9e90ba34ff7cb8b9dceb36a918d5af59af0aff138690575a741d7165a3", "check": "deprecated-standards", "impact": "Informational", "confidence": "High"}, {"elements": [], "description": "solc-0.4.11 is not recommended for deployment\\n", "markdown": "solc-0.4.11 is not recommended for deployment\\n", "first_markdown_element": "", "id": "ae83d48790cd633ba7c2546237b2b7b315df466f7ac70ed9b19932c059aba74b", "check": "solc-version", "impact": "Informational", "confidence": "High"}, {"elements": [{"type": "pragma", "name": "^0.4.0", "source_mapping": {"start": 163, "length": 23, "filename_relative": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_absolute": "/home/ethsec/shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_short": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "is_dependency": false, "lines": [8], "starting_column": 1, "ending_column": 24}, "type_specific_fields": {"directive": ["solidity", "^", "0.4", ".0"]}}], "description": "Pragma version^0.4.0 (shared/unchecked_low_level_calls/etherpot_lotto.sol#8) allows old versions\\n", "markdown": "Pragma version[^0.4.0](shared/unchecked_low_level_calls/etherpot_lotto.sol#L8) allows old versions\\n", "first_markdown_element": "shared/unchecked_low_level_calls/etherpot_lotto.sol#L8", "id": "e978b98a6a71797d978d91d362157d91d303a74111b285da17d917639ff492fb", "check": "solc-version", "impact": "Informational", "confidence": "High"}, {"elements": [{"type": "function", "name": "cash", "source_mapping": {"start": 3390, "length": 762, "filename_relative": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_absolute": "/home/ethsec/shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_short": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "is_dependency": false, "lines": [89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113], "starting_column": 6, "ending_column": 7}, "type_specific_fields": {"parent": {"type": "contract", "name": "Lotto", "source_mapping": {"start": 189, "length": 5519, "filename_relative": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_absolute": "/home/ethsec/shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_short": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "is_dependency": false, "lines": [10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162], "starting_column": 2, "ending_column": 3}}, "signature": "cash(uint256,uint256)"}}, {"type": "node", "name": "winner.send(subpot)", "source_mapping": {"start": 4030, "length": 19, "filename_relative": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_absolute": "/home/ethsec/shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_short": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "is_dependency": false, "lines": [109], "starting_column": 10, "ending_column": 29}, "type_specific_fields": {"parent": {"type": "function", "name": "cash", "source_mapping": {"start": 3390, "length": 762, "filename_relative": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_absolute": "/home/ethsec/shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_short": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "is_dependency": false, "lines": [89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113], "starting_column": 6, "ending_column": 7}, "type_specific_fields": {"parent": {"type": "contract", "name": "Lotto", "source_mapping": {"start": 189, "length": 5519, "filename_relative": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_absolute": "/home/ethsec/shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_short": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "is_dependency": false, "lines": [10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162], "starting_column": 2, "ending_column": 3}}, "signature": "cash(uint256,uint256)"}}}, "additional_fields": {"underlying_type": "external_calls"}}, {"type": "node", "name": "rounds[roundIndex].isCashed[subpotIndex] = true", "source_mapping": {"start": 4061, "length": 47, "filename_relative": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_absolute": "/home/ethsec/shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_short": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "is_dependency": false, "lines": [111], "starting_column": 10, "ending_column": 57}, "type_specific_fields": {"parent": {"type": "function", "name": "cash", "source_mapping": {"start": 3390, "length": 762, "filename_relative": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_absolute": "/home/ethsec/shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_short": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "is_dependency": false, "lines": [89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113], "starting_column": 6, "ending_column": 7}, "type_specific_fields": {"parent": {"type": "contract", "name": "Lotto", "source_mapping": {"start": 189, "length": 5519, "filename_relative": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_absolute": "/home/ethsec/shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_short": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "is_dependency": false, "lines": [10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162], "starting_column": 2, "ending_column": 3}}, "signature": "cash(uint256,uint256)"}}}, "additional_fields": {"underlying_type": "variables_written", "variable_name": "rounds"}}], "description": "Reentrancy in Lotto.cash(uint256,uint256) (shared/unchecked_low_level_calls/etherpot_lotto.sol#89-113):\\n\\tExternal calls:\\n\\t- winner.send(subpot) (shared/unchecked_low_level_calls/etherpot_lotto.sol#109)\\n\\tState variables written after the call(s):\\n\\t- rounds[roundIndex].isCashed[subpotIndex] = true (shared/unchecked_low_level_calls/etherpot_lotto.sol#111)\\n", "markdown": "Reentrancy in [Lotto.cash(uint256,uint256)](shared/unchecked_low_level_calls/etherpot_lotto.sol#L89-L113):\\n\\tExternal calls:\\n\\t- [winner.send(subpot)](shared/unchecked_low_level_calls/etherpot_lotto.sol#L109)\\n\\tState variables written after the call(s):\\n\\t- [rounds[roundIndex].isCashed[subpotIndex] = true](shared/unchecked_low_level_calls/etherpot_lotto.sol#L111)\\n", "first_markdown_element": "shared/unchecked_low_level_calls/etherpot_lotto.sol#L89-L113", "id": "1060cf3151df78b5cc830bddd24f1985c2f8bbe9f53cdfdb651df0aa8429cd5a", "check": "reentrancy-unlimited-gas", "impact": "Informational", "confidence": "Medium"}, {"elements": [{"type": "function", "name": "fallback", "source_mapping": {"start": 4698, "length": 1006, "filename_relative": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_absolute": "/home/ethsec/shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_short": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "is_dependency": false, "lines": [131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160], "starting_column": 6, "ending_column": 7}, "type_specific_fields": {"parent": {"type": "contract", "name": "Lotto", "source_mapping": {"start": 189, "length": 5519, "filename_relative": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_absolute": "/home/ethsec/shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_short": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "is_dependency": false, "lines": [10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162], "starting_column": 2, "ending_column": 3}}, "signature": "fallback()"}}, {"type": "node", "name": "msg.sender.send(msg.value - value)", "source_mapping": {"start": 5025, "length": 32, "filename_relative": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_absolute": "/home/ethsec/shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_short": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "is_dependency": false, "lines": [141], "starting_column": 14, "ending_column": 46}, "type_specific_fields": {"parent": {"type": "function", "name": "fallback", "source_mapping": {"start": 4698, "length": 1006, "filename_relative": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_absolute": "/home/ethsec/shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_short": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "is_dependency": false, "lines": [131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160], "starting_column": 6, "ending_column": 7}, "type_specific_fields": {"parent": {"type": "contract", "name": "Lotto", "source_mapping": {"start": 189, "length": 5519, "filename_relative": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_absolute": "/home/ethsec/shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_short": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "is_dependency": false, "lines": [10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162], "starting_column": 2, "ending_column": 3}}, "signature": "fallback()"}}}, "additional_fields": {"underlying_type": "external_calls"}}, {"type": "node", "name": "rounds[roundIndex].ticketsCount += ticketsCount", "source_mapping": {"start": 5180, "length": 45, "filename_relative": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_absolute": "/home/ethsec/shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_short": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "is_dependency": false, "lines": [146], "starting_column": 10, "ending_column": 55}, "type_specific_fields": {"parent": {"type": "function", "name": "fallback", "source_mapping": {"start": 4698, "length": 1006, "filename_relative": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_absolute": "/home/ethsec/shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_short": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "is_dependency": false, "lines": [131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160], "starting_column": 6, "ending_column": 7}, "type_specific_fields": {"parent": {"type": "contract", "name": "Lotto", "source_mapping": {"start": 189, "length": 5519, "filename_relative": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_absolute": "/home/ethsec/shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_short": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "is_dependency": false, "lines": [10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162], "starting_column": 2, "ending_column": 3}}, "signature": "fallback()"}}}, "additional_fields": {"underlying_type": "variables_written", "variable_name": "rounds"}}, {"type": "node", "name": "buyersLength = rounds[roundIndex].buyers.length ++", "source_mapping": {"start": 5309, "length": 53, "filename_relative": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_absolute": "/home/ethsec/shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_short": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "is_dependency": false, "lines": [149], "starting_column": 14, "ending_column": 67}, "type_specific_fields": {"parent": {"type": "function", "name": "fallback", "source_mapping": {"start": 4698, "length": 1006, "filename_relative": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_absolute": "/home/ethsec/shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_short": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "is_dependency": false, "lines": [131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160], "starting_column": 6, "ending_column": 7}, "type_specific_fields": {"parent": {"type": "contract", "name": "Lotto", "source_mapping": {"start": 189, "length": 5519, "filename_relative": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_absolute": "/home/ethsec/shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_short": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "is_dependency": false, "lines": [10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162], "starting_column": 2, "ending_column": 3}}, "signature": "fallback()"}}}, "additional_fields": {"underlying_type": "variables_written", "variable_name": "rounds"}}, {"type": "node", "name": "rounds[roundIndex].buyers[buyersLength] = msg.sender", "source_mapping": {"start": 5377, "length": 52, "filename_relative": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_absolute": "/home/ethsec/shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_short": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "is_dependency": false, "lines": [150], "starting_column": 14, "ending_column": 66}, "type_specific_fields": {"parent": {"type": "function", "name": "fallback", "source_mapping": {"start": 4698, "length": 1006, "filename_relative": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_absolute": "/home/ethsec/shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_short": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "is_dependency": false, "lines": [131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160], "starting_column": 6, "ending_column": 7}, "type_specific_fields": {"parent": {"type": "contract", "name": "Lotto", "source_mapping": {"start": 189, "length": 5519, "filename_relative": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_absolute": "/home/ethsec/shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_short": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "is_dependency": false, "lines": [10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162], "starting_column": 2, "ending_column": 3}}, "signature": "fallback()"}}}, "additional_fields": {"underlying_type": "variables_written", "variable_name": "rounds"}}, {"type": "node", "name": "rounds[roundIndex].ticketsCountByBuyer[msg.sender] += ticketsCount", "source_mapping": {"start": 5452, "length": 64, "filename_relative": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_absolute": "/home/ethsec/shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_short": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "is_dependency": false, "lines": [153], "starting_column": 10, "ending_column": 74}, "type_specific_fields": {"parent": {"type": "function", "name": "fallback", "source_mapping": {"start": 4698, "length": 1006, "filename_relative": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_absolute": "/home/ethsec/shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_short": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "is_dependency": false, "lines": [131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160], "starting_column": 6, "ending_column": 7}, "type_specific_fields": {"parent": {"type": "contract", "name": "Lotto", "source_mapping": {"start": 189, "length": 5519, "filename_relative": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_absolute": "/home/ethsec/shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_short": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "is_dependency": false, "lines": [10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162], "starting_column": 2, "ending_column": 3}}, "signature": "fallback()"}}}, "additional_fields": {"underlying_type": "variables_written", "variable_name": "rounds"}}, {"type": "node", "name": "rounds[roundIndex].ticketsCount += ticketsCount", "source_mapping": {"start": 5527, "length": 45, "filename_relative": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_absolute": "/home/ethsec/shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_short": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "is_dependency": false, "lines": [154], "starting_column": 10, "ending_column": 55}, "type_specific_fields": {"parent": {"type": "function", "name": "fallback", "source_mapping": {"start": 4698, "length": 1006, "filename_relative": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_absolute": "/home/ethsec/shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_short": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "is_dependency": false, "lines": [131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160], "starting_column": 6, "ending_column": 7}, "type_specific_fields": {"parent": {"type": "contract", "name": "Lotto", "source_mapping": {"start": 189, "length": 5519, "filename_relative": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_absolute": "/home/ethsec/shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_short": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "is_dependency": false, "lines": [10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162], "starting_column": 2, "ending_column": 3}}, "signature": "fallback()"}}}, "additional_fields": {"underlying_type": "variables_written", "variable_name": "rounds"}}, {"type": "node", "name": "rounds[roundIndex].pot += value", "source_mapping": {"start": 5627, "length": 29, "filename_relative": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_absolute": "/home/ethsec/shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_short": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "is_dependency": false, "lines": [157], "starting_column": 10, "ending_column": 39}, "type_specific_fields": {"parent": {"type": "function", "name": "fallback", "source_mapping": {"start": 4698, "length": 1006, "filename_relative": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_absolute": "/home/ethsec/shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_short": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "is_dependency": false, "lines": [131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160], "starting_column": 6, "ending_column": 7}, "type_specific_fields": {"parent": {"type": "contract", "name": "Lotto", "source_mapping": {"start": 189, "length": 5519, "filename_relative": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_absolute": "/home/ethsec/shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_short": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "is_dependency": false, "lines": [10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162], "starting_column": 2, "ending_column": 3}}, "signature": "fallback()"}}}, "additional_fields": {"underlying_type": "variables_written", "variable_name": "rounds"}}], "description": "Reentrancy in Lotto.fallback() (shared/unchecked_low_level_calls/etherpot_lotto.sol#131-160):\\n\\tExternal calls:\\n\\t- msg.sender.send(msg.value - value) (shared/unchecked_low_level_calls/etherpot_lotto.sol#141)\\n\\tState variables written after the call(s):\\n\\t- rounds[roundIndex].ticketsCount += ticketsCount (shared/unchecked_low_level_calls/etherpot_lotto.sol#146)\\n\\t- buyersLength = rounds[roundIndex].buyers.length ++ (shared/unchecked_low_level_calls/etherpot_lotto.sol#149)\\n\\t- rounds[roundIndex].buyers[buyersLength] = msg.sender (shared/unchecked_low_level_calls/etherpot_lotto.sol#150)\\n\\t- rounds[roundIndex].ticketsCountByBuyer[msg.sender] += ticketsCount (shared/unchecked_low_level_calls/etherpot_lotto.sol#153)\\n\\t- rounds[roundIndex].ticketsCount += ticketsCount (shared/unchecked_low_level_calls/etherpot_lotto.sol#154)\\n\\t- rounds[roundIndex].pot += value (shared/unchecked_low_level_calls/etherpot_lotto.sol#157)\\n", "markdown": "Reentrancy in [Lotto.fallback()](shared/unchecked_low_level_calls/etherpot_lotto.sol#L131-L160):\\n\\tExternal calls:\\n\\t- [msg.sender.send(msg.value - value)](shared/unchecked_low_level_calls/etherpot_lotto.sol#L141)\\n\\tState variables written after the call(s):\\n\\t- [rounds[roundIndex].ticketsCount += ticketsCount](shared/unchecked_low_level_calls/etherpot_lotto.sol#L146)\\n\\t- [buyersLength = rounds[roundIndex].buyers.length ++](shared/unchecked_low_level_calls/etherpot_lotto.sol#L149)\\n\\t- [rounds[roundIndex].buyers[buyersLength] = msg.sender](shared/unchecked_low_level_calls/etherpot_lotto.sol#L150)\\n\\t- [rounds[roundIndex].ticketsCountByBuyer[msg.sender] += ticketsCount](shared/unchecked_low_level_calls/etherpot_lotto.sol#L153)\\n\\t- [rounds[roundIndex].ticketsCount += ticketsCount](shared/unchecked_low_level_calls/etherpot_lotto.sol#L154)\\n\\t- [rounds[roundIndex].pot += value](shared/unchecked_low_level_calls/etherpot_lotto.sol#L157)\\n", "first_markdown_element": "shared/unchecked_low_level_calls/etherpot_lotto.sol#L131-L160", "id": "96ee5067cd63734609734a3c5ee2f72a89c02cdb3545fa6a7a935937c09545a5", "check": "reentrancy-unlimited-gas", "impact": "Informational", "confidence": "Medium"}, {"elements": [{"type": "function", "name": "slitherConstructorConstantVariables", "source_mapping": {"start": 189, "length": 5519, "filename_relative": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_absolute": "/home/ethsec/shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_short": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "is_dependency": false, "lines": [10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162], "starting_column": 2, "ending_column": 3}, "type_specific_fields": {"parent": {"type": "contract", "name": "Lotto", "source_mapping": {"start": 189, "length": 5519, "filename_relative": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_absolute": "/home/ethsec/shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_short": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "is_dependency": false, "lines": [10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162], "starting_column": 2, "ending_column": 3}}, "signature": "slitherConstructorConstantVariables()"}}, {"type": "node", "name": "ticketPrice = 100000000000000000", "source_mapping": {"start": 450, "length": 53, "filename_relative": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_absolute": "/home/ethsec/shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_short": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "is_dependency": false, "lines": [15], "starting_column": 6, "ending_column": 59}, "type_specific_fields": {"parent": {"type": "function", "name": "slitherConstructorConstantVariables", "source_mapping": {"start": 189, "length": 5519, "filename_relative": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_absolute": "/home/ethsec/shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_short": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "is_dependency": false, "lines": [10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162], "starting_column": 2, "ending_column": 3}, "type_specific_fields": {"parent": {"type": "contract", "name": "Lotto", "source_mapping": {"start": 189, "length": 5519, "filename_relative": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_absolute": "/home/ethsec/shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_short": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "is_dependency": false, "lines": [10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162], "starting_column": 2, "ending_column": 3}}, "signature": "slitherConstructorConstantVariables()"}}}}], "description": "Lotto.slitherConstructorConstantVariables() (shared/unchecked_low_level_calls/etherpot_lotto.sol#10-162) uses literals with too many digits:\\n\\t- ticketPrice = 100000000000000000 (shared/unchecked_low_level_calls/etherpot_lotto.sol#15)\\n", "markdown": "[Lotto.slitherConstructorConstantVariables()](shared/unchecked_low_level_calls/etherpot_lotto.sol#L10-L162) uses literals with too many digits:\\n\\t- [ticketPrice = 100000000000000000](shared/unchecked_low_level_calls/etherpot_lotto.sol#L15)\\n", "first_markdown_element": "shared/unchecked_low_level_calls/etherpot_lotto.sol#L10-L162", "id": "c87f3c9fe66142bdc01cc29fc1d8892a2b320c760e8b09f3b93dba4390506a8a", "check": "too-many-digits", "impact": "Informational", "confidence": "Medium"}, {"elements": [{"type": "function", "name": "slitherConstructorConstantVariables", "source_mapping": {"start": 189, "length": 5519, "filename_relative": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_absolute": "/home/ethsec/shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_short": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "is_dependency": false, "lines": [10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162], "starting_column": 2, "ending_column": 3}, "type_specific_fields": {"parent": {"type": "contract", "name": "Lotto", "source_mapping": {"start": 189, "length": 5519, "filename_relative": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_absolute": "/home/ethsec/shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_short": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "is_dependency": false, "lines": [10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162], "starting_column": 2, "ending_column": 3}}, "signature": "slitherConstructorConstantVariables()"}}, {"type": "node", "name": "blockReward = 5000000000000000000", "source_mapping": {"start": 556, "length": 54, "filename_relative": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_absolute": "/home/ethsec/shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_short": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "is_dependency": false, "lines": [18], "starting_column": 6, "ending_column": 60}, "type_specific_fields": {"parent": {"type": "function", "name": "slitherConstructorConstantVariables", "source_mapping": {"start": 189, "length": 5519, "filename_relative": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_absolute": "/home/ethsec/shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_short": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "is_dependency": false, "lines": [10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162], "starting_column": 2, "ending_column": 3}, "type_specific_fields": {"parent": {"type": "contract", "name": "Lotto", "source_mapping": {"start": 189, "length": 5519, "filename_relative": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_absolute": "/home/ethsec/shared/unchecked_low_level_calls/etherpot_lotto.sol", "filename_short": "shared/unchecked_low_level_calls/etherpot_lotto.sol", "is_dependency": false, "lines": [10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162], "starting_column": 2, "ending_column": 3}}, "signature": "slitherConstructorConstantVariables()"}}}}], "description": "Lotto.slitherConstructorConstantVariables() (shared/unchecked_low_level_calls/etherpot_lotto.sol#10-162) uses literals with too many digits:\\n\\t- blockReward = 5000000000000000000 (shared/unchecked_low_level_calls/etherpot_lotto.sol#18)\\n", "markdown": "[Lotto.slitherConstructorConstantVariables()](shared/unchecked_low_level_calls/etherpot_lotto.sol#L10-L162) uses literals with too many digits:\\n\\t- [blockReward = 5000000000000000000](shared/unchecked_low_level_calls/etherpot_lotto.sol#L18)\\n", "first_markdown_element": "shared/unchecked_low_level_calls/etherpot_lotto.sol#L10-L162", "id": "f1764e33f3dfd5ccdd098ff9ae6c857097b0fd88743da65ebb18a25afabfed70", "check": "too-many-digits", "impact": "Informational", "confidence": "Medium"}]}}\n' 

2024-07-04 18:19:37,700 - root - INFO - 
Found 3 vulnerabilities of severity Medium 

2024-07-04 18:19:53,960 - root - INFO - 
NEW CODE: pragma solidity ^0.4.0;

contract Lotto {

    uint constant public blocksPerRound = 6800;
    uint constant public ticketPrice = 100000000000000000;
    uint constant public blockReward = 5000000000000000000;

    function getBlocksPerRound() constant returns(uint) { 
        return blocksPerRound; 
    }

    function getTicketPrice() constant returns(uint) { 
        return ticketPrice; 
    }

    struct Round {
        address[] buyers;
        uint pot;
        uint ticketsCount;
        mapping(uint=>bool) isCashed;
        mapping(address=>uint) ticketsCountByBuyer;
    }

    mapping(uint => Round) rounds;

    function getRoundIndex() constant returns (uint) {
        return block.number/blocksPerRound;
    }

    function getIsCashed(uint roundIndex, uint subpotIndex) constant returns (bool) {
        return rounds[roundIndex].isCashed[subpotIndex];
    }

    function calculateWinner(uint roundIndex, uint subpotIndex) constant returns(address) {
        var decisionBlockNumber = getDecisionBlockNumber(roundIndex, subpotIndex);

        if(decisionBlockNumber > block.number) {
            return address(0);
        }

        var decisionBlockHash = getHashOfBlock(decisionBlockNumber);
        var winningTicketIndex = decisionBlockHash % rounds[roundIndex].ticketsCount;

        var ticketIndex = 0;

        for(uint buyerIndex = 0; buyerIndex < rounds[roundIndex].buyers.length; buyerIndex++) {
            var buyer = rounds[roundIndex].buyers[buyerIndex];
            ticketIndex += rounds[roundIndex].ticketsCountByBuyer[buyer];

            if(ticketIndex > winningTicketIndex) {
                return buyer;
            }
        }
    }

    function getDecisionBlockNumber(uint roundIndex, uint subpotIndex) constant returns (uint) {
        return ((roundIndex + 1) * blocksPerRound) + subpotIndex;
    }

    function getSubpotsCount(uint roundIndex) constant returns(uint) {
        var subpotsCount = rounds[roundIndex].pot / blockReward;

        if(rounds[roundIndex].pot % blockReward > 0) {
            subpotsCount++;
        }

        return subpotsCount;
    }

    function getSubpot(uint roundIndex) constant returns(uint) {
        return rounds[roundIndex].pot / getSubpotsCount(roundIndex);
    }

    function cash(uint roundIndex, uint subpotIndex) {
        var subpotsCount = getSubpotsCount(roundIndex);

        if(subpotIndex >= subpotsCount) {
            return;
        }

        var decisionBlockNumber = getDecisionBlockNumber(roundIndex, subpotIndex);

        if(decisionBlockNumber > block.number) {
            return;
        }

        if(rounds[roundIndex].isCashed[subpotIndex]) {
            return;
        }

        var winner = calculateWinner(roundIndex, subpotIndex);
        var subpot = getSubpot(roundIndex);

        if(winner != address(0)) {
            winner.transfer(subpot);
            rounds[roundIndex].isCashed[subpotIndex] = true;
        }
    }

    function getHashOfBlock(uint blockIndex) constant returns(uint) {
        return uint(block.blockhash(blockIndex));
    }

    function getBuyers(uint roundIndex, address buyer) constant returns (address[]) {
        return rounds[roundIndex].buyers;
    }

    function getTicketsCountByBuyer(uint roundIndex, address buyer) constant returns (uint) {
        return rounds[roundIndex].ticketsCountByBuyer[buyer];
    }

    function getPot(uint roundIndex) constant returns(uint) {
        return rounds[roundIndex].pot;
    }

    function() payable {
        var roundIndex = getRoundIndex();
        var value = msg.value - (msg.value % ticketPrice);

        if(value == 0) {
            return;
        }

        if(value < msg.value) {
            msg.sender.transfer(msg.value - value);
        }

        var ticketsCount = value / ticketPrice;
        rounds[roundIndex].ticketsCount += ticketsCount;

        if(rounds[roundIndex].ticketsCountByBuyer[msg.sender] == 0) {
            rounds[roundIndex].buyers.push(msg.sender);
        }

        rounds[roundIndex].ticketsCountByBuyer[msg.sender] += ticketsCount;
        rounds[roundIndex].pot += value;
    }
} 

2024-07-04 18:19:53,960 - root - INFO - 
try 2/4: /home/mokita/sc_study/smartbugs-curated/dataset/unchecked_low_level_calls/etherpot_lotto_2round.sol  

2024-07-04 18:19:53,960 - root - INFO - 
Found 3 vulnerabilities of severity Medium 

2024-07-04 18:20:03,626 - root - INFO - 
NEW CODE: pragma solidity ^0.4.0;

contract Lotto {

    uint constant public blocksPerRound = 6800;
    uint constant public ticketPrice = 100000000000000000;
    uint constant public blockReward = 5000000000000000000;

    function getBlocksPerRound() public view returns(uint) { 
        return blocksPerRound; 
    }

    function getTicketPrice() public view returns(uint) { 
        return ticketPrice; 
    }

    struct Round {
        address[] buyers;
        uint pot;
        uint ticketsCount;
        mapping(uint=>bool) isCashed;
        mapping(address=>uint) ticketsCountByBuyer;
    }

    mapping(uint => Round) rounds;

    function getRoundIndex() public view returns (uint) {
        return block.number/blocksPerRound;
    }

    function getIsCashed(uint roundIndex, uint subpotIndex) public view returns (bool) {
        return rounds[roundIndex].isCashed[subpotIndex];
    }

    function calculateWinner(uint roundIndex, uint subpotIndex) public view returns(address) {
        uint decisionBlockNumber = getDecisionBlockNumber(roundIndex, subpotIndex);

        if(decisionBlockNumber > block.number) {
            return address(0);
        }

        bytes32 decisionBlockHash = block.blockhash(decisionBlockNumber);
        uint winningTicketIndex = uint(decisionBlockHash) % rounds[roundIndex].ticketsCount;

        uint ticketIndex = 0;

        for(uint i = 0; i < rounds[roundIndex].buyers.length; i++) {
            address buyer = rounds[roundIndex].buyers[i];
            ticketIndex += rounds[roundIndex].ticketsCountByBuyer[buyer];

            if(ticketIndex > winningTicketIndex) {
                return buyer;
            }
        }
    }

    function getDecisionBlockNumber(uint roundIndex, uint subpotIndex) public view returns (uint) {
        return ((roundIndex + 1) * blocksPerRound) + subpotIndex;
    }

    function getSubpotsCount(uint roundIndex) public view returns(uint) {
        uint subpotsCount = rounds[roundIndex].pot / blockReward;

        if(rounds[roundIndex].pot % blockReward > 0) {
            subpotsCount++;
        }

        return subpotsCount;
    }

    function getSubpot(uint roundIndex) public view returns(uint) {
        return rounds[roundIndex].pot / getSubpotsCount(roundIndex);
    }

    function cash(uint roundIndex, uint subpotIndex) public {
        uint subpotsCount = getSubpotsCount(roundIndex);

        if(subpotIndex >= subpotsCount) {
            return;
        }

        uint decisionBlockNumber = getDecisionBlockNumber(roundIndex, subpotIndex);

        if(decisionBlockNumber > block.number) {
            return;
        }

        if(rounds[roundIndex].isCashed[subpotIndex]) {
            return;
        }

        address winner = calculateWinner(roundIndex, subpotIndex);
        uint subpot = getSubpot(roundIndex);

        winner.transfer(subpot);

        rounds[roundIndex].isCashed[subpotIndex] = true;
    }

    function getBuyers(uint roundIndex, address buyer) public view returns (address[]) {
        return rounds[roundIndex].buyers;
    }

    function getTicketsCountByBuyer(uint roundIndex, address buyer) public view returns (uint) {
        return rounds[roundIndex].ticketsCountByBuyer[buyer];
    }

    function getPot(uint roundIndex) public view returns (uint) {
        return rounds[roundIndex].pot;
    }

    function() public payable {
        uint roundIndex = getRoundIndex();
        uint value = msg.value - (msg.value % ticketPrice);

        if(value == 0) {
            return;
        }

        if(value < msg.value) {
            msg.sender.transfer(msg.value - value);
        }

        uint ticketsCount = value / ticketPrice;
        rounds[roundIndex].ticketsCount += ticketsCount;

        if(rounds[roundIndex].ticketsCountByBuyer[msg.sender] == 0) {
            rounds[roundIndex].buyers.push(msg.sender);
        }

        rounds[roundIndex].ticketsCountByBuyer[msg.sender] += ticketsCount;
        rounds[roundIndex].pot += value;
    }
} 

2024-07-04 18:20:03,626 - root - INFO - 
try 3/4: /home/mokita/sc_study/smartbugs-curated/dataset/unchecked_low_level_calls/etherpot_lotto_3round.sol  

2024-07-04 18:20:03,626 - root - INFO - 
Found 3 vulnerabilities of severity Medium 

2024-07-04 18:20:20,421 - root - INFO - 
NEW CODE: pragma solidity ^0.4.24;

contract Lotto {

    uint constant public blocksPerRound = 6800;
    uint constant public ticketPrice = 100000000000000000;
    uint constant public blockReward = 5000000000000000000;

    function getBlocksPerRound() public view returns(uint) {
        return blocksPerRound;
    }

    function getTicketPrice() public view returns(uint) {
        return ticketPrice;
    }

    struct Round {
        address[] buyers;
        uint pot;
        uint ticketsCount;
        mapping(uint=>bool) isCashed;
        mapping(address=>uint) ticketsCountByBuyer;
    }

    mapping(uint => Round) rounds;

    function getRoundIndex() public view returns (uint) {
        return block.number/blocksPerRound;
    }

    function getIsCashed(uint roundIndex, uint subpotIndex) public view returns (bool) {
        return rounds[roundIndex].isCashed[subpotIndex];
    }

    function calculateWinner(uint roundIndex, uint subpotIndex) public view returns(address) {
        uint decisionBlockNumber = getDecisionBlockNumber(roundIndex, subpotIndex);

        if(decisionBlockNumber > block.number) {
            return address(0);
        }

        bytes32 decisionBlockHash = blockhash(decisionBlockNumber);
        uint winningTicketIndex = uint(decisionBlockHash) % rounds[roundIndex].ticketsCount;

        uint ticketIndex = 0;

        for(uint i = 0; i < rounds[roundIndex].buyers.length; i++) {
            address buyer = rounds[roundIndex].buyers[i];
            ticketIndex += rounds[roundIndex].ticketsCountByBuyer[buyer];

            if(ticketIndex > winningTicketIndex) {
                return buyer;
            }
        }
    }

    function getDecisionBlockNumber(uint roundIndex, uint subpotIndex) public view returns (uint) {
        return ((roundIndex + 1) * blocksPerRound) + subpotIndex;
    }

    function getSubpotsCount(uint roundIndex) public view returns(uint) {
        uint subpotsCount = rounds[roundIndex].pot / blockReward;

        if(rounds[roundIndex].pot % blockReward > 0) {
            subpotsCount++;
        }

        return subpotsCount;
    }

    function getSubpot(uint roundIndex) public view returns(uint) {
        return rounds[roundIndex].pot / getSubpotsCount(roundIndex);
    }

    function cash(uint roundIndex, uint subpotIndex) public {
        uint subpotsCount = getSubpotsCount(roundIndex);

        if(subpotIndex >= subpotsCount) {
            return;
        }

        uint decisionBlockNumber = getDecisionBlockNumber(roundIndex, subpotIndex);

        if(decisionBlockNumber > block.number) {
            return;
        }

        if(rounds[roundIndex].isCashed[subpotIndex]) {
            return;
        }

        address winner = calculateWinner(roundIndex, subpotIndex);
        uint subpot = getSubpot(roundIndex);

        winner.transfer(subpot);

        rounds[roundIndex].isCashed[subpotIndex] = true;
    }

    function getBuyers(uint roundIndex, address buyer) public view returns (address[]) {
        return rounds[roundIndex].buyers;
    }

    function getTicketsCountByBuyer(uint roundIndex, address buyer) public view returns (uint) {
        return rounds[roundIndex].ticketsCountByBuyer[buyer];
    }

    function getPot(uint roundIndex) public view returns (uint) {
        return rounds[roundIndex].pot;
    }

    function() public payable {
        uint roundIndex = getRoundIndex();
        uint value = msg.value - (msg.value % ticketPrice);

        if(value == 0) {
            return;
        }

        if(value < msg.value) {
            msg.sender.transfer(msg.value - value);
        }

        uint ticketsCount = value / ticketPrice;
        rounds[roundIndex].ticketsCount += ticketsCount;

        if(rounds[roundIndex].ticketsCountByBuyer[msg.sender] == 0) {
            rounds[roundIndex].buyers.push(msg.sender);
        }

        rounds[roundIndex].ticketsCountByBuyer[msg.sender] += ticketsCount;
        rounds[roundIndex].pot += value;
    }
} 

2024-07-04 18:20:20,424 - root - INFO - 
try 4/4: /home/mokita/sc_study/smartbugs-curated/dataset/unchecked_low_level_calls/etherpot_lotto_4round.sol  

2024-07-04 18:20:20,425 - root - INFO - 
Found 3 vulnerabilities of severity Medium 

2024-07-04 18:20:36,497 - root - INFO - 
NEW CODE: pragma solidity ^0.4.0;

contract Lotto {

    uint constant public blocksPerRound = 6800;
    uint constant public ticketPrice = 100000000000000000;
    uint constant public blockReward = 5000000000000000000;

    function getBlocksPerRound() public view returns(uint) { 
        return blocksPerRound; 
    }

    function getTicketPrice() public view returns(uint) { 
        return ticketPrice; 
    }

    struct Round {
        address[] buyers;
        uint pot;
        uint ticketsCount;
        mapping(uint=>bool) isCashed;
        mapping(address=>uint) ticketsCountByBuyer;
    }

    mapping(uint => Round) rounds;

    function getRoundIndex() public view returns (uint) {
        return block.number/blocksPerRound;
    }

    function getIsCashed(uint roundIndex, uint subpotIndex) public view returns (bool) {
        return rounds[roundIndex].isCashed[subpotIndex];
    }

    function calculateWinner(uint roundIndex, uint subpotIndex) public view returns(address) {
        uint decisionBlockNumber = getDecisionBlockNumber(roundIndex, subpotIndex);

        if(decisionBlockNumber > block.number) {
            return address(0);
        }

        bytes32 decisionBlockHash = block.blockhash(decisionBlockNumber);
        uint winningTicketIndex = uint(decisionBlockHash) % rounds[roundIndex].ticketsCount;

        uint ticketIndex = 0;

        for(uint i = 0; i < rounds[roundIndex].buyers.length; i++) {
            address buyer = rounds[roundIndex].buyers[i];
            ticketIndex += rounds[roundIndex].ticketsCountByBuyer[buyer];

            if(ticketIndex > winningTicketIndex) {
                return buyer;
            }
        }
    }

    function getDecisionBlockNumber(uint roundIndex, uint subpotIndex) public view returns (uint) {
        return ((roundIndex+1) * blocksPerRound) + subpotIndex;
    }

    function getSubpotsCount(uint roundIndex) public view returns(uint) {
        uint subpotsCount = rounds[roundIndex].pot / blockReward;

        if(rounds[roundIndex].pot % blockReward > 0) {
            subpotsCount++;
        }

        return subpotsCount;
    }

    function getSubpot(uint roundIndex) public view returns(uint) {
        return rounds[roundIndex].pot / getSubpotsCount(roundIndex);
    }

    function cash(uint roundIndex, uint subpotIndex) public {
        uint subpotsCount = getSubpotsCount(roundIndex);

        if(subpotIndex >= subpotsCount) {
            return;
        }

        uint decisionBlockNumber = getDecisionBlockNumber(roundIndex, subpotIndex);

        if(decisionBlockNumber > block.number) {
            return;
        }

        if(rounds[roundIndex].isCashed[subpotIndex]) {
            return;
        }

        address winner = calculateWinner(roundIndex, subpotIndex);
        uint subpot = getSubpot(roundIndex);

        winner.transfer(subpot);

        rounds[roundIndex].isCashed[subpotIndex] = true;
    }

    function getBuyers(uint roundIndex, address buyer) public view returns (address[]) {
        return rounds[roundIndex].buyers;
    }

    function getTicketsCountByBuyer(uint roundIndex, address buyer) public view returns (uint) {
        return rounds[roundIndex].ticketsCountByBuyer[buyer];
    }

    function getPot(uint roundIndex) public view returns (uint) {
        return rounds[roundIndex].pot;
    }

    function() public payable {
        uint roundIndex = getRoundIndex();
        uint value = msg.value - (msg.value % ticketPrice);

        if(value == 0) {
            return;
        }

        if(value < msg.value) {
            msg.sender.transfer(msg.value - value);
        }

        uint ticketsCount = value / ticketPrice;
        rounds[roundIndex].ticketsCount += ticketsCount;

        if(rounds[roundIndex].ticketsCountByBuyer[msg.sender] == 0) {
            rounds[roundIndex].buyers.push(msg.sender);
        }

        rounds[roundIndex].ticketsCountByBuyer[msg.sender] += ticketsCount;
        rounds[roundIndex].pot += value;
    }
} 

