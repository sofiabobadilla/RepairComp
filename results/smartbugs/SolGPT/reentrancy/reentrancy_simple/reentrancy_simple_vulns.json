{"success": true, "error": null, "results": {"detectors": [{"elements": [{"type": "function", "name": "withdrawBalance", "source_mapping": {"start": 447, "length": 349, "filename_relative": "shared/reentrancy/reentrancy_simple.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/reentrancy_simple.sol", "filename_short": "shared/reentrancy/reentrancy_simple.sol", "is_dependency": false, "lines": [20, 21, 22, 23, 24, 25, 26, 27, 28], "starting_column": 6, "ending_column": 7}, "type_specific_fields": {"parent": {"type": "contract", "name": "Reentrance", "source_mapping": {"start": 182, "length": 617, "filename_relative": "shared/reentrancy/reentrancy_simple.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/reentrancy_simple.sol", "filename_short": "shared/reentrancy/reentrancy_simple.sol", "is_dependency": false, "lines": [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29], "starting_column": 2, "ending_column": 3}}, "signature": "withdrawBalance()"}}, {"type": "node", "name": "! (msg.sender.call.value(userBalance[msg.sender])())", "source_mapping": {"start": 664, "length": 53, "filename_relative": "shared/reentrancy/reentrancy_simple.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/reentrancy_simple.sol", "filename_short": "shared/reentrancy/reentrancy_simple.sol", "is_dependency": false, "lines": [24], "starting_column": 14, "ending_column": 67}, "type_specific_fields": {"parent": {"type": "function", "name": "withdrawBalance", "source_mapping": {"start": 447, "length": 349, "filename_relative": "shared/reentrancy/reentrancy_simple.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/reentrancy_simple.sol", "filename_short": "shared/reentrancy/reentrancy_simple.sol", "is_dependency": false, "lines": [20, 21, 22, 23, 24, 25, 26, 27, 28], "starting_column": 6, "ending_column": 7}, "type_specific_fields": {"parent": {"type": "contract", "name": "Reentrance", "source_mapping": {"start": 182, "length": 617, "filename_relative": "shared/reentrancy/reentrancy_simple.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/reentrancy_simple.sol", "filename_short": "shared/reentrancy/reentrancy_simple.sol", "is_dependency": false, "lines": [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29], "starting_column": 2, "ending_column": 3}}, "signature": "withdrawBalance()"}}}, "additional_fields": {"underlying_type": "external_calls"}}, {"type": "node", "name": "userBalance[msg.sender] = 0", "source_mapping": {"start": 761, "length": 27, "filename_relative": "shared/reentrancy/reentrancy_simple.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/reentrancy_simple.sol", "filename_short": "shared/reentrancy/reentrancy_simple.sol", "is_dependency": false, "lines": [27], "starting_column": 10, "ending_column": 37}, "type_specific_fields": {"parent": {"type": "function", "name": "withdrawBalance", "source_mapping": {"start": 447, "length": 349, "filename_relative": "shared/reentrancy/reentrancy_simple.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/reentrancy_simple.sol", "filename_short": "shared/reentrancy/reentrancy_simple.sol", "is_dependency": false, "lines": [20, 21, 22, 23, 24, 25, 26, 27, 28], "starting_column": 6, "ending_column": 7}, "type_specific_fields": {"parent": {"type": "contract", "name": "Reentrance", "source_mapping": {"start": 182, "length": 617, "filename_relative": "shared/reentrancy/reentrancy_simple.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/reentrancy_simple.sol", "filename_short": "shared/reentrancy/reentrancy_simple.sol", "is_dependency": false, "lines": [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29], "starting_column": 2, "ending_column": 3}}, "signature": "withdrawBalance()"}}}, "additional_fields": {"underlying_type": "variables_written", "variable_name": "userBalance"}}], "description": "Reentrancy in Reentrance.withdrawBalance() (shared/reentrancy/reentrancy_simple.sol#20-28):\n\tExternal calls:\n\t- ! (msg.sender.call.value(userBalance[msg.sender])()) (shared/reentrancy/reentrancy_simple.sol#24)\n\tState variables written after the call(s):\n\t- userBalance[msg.sender] = 0 (shared/reentrancy/reentrancy_simple.sol#27)\n\tReentrance.userBalance (shared/reentrancy/reentrancy_simple.sol#10) can be used in cross function reentrancies:\n\t- Reentrance.addToBalance() (shared/reentrancy/reentrancy_simple.sol#16-18)\n\t- Reentrance.getBalance(address) (shared/reentrancy/reentrancy_simple.sol#12-14)\n\t- Reentrance.withdrawBalance() (shared/reentrancy/reentrancy_simple.sol#20-28)\n", "markdown": "Reentrancy in [Reentrance.withdrawBalance()](shared/reentrancy/reentrancy_simple.sol#L20-L28):\n\tExternal calls:\n\t- [! (msg.sender.call.value(userBalance[msg.sender])())](shared/reentrancy/reentrancy_simple.sol#L24)\n\tState variables written after the call(s):\n\t- [userBalance[msg.sender] = 0](shared/reentrancy/reentrancy_simple.sol#L27)\n\t[Reentrance.userBalance](shared/reentrancy/reentrancy_simple.sol#L10) can be used in cross function reentrancies:\n\t- [Reentrance.addToBalance()](shared/reentrancy/reentrancy_simple.sol#L16-L18)\n\t- [Reentrance.getBalance(address)](shared/reentrancy/reentrancy_simple.sol#L12-L14)\n\t- [Reentrance.withdrawBalance()](shared/reentrancy/reentrancy_simple.sol#L20-L28)\n", "first_markdown_element": "shared/reentrancy/reentrancy_simple.sol#L20-L28", "id": "a242803d58a4b9b3d4e03c9c22c05666ab473eaccab9b8fcd5155ef9465eda1e", "check": "reentrancy-eth", "impact": "High", "confidence": "Medium"}, {"elements": [{"type": "node", "name": "", "source_mapping": {"start": 734, "length": 5, "filename_relative": "shared/reentrancy/reentrancy_simple.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/reentrancy_simple.sol", "filename_short": "shared/reentrancy/reentrancy_simple.sol", "is_dependency": false, "lines": [25], "starting_column": 14, "ending_column": 19}, "type_specific_fields": {"parent": {"type": "function", "name": "withdrawBalance", "source_mapping": {"start": 447, "length": 349, "filename_relative": "shared/reentrancy/reentrancy_simple.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/reentrancy_simple.sol", "filename_short": "shared/reentrancy/reentrancy_simple.sol", "is_dependency": false, "lines": [20, 21, 22, 23, 24, 25, 26, 27, 28], "starting_column": 6, "ending_column": 7}, "type_specific_fields": {"parent": {"type": "contract", "name": "Reentrance", "source_mapping": {"start": 182, "length": 617, "filename_relative": "shared/reentrancy/reentrancy_simple.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/reentrancy_simple.sol", "filename_short": "shared/reentrancy/reentrancy_simple.sol", "is_dependency": false, "lines": [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29], "starting_column": 2, "ending_column": 3}}, "signature": "withdrawBalance()"}}}}], "description": "Deprecated standard detected THROW (shared/reentrancy/reentrancy_simple.sol#25):\n\t- Usage of \"throw\" should be replaced with \"revert()\"\n", "markdown": "Deprecated standard detected [THROW](shared/reentrancy/reentrancy_simple.sol#L25):\n\t- Usage of \"throw\" should be replaced with \"revert()\"\n", "first_markdown_element": "shared/reentrancy/reentrancy_simple.sol#L25", "id": "c81dd7a7450bac3afd68da7a0d4c0378088568a875e0ebce788df1bcdbe04267", "check": "deprecated-standards", "impact": "Informational", "confidence": "High"}, {"elements": [], "description": "solc-0.4.15 is not recommended for deployment\n", "markdown": "solc-0.4.15 is not recommended for deployment\n", "first_markdown_element": "", "id": "24aab652ab7a85bb6a06efb47ac54d3ac570e6c1c8549ade915f170c764ee912", "check": "solc-version", "impact": "Informational", "confidence": "High"}, {"elements": [{"type": "pragma", "name": "^0.4.15", "source_mapping": {"start": 155, "length": 24, "filename_relative": "shared/reentrancy/reentrancy_simple.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/reentrancy_simple.sol", "filename_short": "shared/reentrancy/reentrancy_simple.sol", "is_dependency": false, "lines": [7], "starting_column": 2, "ending_column": 26}, "type_specific_fields": {"directive": ["solidity", "^", "0.4", ".15"]}}], "description": "Pragma version^0.4.15 (shared/reentrancy/reentrancy_simple.sol#7) allows old versions\n", "markdown": "Pragma version[^0.4.15](shared/reentrancy/reentrancy_simple.sol#L7) allows old versions\n", "first_markdown_element": "shared/reentrancy/reentrancy_simple.sol#L7", "id": "3d32e6234620326a43989d845eb0c8a4d6b5c6cfeb9e95d5b555e34a269fac9d", "check": "solc-version", "impact": "Informational", "confidence": "High"}, {"elements": [{"type": "function", "name": "withdrawBalance", "source_mapping": {"start": 447, "length": 349, "filename_relative": "shared/reentrancy/reentrancy_simple.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/reentrancy_simple.sol", "filename_short": "shared/reentrancy/reentrancy_simple.sol", "is_dependency": false, "lines": [20, 21, 22, 23, 24, 25, 26, 27, 28], "starting_column": 6, "ending_column": 7}, "type_specific_fields": {"parent": {"type": "contract", "name": "Reentrance", "source_mapping": {"start": 182, "length": 617, "filename_relative": "shared/reentrancy/reentrancy_simple.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/reentrancy_simple.sol", "filename_short": "shared/reentrancy/reentrancy_simple.sol", "is_dependency": false, "lines": [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29], "starting_column": 2, "ending_column": 3}}, "signature": "withdrawBalance()"}}, {"type": "node", "name": "! (msg.sender.call.value(userBalance[msg.sender])())", "source_mapping": {"start": 664, "length": 53, "filename_relative": "shared/reentrancy/reentrancy_simple.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/reentrancy_simple.sol", "filename_short": "shared/reentrancy/reentrancy_simple.sol", "is_dependency": false, "lines": [24], "starting_column": 14, "ending_column": 67}, "type_specific_fields": {"parent": {"type": "function", "name": "withdrawBalance", "source_mapping": {"start": 447, "length": 349, "filename_relative": "shared/reentrancy/reentrancy_simple.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/reentrancy_simple.sol", "filename_short": "shared/reentrancy/reentrancy_simple.sol", "is_dependency": false, "lines": [20, 21, 22, 23, 24, 25, 26, 27, 28], "starting_column": 6, "ending_column": 7}, "type_specific_fields": {"parent": {"type": "contract", "name": "Reentrance", "source_mapping": {"start": 182, "length": 617, "filename_relative": "shared/reentrancy/reentrancy_simple.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/reentrancy_simple.sol", "filename_short": "shared/reentrancy/reentrancy_simple.sol", "is_dependency": false, "lines": [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29], "starting_column": 2, "ending_column": 3}}, "signature": "withdrawBalance()"}}}}], "description": "Low level call in Reentrance.withdrawBalance() (shared/reentrancy/reentrancy_simple.sol#20-28):\n\t- ! (msg.sender.call.value(userBalance[msg.sender])()) (shared/reentrancy/reentrancy_simple.sol#24)\n", "markdown": "Low level call in [Reentrance.withdrawBalance()](shared/reentrancy/reentrancy_simple.sol#L20-L28):\n\t- [! (msg.sender.call.value(userBalance[msg.sender])())](shared/reentrancy/reentrancy_simple.sol#L24)\n", "first_markdown_element": "shared/reentrancy/reentrancy_simple.sol#L20-L28", "id": "861bd583167a46572ee8f4a09d88a5ce397dfec35ee4a991deb84ac316e74534", "check": "low-level-calls", "impact": "Informational", "confidence": "High"}]}}