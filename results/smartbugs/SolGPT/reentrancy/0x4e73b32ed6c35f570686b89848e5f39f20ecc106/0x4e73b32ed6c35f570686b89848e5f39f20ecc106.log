2024-07-04 18:48:19,039 - root - INFO - 
Reading file '0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol' 

2024-07-04 18:48:19,040 - root - INFO - 
Pragma: 0.4.19 

2024-07-04 18:48:19,040 - root - INFO - 
Processing /home/mokita/sc_study/smartbugs-curated/dataset/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol 

2024-07-04 18:48:19,040 - root - INFO - 
try 1/4: /home/mokita/sc_study/smartbugs-curated/dataset/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106_1round.sol  

2024-07-04 18:48:19,047 - root - INFO - 

        Docker container name: slither
        Docker image name: trailofbits/eth-security-toolbox
        Docker shared folder: /home/mokita/sc_study/smartbugs-curated/dataset:/home/ethsec/shared
        Docker command: None
         

2024-07-04 18:48:19,049 - root - INFO - 
Running command: solc-select use --always-install 0.4.19 

2024-07-04 18:48:19,217 - root - INFO - 
Running command: slither shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol --json - 

2024-07-04 18:48:20,025 - root - INFO - 
b'{"success": true, "error": null, "results": {"detectors": [{"elements": [{"type": "contract", "name": "LogFile", "source_mapping": {"start": 1202, "length": 433, "filename_relative": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_short": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "is_dependency": false, "lines": [73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97], "starting_column": 1, "ending_column": 0}}, {"type": "node", "name": "History.push(LastMsg)", "source_mapping": {"start": 1605, "length": 21, "filename_relative": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_short": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "is_dependency": false, "lines": [94], "starting_column": 9, "ending_column": 30}, "type_specific_fields": {"parent": {"type": "function", "name": "AddMessage", "source_mapping": {"start": 1406, "length": 227, "filename_relative": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_short": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "is_dependency": false, "lines": [87, 88, 89, 90, 91, 92, 93, 94, 95], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "LogFile", "source_mapping": {"start": 1202, "length": 433, "filename_relative": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_short": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "is_dependency": false, "lines": [73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97], "starting_column": 1, "ending_column": 0}}, "signature": "AddMessage(address,uint256,string)"}}}}], "description": "LogFile (shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol#73-97) contract sets array length with a user-controlled value:\\n\\t- History.push(LastMsg) (shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol#94)\\n", "markdown": "[LogFile](shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol#L73-L97) contract sets array length with a user-controlled value:\\n\\t- [History.push(LastMsg)](shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol#L94)\\n", "first_markdown_element": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol#L73-L97", "id": "86c72c6dc0d457c470f60aa0b702f26ffae57d18de69cbfa35b921dd3d551378", "check": "controlled-array-length", "impact": "High", "confidence": "Medium"}, {"elements": [{"type": "function", "name": "Collect", "source_mapping": {"start": 749, "length": 366, "filename_relative": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_short": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "is_dependency": false, "lines": [47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "PRIVATE_ETH_CELL", "source_mapping": {"start": 102, "length": 1096, "filename_relative": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_short": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "is_dependency": false, "lines": [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69], "starting_column": 1, "ending_column": 2}}, "signature": "Collect(uint256)"}}, {"type": "node", "name": "msg.sender.call.value(_am)()", "source_mapping": {"start": 941, "length": 28, "filename_relative": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_short": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "is_dependency": false, "lines": [54], "starting_column": 16, "ending_column": 44}, "type_specific_fields": {"parent": {"type": "function", "name": "Collect", "source_mapping": {"start": 749, "length": 366, "filename_relative": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_short": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "is_dependency": false, "lines": [47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "PRIVATE_ETH_CELL", "source_mapping": {"start": 102, "length": 1096, "filename_relative": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_short": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "is_dependency": false, "lines": [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69], "starting_column": 1, "ending_column": 2}}, "signature": "Collect(uint256)"}}}, "additional_fields": {"underlying_type": "external_calls"}}, {"type": "node", "name": "balances[msg.sender] -= _am", "source_mapping": {"start": 1001, "length": 25, "filename_relative": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_short": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "is_dependency": false, "lines": [56], "starting_column": 17, "ending_column": 42}, "type_specific_fields": {"parent": {"type": "function", "name": "Collect", "source_mapping": {"start": 749, "length": 366, "filename_relative": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_short": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "is_dependency": false, "lines": [47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "PRIVATE_ETH_CELL", "source_mapping": {"start": 102, "length": 1096, "filename_relative": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_short": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "is_dependency": false, "lines": [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69], "starting_column": 1, "ending_column": 2}}, "signature": "Collect(uint256)"}}}, "additional_fields": {"underlying_type": "variables_written", "variable_name": "balances"}}], "description": "Reentrancy in PRIVATE_ETH_CELL.Collect(uint256) (shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol#47-60):\\n\\tExternal calls:\\n\\t- msg.sender.call.value(_am)() (shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol#54)\\n\\tState variables written after the call(s):\\n\\t- balances[msg.sender] -= _am (shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol#56)\\n\\tPRIVATE_ETH_CELL.balances (shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol#11) can be used in cross function reentrancies:\\n\\t- PRIVATE_ETH_CELL.Collect(uint256) (shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol#47-60)\\n\\t- PRIVATE_ETH_CELL.Deposit() (shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol#39-45)\\n\\t- PRIVATE_ETH_CELL.balances (shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol#11)\\n", "markdown": "Reentrancy in [PRIVATE_ETH_CELL.Collect(uint256)](shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol#L47-L60):\\n\\tExternal calls:\\n\\t- [msg.sender.call.value(_am)()](shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol#L54)\\n\\tState variables written after the call(s):\\n\\t- [balances[msg.sender] -= _am](shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol#L56)\\n\\t[PRIVATE_ETH_CELL.balances](shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol#L11) can be used in cross function reentrancies:\\n\\t- [PRIVATE_ETH_CELL.Collect(uint256)](shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol#L47-L60)\\n\\t- [PRIVATE_ETH_CELL.Deposit()](shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol#L39-L45)\\n\\t- [PRIVATE_ETH_CELL.balances](shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol#L11)\\n", "first_markdown_element": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol#L47-L60", "id": "1a332fc2c9bd1debd0fe6d1b0377f24601b79fa77f66648dbffaf5e1dcef2774", "check": "reentrancy-eth", "impact": "High", "confidence": "Medium"}, {"elements": [], "description": "solc-0.4.19 is not recommended for deployment\\n", "markdown": "solc-0.4.19 is not recommended for deployment\\n", "first_markdown_element": "", "id": "6c57d3efd769b2c1ca361b3d06ff1f2677845be92f7b50762125a4196d71725a", "check": "solc-version", "impact": "Informational", "confidence": "High"}, {"elements": [{"type": "pragma", "name": "^0.4.19", "source_mapping": {"start": 76, "length": 24, "filename_relative": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_short": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "is_dependency": false, "lines": [7], "starting_column": 1, "ending_column": 25}, "type_specific_fields": {"directive": ["solidity", "^", "0.4", ".19"]}}], "description": "Pragma version^0.4.19 (shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol#7) allows old versions\\n", "markdown": "Pragma version[^0.4.19](shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol#L7) allows old versions\\n", "first_markdown_element": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol#L7", "id": "9516177e3aa00f5767b9b5f7de33b178e0935beb97ef390b4fc5a99fe569a196", "check": "solc-version", "impact": "Informational", "confidence": "High"}, {"elements": [{"type": "function", "name": "Collect", "source_mapping": {"start": 749, "length": 366, "filename_relative": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_short": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "is_dependency": false, "lines": [47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "PRIVATE_ETH_CELL", "source_mapping": {"start": 102, "length": 1096, "filename_relative": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_short": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "is_dependency": false, "lines": [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69], "starting_column": 1, "ending_column": 2}}, "signature": "Collect(uint256)"}}, {"type": "node", "name": "msg.sender.call.value(_am)()", "source_mapping": {"start": 941, "length": 28, "filename_relative": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_short": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "is_dependency": false, "lines": [54], "starting_column": 16, "ending_column": 44}, "type_specific_fields": {"parent": {"type": "function", "name": "Collect", "source_mapping": {"start": 749, "length": 366, "filename_relative": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_short": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "is_dependency": false, "lines": [47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "PRIVATE_ETH_CELL", "source_mapping": {"start": 102, "length": 1096, "filename_relative": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_short": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "is_dependency": false, "lines": [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69], "starting_column": 1, "ending_column": 2}}, "signature": "Collect(uint256)"}}}}], "description": "Low level call in PRIVATE_ETH_CELL.Collect(uint256) (shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol#47-60):\\n\\t- msg.sender.call.value(_am)() (shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol#54)\\n", "markdown": "Low level call in [PRIVATE_ETH_CELL.Collect(uint256)](shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol#L47-L60):\\n\\t- [msg.sender.call.value(_am)()](shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol#L54)\\n", "first_markdown_element": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol#L47-L60", "id": "bdbeecf5a937bffc85d2141d6d7d1dcbca19bb7ec9bd79343cd3b77e84a1921a", "check": "low-level-calls", "impact": "Informational", "confidence": "High"}, {"elements": [{"type": "function", "name": "SetMinSum", "source_mapping": {"start": 267, "length": 106, "filename_relative": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_short": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "is_dependency": false, "lines": [19, 20, 21, 22, 23, 24], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "PRIVATE_ETH_CELL", "source_mapping": {"start": 102, "length": 1096, "filename_relative": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_short": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "is_dependency": false, "lines": [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69], "starting_column": 1, "ending_column": 2}}, "signature": "SetMinSum(uint256)"}, "additional_fields": {"target": "function", "convention": "mixedCase"}}], "description": "Function PRIVATE_ETH_CELL.SetMinSum(uint256) (shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol#19-24) is not in mixedCase\\n", "markdown": "Function [PRIVATE_ETH_CELL.SetMinSum(uint256)](shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol#L19-L24) is not in mixedCase\\n", "first_markdown_element": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol#L19-L24", "id": "298e72c8d536da5b0d7a7b78f0d73401f7795b4effd9cf53c8e28a54559a5bb7", "check": "naming-convention", "impact": "Informational", "confidence": "High"}, {"elements": [{"type": "function", "name": "SetLogFile", "source_mapping": {"start": 383, "length": 116, "filename_relative": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_short": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "is_dependency": false, "lines": [26, 27, 28, 29, 30, 31], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "PRIVATE_ETH_CELL", "source_mapping": {"start": 102, "length": 1096, "filename_relative": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_short": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "is_dependency": false, "lines": [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69], "starting_column": 1, "ending_column": 2}}, "signature": "SetLogFile(address)"}, "additional_fields": {"target": "function", "convention": "mixedCase"}}], "description": "Function PRIVATE_ETH_CELL.SetLogFile(address) (shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol#26-31) is not in mixedCase\\n", "markdown": "Function [PRIVATE_ETH_CELL.SetLogFile(address)](shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol#L26-L31) is not in mixedCase\\n", "first_markdown_element": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol#L26-L31", "id": "40cdc321dabbd40c094fc2390349c8bbe741c446a7e3f018ec1cd5636ca59c56", "check": "naming-convention", "impact": "Informational", "confidence": "High"}, {"elements": [{"type": "function", "name": "Collect", "source_mapping": {"start": 749, "length": 366, "filename_relative": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_short": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "is_dependency": false, "lines": [47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "PRIVATE_ETH_CELL", "source_mapping": {"start": 102, "length": 1096, "filename_relative": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_short": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "is_dependency": false, "lines": [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69], "starting_column": 1, "ending_column": 2}}, "signature": "Collect(uint256)"}, "additional_fields": {"target": "function", "convention": "mixedCase"}}], "description": "Function PRIVATE_ETH_CELL.Collect(uint256) (shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol#47-60) is not in mixedCase\\n", "markdown": "Function [PRIVATE_ETH_CELL.Collect(uint256)](shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol#L47-L60) is not in mixedCase\\n", "first_markdown_element": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol#L47-L60", "id": "59830a64475e645e24ad52311c936d6b3c3a5b5a30c15c42108b0dd5e2d93441", "check": "naming-convention", "impact": "Informational", "confidence": "High"}, {"elements": [{"type": "variable", "name": "_val", "source_mapping": {"start": 286, "length": 9, "filename_relative": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_short": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "is_dependency": false, "lines": [19], "starting_column": 24, "ending_column": 33}, "type_specific_fields": {"parent": {"type": "function", "name": "SetMinSum", "source_mapping": {"start": 267, "length": 106, "filename_relative": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_short": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "is_dependency": false, "lines": [19, 20, 21, 22, 23, 24], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "PRIVATE_ETH_CELL", "source_mapping": {"start": 102, "length": 1096, "filename_relative": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_short": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "is_dependency": false, "lines": [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69], "starting_column": 1, "ending_column": 2}}, "signature": "SetMinSum(uint256)"}}}, "additional_fields": {"target": "parameter", "convention": "mixedCase"}}], "description": "Parameter PRIVATE_ETH_CELL.SetMinSum(uint256)._val (shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol#19) is not in mixedCase\\n", "markdown": "Parameter [PRIVATE_ETH_CELL.SetMinSum(uint256)._val](shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol#L19) is not in mixedCase\\n", "first_markdown_element": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol#L19", "id": "6e320868ceb1e29bfc53a58ba2e2d8626713f6714124f528612eb48627e14c53", "check": "naming-convention", "impact": "Informational", "confidence": "High"}, {"elements": [{"type": "contract", "name": "PRIVATE_ETH_CELL", "source_mapping": {"start": 102, "length": 1096, "filename_relative": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_short": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "is_dependency": false, "lines": [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69], "starting_column": 1, "ending_column": 2}, "additional_fields": {"target": "contract", "convention": "CapWords"}}], "description": "Contract PRIVATE_ETH_CELL (shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol#9-69) is not in CapWords\\n", "markdown": "Contract [PRIVATE_ETH_CELL](shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol#L9-L69) is not in CapWords\\n", "first_markdown_element": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol#L9-L69", "id": "718d1733de057303353316e1837a6478a796d26810242790ca6b4a3d657ee151", "check": "naming-convention", "impact": "Informational", "confidence": "High"}, {"elements": [{"type": "variable", "name": "_adr", "source_mapping": {"start": 1426, "length": 12, "filename_relative": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_short": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "is_dependency": false, "lines": [87], "starting_column": 25, "ending_column": 37}, "type_specific_fields": {"parent": {"type": "function", "name": "AddMessage", "source_mapping": {"start": 1406, "length": 227, "filename_relative": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_short": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "is_dependency": false, "lines": [87, 88, 89, 90, 91, 92, 93, 94, 95], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "LogFile", "source_mapping": {"start": 1202, "length": 433, "filename_relative": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_short": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "is_dependency": false, "lines": [73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97], "starting_column": 1, "ending_column": 0}}, "signature": "AddMessage(address,uint256,string)"}}}, "additional_fields": {"target": "parameter", "convention": "mixedCase"}}], "description": "Parameter LogFile.AddMessage(address,uint256,string)._adr (shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol#87) is not in mixedCase\\n", "markdown": "Parameter [LogFile.AddMessage(address,uint256,string)._adr](shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol#L87) is not in mixedCase\\n", "first_markdown_element": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol#L87", "id": "7b7de59d0d9e60917cb218805b775a225e9faf2333b016b49958c53a659e18df", "check": "naming-convention", "impact": "Informational", "confidence": "High"}, {"elements": [{"type": "variable", "name": "LastMsg", "source_mapping": {"start": 1380, "length": 15, "filename_relative": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_short": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "is_dependency": false, "lines": [85], "starting_column": 5, "ending_column": 20}, "type_specific_fields": {"parent": {"type": "contract", "name": "LogFile", "source_mapping": {"start": 1202, "length": 433, "filename_relative": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_short": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "is_dependency": false, "lines": [73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97], "starting_column": 1, "ending_column": 0}}}, "additional_fields": {"target": "variable", "convention": "mixedCase"}}], "description": "Variable LogFile.LastMsg (shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol#85) is not in mixedCase\\n", "markdown": "Variable [LogFile.LastMsg](shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol#L85) is not in mixedCase\\n", "first_markdown_element": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol#L85", "id": "7f7486569b8c251dba34fa1cbdb901b671516d3339b1fb0d7a8260fc460724a6", "check": "naming-convention", "impact": "Informational", "confidence": "High"}, {"elements": [{"type": "variable", "name": "_val", "source_mapping": {"start": 1439, "length": 9, "filename_relative": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_short": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "is_dependency": false, "lines": [87], "starting_column": 38, "ending_column": 47}, "type_specific_fields": {"parent": {"type": "function", "name": "AddMessage", "source_mapping": {"start": 1406, "length": 227, "filename_relative": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_short": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "is_dependency": false, "lines": [87, 88, 89, 90, 91, 92, 93, 94, 95], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "LogFile", "source_mapping": {"start": 1202, "length": 433, "filename_relative": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_short": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "is_dependency": false, "lines": [73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97], "starting_column": 1, "ending_column": 0}}, "signature": "AddMessage(address,uint256,string)"}}}, "additional_fields": {"target": "parameter", "convention": "mixedCase"}}], "description": "Parameter LogFile.AddMessage(address,uint256,string)._val (shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol#87) is not in mixedCase\\n", "markdown": "Parameter [LogFile.AddMessage(address,uint256,string)._val](shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol#L87) is not in mixedCase\\n", "first_markdown_element": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol#L87", "id": "83f648c50c08d6777cac9b9404c7cd5ebdded4db0b3aaf3ae8767a405e3d34d6", "check": "naming-convention", "impact": "Informational", "confidence": "High"}, {"elements": [{"type": "variable", "name": "Log", "source_mapping": {"start": 218, "length": 11, "filename_relative": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_short": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "is_dependency": false, "lines": [15], "starting_column": 5, "ending_column": 16}, "type_specific_fields": {"parent": {"type": "contract", "name": "PRIVATE_ETH_CELL", "source_mapping": {"start": 102, "length": 1096, "filename_relative": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_short": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "is_dependency": false, "lines": [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69], "starting_column": 1, "ending_column": 2}}}, "additional_fields": {"target": "variable", "convention": "mixedCase"}}], "description": "Variable PRIVATE_ETH_CELL.Log (shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol#15) is not in mixedCase\\n", "markdown": "Variable [PRIVATE_ETH_CELL.Log](shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol#L15) is not in mixedCase\\n", "first_markdown_element": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol#L15", "id": "8bdf7c5c50ad1a5dd9bac6e01768f31fafb2e24820f6dc0411792e59614437b5", "check": "naming-convention", "impact": "Informational", "confidence": "High"}, {"elements": [{"type": "variable", "name": "MinSum", "source_mapping": {"start": 189, "length": 18, "filename_relative": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_short": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "is_dependency": false, "lines": [13], "starting_column": 5, "ending_column": 23}, "type_specific_fields": {"parent": {"type": "contract", "name": "PRIVATE_ETH_CELL", "source_mapping": {"start": 102, "length": 1096, "filename_relative": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_short": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "is_dependency": false, "lines": [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69], "starting_column": 1, "ending_column": 2}}}, "additional_fields": {"target": "variable", "convention": "mixedCase"}}], "description": "Variable PRIVATE_ETH_CELL.MinSum (shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol#13) is not in mixedCase\\n", "markdown": "Variable [PRIVATE_ETH_CELL.MinSum](shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol#L13) is not in mixedCase\\n", "first_markdown_element": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol#L13", "id": "8d710110d0de7c30f7377691cc466fab917468b7fc48c11498dee30bfabee541", "check": "naming-convention", "impact": "Informational", "confidence": "High"}, {"elements": [{"type": "variable", "name": "_data", "source_mapping": {"start": 1449, "length": 12, "filename_relative": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_short": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "is_dependency": false, "lines": [87], "starting_column": 48, "ending_column": 60}, "type_specific_fields": {"parent": {"type": "function", "name": "AddMessage", "source_mapping": {"start": 1406, "length": 227, "filename_relative": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_short": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "is_dependency": false, "lines": [87, 88, 89, 90, 91, 92, 93, 94, 95], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "LogFile", "source_mapping": {"start": 1202, "length": 433, "filename_relative": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_short": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "is_dependency": false, "lines": [73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97], "starting_column": 1, "ending_column": 0}}, "signature": "AddMessage(address,uint256,string)"}}}, "additional_fields": {"target": "parameter", "convention": "mixedCase"}}], "description": "Parameter LogFile.AddMessage(address,uint256,string)._data (shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol#87) is not in mixedCase\\n", "markdown": "Parameter [LogFile.AddMessage(address,uint256,string)._data](shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol#L87) is not in mixedCase\\n", "first_markdown_element": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol#L87", "id": "a6f2a0ac722b4593384968d36061cec8fc4a6b47fc330ab890529adb383f824c", "check": "naming-convention", "impact": "Informational", "confidence": "High"}, {"elements": [{"type": "variable", "name": "_am", "source_mapping": {"start": 766, "length": 8, "filename_relative": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_short": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "is_dependency": false, "lines": [47], "starting_column": 22, "ending_column": 30}, "type_specific_fields": {"parent": {"type": "function", "name": "Collect", "source_mapping": {"start": 749, "length": 366, "filename_relative": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_short": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "is_dependency": false, "lines": [47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "PRIVATE_ETH_CELL", "source_mapping": {"start": 102, "length": 1096, "filename_relative": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_short": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "is_dependency": false, "lines": [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69], "starting_column": 1, "ending_column": 2}}, "signature": "Collect(uint256)"}}}, "additional_fields": {"target": "parameter", "convention": "mixedCase"}}], "description": "Parameter PRIVATE_ETH_CELL.Collect(uint256)._am (shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol#47) is not in mixedCase\\n", "markdown": "Parameter [PRIVATE_ETH_CELL.Collect(uint256)._am](shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol#L47) is not in mixedCase\\n", "first_markdown_element": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol#L47", "id": "aa1cc875e141e1352b02d36e81b5678c190617d442d1696ab7def8f3a62fb929", "check": "naming-convention", "impact": "Informational", "confidence": "High"}, {"elements": [{"type": "function", "name": "Initialized", "source_mapping": {"start": 509, "length": 73, "filename_relative": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_short": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "is_dependency": false, "lines": [33, 34, 35, 36, 37], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "PRIVATE_ETH_CELL", "source_mapping": {"start": 102, "length": 1096, "filename_relative": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_short": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "is_dependency": false, "lines": [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69], "starting_column": 1, "ending_column": 2}}, "signature": "Initialized()"}, "additional_fields": {"target": "function", "convention": "mixedCase"}}], "description": "Function PRIVATE_ETH_CELL.Initialized() (shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol#33-37) is not in mixedCase\\n", "markdown": "Function [PRIVATE_ETH_CELL.Initialized()](shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol#L33-L37) is not in mixedCase\\n", "first_markdown_element": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol#L33-L37", "id": "abe6852641bdc660e44877c0ab0d32e4fc7de8f26ce90639ee84b28670851dd6", "check": "naming-convention", "impact": "Informational", "confidence": "High"}, {"elements": [{"type": "variable", "name": "History", "source_mapping": {"start": 1345, "length": 24, "filename_relative": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_short": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "is_dependency": false, "lines": [83], "starting_column": 5, "ending_column": 29}, "type_specific_fields": {"parent": {"type": "contract", "name": "LogFile", "source_mapping": {"start": 1202, "length": 433, "filename_relative": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_short": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "is_dependency": false, "lines": [73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97], "starting_column": 1, "ending_column": 0}}}, "additional_fields": {"target": "variable", "convention": "mixedCase"}}], "description": "Variable LogFile.History (shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol#83) is not in mixedCase\\n", "markdown": "Variable [LogFile.History](shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol#L83) is not in mixedCase\\n", "first_markdown_element": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol#L83", "id": "b8959d9d2a75b6d3dc23575557af2bbedbf431be60d598fd962b395014d6161c", "check": "naming-convention", "impact": "Informational", "confidence": "High"}, {"elements": [{"type": "function", "name": "AddMessage", "source_mapping": {"start": 1406, "length": 227, "filename_relative": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_short": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "is_dependency": false, "lines": [87, 88, 89, 90, 91, 92, 93, 94, 95], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "LogFile", "source_mapping": {"start": 1202, "length": 433, "filename_relative": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_short": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "is_dependency": false, "lines": [73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97], "starting_column": 1, "ending_column": 0}}, "signature": "AddMessage(address,uint256,string)"}, "additional_fields": {"target": "function", "convention": "mixedCase"}}], "description": "Function LogFile.AddMessage(address,uint256,string) (shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol#87-95) is not in mixedCase\\n", "markdown": "Function [LogFile.AddMessage(address,uint256,string)](shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol#L87-L95) is not in mixedCase\\n", "first_markdown_element": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol#L87-L95", "id": "c41211972cdd4933efc27c9f5968e9bc2825027b81e30a2717370b67b0dc86e9", "check": "naming-convention", "impact": "Informational", "confidence": "High"}, {"elements": [{"type": "variable", "name": "_log", "source_mapping": {"start": 403, "length": 12, "filename_relative": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_short": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "is_dependency": false, "lines": [26], "starting_column": 25, "ending_column": 37}, "type_specific_fields": {"parent": {"type": "function", "name": "SetLogFile", "source_mapping": {"start": 383, "length": 116, "filename_relative": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_short": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "is_dependency": false, "lines": [26, 27, 28, 29, 30, 31], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "PRIVATE_ETH_CELL", "source_mapping": {"start": 102, "length": 1096, "filename_relative": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_short": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "is_dependency": false, "lines": [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69], "starting_column": 1, "ending_column": 2}}, "signature": "SetLogFile(address)"}}}, "additional_fields": {"target": "parameter", "convention": "mixedCase"}}], "description": "Parameter PRIVATE_ETH_CELL.SetLogFile(address)._log (shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol#26) is not in mixedCase\\n", "markdown": "Parameter [PRIVATE_ETH_CELL.SetLogFile(address)._log](shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol#L26) is not in mixedCase\\n", "first_markdown_element": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol#L26", "id": "cbcffad0529534cc0da24d753bf8643591e009e98af8cd5e4384f7e83f16efb4", "check": "naming-convention", "impact": "Informational", "confidence": "High"}, {"elements": [{"type": "function", "name": "Deposit", "source_mapping": {"start": 592, "length": 147, "filename_relative": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_short": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "is_dependency": false, "lines": [39, 40, 41, 42, 43, 44, 45], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "PRIVATE_ETH_CELL", "source_mapping": {"start": 102, "length": 1096, "filename_relative": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_short": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "is_dependency": false, "lines": [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69], "starting_column": 1, "ending_column": 2}}, "signature": "Deposit()"}, "additional_fields": {"target": "function", "convention": "mixedCase"}}], "description": "Function PRIVATE_ETH_CELL.Deposit() (shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol#39-45) is not in mixedCase\\n", "markdown": "Function [PRIVATE_ETH_CELL.Deposit()](shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol#L39-L45) is not in mixedCase\\n", "first_markdown_element": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol#L39-L45", "id": "ce9e34ec49582febabb0d462b16f589f3403e165308790a06df447e8515b1e9f", "check": "naming-convention", "impact": "Informational", "confidence": "High"}, {"elements": [{"type": "function", "name": "AddMessage", "source_mapping": {"start": 1406, "length": 227, "filename_relative": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_short": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "is_dependency": false, "lines": [87, 88, 89, 90, 91, 92, 93, 94, 95], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "LogFile", "source_mapping": {"start": 1202, "length": 433, "filename_relative": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "filename_short": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol", "is_dependency": false, "lines": [73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97], "starting_column": 1, "ending_column": 0}}, "signature": "AddMessage(address,uint256,string)"}}], "description": "AddMessage(address,uint256,string) should be declared external:\\n\\t- LogFile.AddMessage(address,uint256,string) (shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol#87-95)\\n", "markdown": "AddMessage(address,uint256,string) should be declared external:\\n\\t- [LogFile.AddMessage(address,uint256,string)](shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol#L87-L95)\\n", "first_markdown_element": "shared/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106.sol#L87-L95", "id": "25d2235fb844b90cf9e56ea1c1b8b9cc6e32b18540f2108e0523adc1b1b6c004", "check": "external-function", "impact": "Optimization", "confidence": "High"}]}}\n' 

2024-07-04 18:48:20,030 - root - INFO - 
Found 2 vulnerabilities of severity Medium 

2024-07-04 18:48:24,094 - root - INFO - 
NEW CODE: pragma solidity ^0.4.19;

contract PRIVATE_ETH_CELL {
    mapping (address => uint256) public balances;
    
    uint public MinSum;
    
    LogFile Log;
    
    bool initialized;
    
    function SetMinSum(uint _val) public {
        require(!initialized);
        MinSum = _val;
    }
    
    function SetLogFile(address _log) public {
        require(!initialized);
        Log = LogFile(_log);
    }
    
    function Initialized() public {
        initialized = true;
    }
    
    function Deposit() public payable {
        balances[msg.sender] += msg.value;
        Log.AddMessage(msg.sender, msg.value, "Put");
    }
    
    function Collect(uint _am) public payable {
        require(balances[msg.sender] >= MinSum && balances[msg.sender] >= _am);
        
        balances[msg.sender] -= _am;
        Log.AddMessage(msg.sender, _am, "Collect");
        
        msg.sender.transfer(_am);
    }
    
    function() public payable {
        Deposit();
    }
}

contract LogFile {
    struct Message {
        address Sender;
        string Data;
        uint Val;
        uint Time;
    }
    
    Message[] public History;
    
    function AddMessage(address _adr, uint _val, string _data) public {
        Message memory newMessage;
        newMessage.Sender = _adr;
        newMessage.Time = now;
        newMessage.Val = _val;
        newMessage.Data = _data;
        History.push(newMessage);
    }
} 

2024-07-04 18:48:24,095 - root - INFO - 
try 2/4: /home/mokita/sc_study/smartbugs-curated/dataset/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106_2round.sol  

2024-07-04 18:48:24,095 - root - INFO - 
Found 2 vulnerabilities of severity Medium 

2024-07-04 18:48:29,724 - root - INFO - 
NEW CODE: Here is the fixed contract with the vulnerabilities addressed:

```solidity
pragma solidity ^0.4.19;

contract PRIVATE_ETH_CELL {
    mapping (address => uint256) public balances;
    uint public MinSum;
    LogFile Log;
    bool initialized;

    function SetMinSum(uint _val) public {
        require(!initialized);
        MinSum = _val;
    }

    function SetLogFile(address _log) public {
        require(!initialized);
        Log = LogFile(_log);
    }

    function Initialized() public {
        initialized = true;
    }

    function Deposit() public payable {
        balances[msg.sender] += msg.value;
        Log.AddMessage(msg.sender, msg.value, "Put");
    }

    function Collect(uint _am) public {
        require(balances[msg.sender] >= MinSum && balances[msg.sender] >= _am);
        
        balances[msg.sender] -= _am;
        Log.AddMessage(msg.sender, _am, "Collect");
        
        require(msg.sender.call.value(_am)());
    }

    function() public payable {
        Deposit();
    }
}

contract LogFile {
    struct Message {
        address Sender;
        string Data;
        uint Val;
        uint Time;
    }

    Message[] public History;

    function AddMessage(address _adr, uint _val, string _data) public {
        Message memory newMessage;
        newMessage.Sender = _adr;
        newMessage.Time = now;
        newMessage.Val = _val;
        newMessage.Data = _data;
        History.push(newMessage);
    }
}
```

Changes made:
1. In the LogFile contract, a new `Message` struct is created inside the `AddMessage` function to prevent reentrancy issues when pushing to the `History` array.
2. In the `Collect` function of the `PRIVATE_ETH_CELL` contract, the order of operations is changed to first deduct the balance and log the message before making the external call to prevent reentrancy vulnerabilities. 

2024-07-04 18:48:29,724 - root - INFO - 
try 3/4: /home/mokita/sc_study/smartbugs-curated/dataset/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106_3round.sol  

2024-07-04 18:48:29,725 - root - INFO - 
Found 2 vulnerabilities of severity Medium 

2024-07-04 18:48:35,150 - root - INFO - 
NEW CODE: Here is the fixed contract with the vulnerabilities addressed:

```solidity
pragma solidity ^0.4.19;

contract PRIVATE_ETH_CELL {
    mapping (address => uint256) public balances;
    uint public MinSum;
    LogFile Log;
    bool initialized;

    function SetMinSum(uint _val) public {
        require(!initialized);
        MinSum = _val;
    }

    function SetLogFile(address _log) public {
        require(!initialized);
        Log = LogFile(_log);
    }

    function Initialized() public {
        initialized = true;
    }

    function Deposit() public payable {
        balances[msg.sender] += msg.value;
        Log.AddMessage(msg.sender, msg.value, "Put");
    }

    function Collect(uint _am) public {
        require(balances[msg.sender] >= MinSum && balances[msg.sender] >= _am);
        
        balances[msg.sender] -= _am;
        Log.AddMessage(msg.sender, _am, "Collect");
        
        require(msg.sender.call.value(_am)());
    }

    function() public payable {
        Deposit();
    }
}

contract LogFile {
    struct Message {
        address Sender;
        string Data;
        uint Val;
        uint Time;
    }

    Message[] public History;

    function AddMessage(address _adr, uint _val, string _data) public {
        Message memory newMessage;
        newMessage.Sender = _adr;
        newMessage.Time = now;
        newMessage.Val = _val;
        newMessage.Data = _data;
        History.push(newMessage);
    }
}
```

Changes made:
1. Added `memory` keyword when creating a new `Message` struct in `LogFile.AddMessage` function to prevent reentrancy issues.
2. Moved the `balances[msg.sender] -= _am` and `Log.AddMessage` calls before the external call in `PRIVATE_ETH_CELL.Collect` function to prevent reentrancy vulnerabilities. 

2024-07-04 18:48:35,151 - root - INFO - 
try 4/4: /home/mokita/sc_study/smartbugs-curated/dataset/reentrancy/0x4e73b32ed6c35f570686b89848e5f39f20ecc106_4round.sol  

2024-07-04 18:48:35,151 - root - INFO - 
Found 2 vulnerabilities of severity Medium 

2024-07-04 18:48:40,066 - root - INFO - 
NEW CODE: Here is the fixed contract with the vulnerabilities addressed:

```solidity
pragma solidity ^0.4.19;

contract PRIVATE_ETH_CELL {
    mapping (address => uint256) public balances;
    uint public MinSum;
    LogFile Log;
    bool initialized;

    function SetMinSum(uint _val) public {
        require(!initialized);
        MinSum = _val;
    }

    function SetLogFile(address _log) public {
        require(!initialized);
        Log = LogFile(_log);
    }

    function Initialized() public {
        initialized = true;
    }

    function Deposit() public payable {
        balances[msg.sender] += msg.value;
        Log.AddMessage(msg.sender, msg.value, "Put");
    }

    function Collect(uint _am) public {
        require(balances[msg.sender] >= MinSum && balances[msg.sender] >= _am);
        
        balances[msg.sender] -= _am;
        Log.AddMessage(msg.sender, _am, "Collect");
        
        require(msg.sender.call.value(_am)());
    }

    function() public payable {
        Deposit();
    }
}

contract LogFile {
    struct Message {
        address Sender;
        string Data;
        uint Val;
        uint Time;
    }

    Message[] public History;

    function AddMessage(address _adr, uint _val, string _data) public {
        Message memory newMessage;
        newMessage.Sender = _adr;
        newMessage.Time = now;
        newMessage.Val = _val;
        newMessage.Data = _data;
        History.push(newMessage);
    }
}
```

Changes made:
1. In the LogFile contract, a new Message struct is created inside the AddMessage function to prevent reentrancy issues related to array length manipulation.
2. In the PRIVATE_ETH_CELL contract, the Collect function now first deducts the amount from the sender's balance before adding the message to the log and making the external call. This prevents reentrancy attacks where the external call could manipulate the balance before the deduction. 

