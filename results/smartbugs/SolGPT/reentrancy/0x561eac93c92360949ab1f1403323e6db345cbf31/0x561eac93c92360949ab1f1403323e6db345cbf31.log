2024-07-04 18:41:32,757 - root - INFO - 
Reading file '0x561eac93c92360949ab1f1403323e6db345cbf31.sol' 

2024-07-04 18:41:32,759 - root - INFO - 
Pragma: 0.4.19 

2024-07-04 18:41:32,759 - root - INFO - 
Processing /home/mokita/sc_study/smartbugs-curated/dataset/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol 

2024-07-04 18:41:32,759 - root - INFO - 
try 1/4: /home/mokita/sc_study/smartbugs-curated/dataset/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31_1round.sol  

2024-07-04 18:41:32,768 - root - INFO - 

        Docker container name: slither
        Docker image name: trailofbits/eth-security-toolbox
        Docker shared folder: /home/mokita/sc_study/smartbugs-curated/dataset:/home/ethsec/shared
        Docker command: None
         

2024-07-04 18:41:32,770 - root - INFO - 
Running command: solc-select use --always-install 0.4.19 

2024-07-04 18:41:32,940 - root - INFO - 
Running command: slither shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol --json - 

2024-07-04 18:41:33,787 - root - INFO - 
b'{"success": true, "error": null, "results": {"detectors": [{"elements": [{"type": "contract", "name": "LogFile", "source_mapping": {"start": 1193, "length": 433, "filename_relative": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_short": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "is_dependency": false, "lines": [73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97], "starting_column": 1, "ending_column": 0}}, {"type": "node", "name": "History.push(LastMsg)", "source_mapping": {"start": 1596, "length": 21, "filename_relative": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_short": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "is_dependency": false, "lines": [94], "starting_column": 9, "ending_column": 30}, "type_specific_fields": {"parent": {"type": "function", "name": "AddMessage", "source_mapping": {"start": 1397, "length": 227, "filename_relative": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_short": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "is_dependency": false, "lines": [87, 88, 89, 90, 91, 92, 93, 94, 95], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "LogFile", "source_mapping": {"start": 1193, "length": 433, "filename_relative": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_short": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "is_dependency": false, "lines": [73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97], "starting_column": 1, "ending_column": 0}}, "signature": "AddMessage(address,uint256,string)"}}}}], "description": "LogFile (shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol#73-97) contract sets array length with a user-controlled value:\\n\\t- History.push(LastMsg) (shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol#94)\\n", "markdown": "[LogFile](shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol#L73-L97) contract sets array length with a user-controlled value:\\n\\t- [History.push(LastMsg)](shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol#L94)\\n", "first_markdown_element": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol#L73-L97", "id": "3facfaf2ebcc68feea293063fba3063013f8b7881722faf03047c6afa5af1ece", "check": "controlled-array-length", "impact": "High", "confidence": "Medium"}, {"elements": [{"type": "function", "name": "Collect", "source_mapping": {"start": 740, "length": 366, "filename_relative": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_short": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "is_dependency": false, "lines": [47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "BANK_SAFE", "source_mapping": {"start": 102, "length": 1087, "filename_relative": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_short": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "is_dependency": false, "lines": [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69], "starting_column": 1, "ending_column": 2}}, "signature": "Collect(uint256)"}}, {"type": "node", "name": "msg.sender.call.value(_am)()", "source_mapping": {"start": 932, "length": 28, "filename_relative": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_short": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "is_dependency": false, "lines": [54], "starting_column": 16, "ending_column": 44}, "type_specific_fields": {"parent": {"type": "function", "name": "Collect", "source_mapping": {"start": 740, "length": 366, "filename_relative": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_short": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "is_dependency": false, "lines": [47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "BANK_SAFE", "source_mapping": {"start": 102, "length": 1087, "filename_relative": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_short": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "is_dependency": false, "lines": [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69], "starting_column": 1, "ending_column": 2}}, "signature": "Collect(uint256)"}}}, "additional_fields": {"underlying_type": "external_calls"}}, {"type": "node", "name": "balances[msg.sender] -= _am", "source_mapping": {"start": 992, "length": 25, "filename_relative": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_short": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "is_dependency": false, "lines": [56], "starting_column": 17, "ending_column": 42}, "type_specific_fields": {"parent": {"type": "function", "name": "Collect", "source_mapping": {"start": 740, "length": 366, "filename_relative": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_short": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "is_dependency": false, "lines": [47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "BANK_SAFE", "source_mapping": {"start": 102, "length": 1087, "filename_relative": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_short": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "is_dependency": false, "lines": [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69], "starting_column": 1, "ending_column": 2}}, "signature": "Collect(uint256)"}}}, "additional_fields": {"underlying_type": "variables_written", "variable_name": "balances"}}], "description": "Reentrancy in BANK_SAFE.Collect(uint256) (shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol#47-60):\\n\\tExternal calls:\\n\\t- msg.sender.call.value(_am)() (shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol#54)\\n\\tState variables written after the call(s):\\n\\t- balances[msg.sender] -= _am (shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol#56)\\n\\tBANK_SAFE.balances (shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol#11) can be used in cross function reentrancies:\\n\\t- BANK_SAFE.Collect(uint256) (shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol#47-60)\\n\\t- BANK_SAFE.Deposit() (shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol#39-45)\\n\\t- BANK_SAFE.balances (shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol#11)\\n", "markdown": "Reentrancy in [BANK_SAFE.Collect(uint256)](shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol#L47-L60):\\n\\tExternal calls:\\n\\t- [msg.sender.call.value(_am)()](shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol#L54)\\n\\tState variables written after the call(s):\\n\\t- [balances[msg.sender] -= _am](shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol#L56)\\n\\t[BANK_SAFE.balances](shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol#L11) can be used in cross function reentrancies:\\n\\t- [BANK_SAFE.Collect(uint256)](shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol#L47-L60)\\n\\t- [BANK_SAFE.Deposit()](shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol#L39-L45)\\n\\t- [BANK_SAFE.balances](shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol#L11)\\n", "first_markdown_element": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol#L47-L60", "id": "1113278d9a738eda2b3424155e9358cb6eabeff14db98150537b9953e46350a6", "check": "reentrancy-eth", "impact": "High", "confidence": "Medium"}, {"elements": [{"type": "node", "name": "", "source_mapping": {"start": 330, "length": 5, "filename_relative": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_short": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "is_dependency": false, "lines": [22], "starting_column": 24, "ending_column": 29}, "type_specific_fields": {"parent": {"type": "function", "name": "SetMinSum", "source_mapping": {"start": 260, "length": 105, "filename_relative": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_short": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "is_dependency": false, "lines": [19, 20, 21, 22, 23, 24], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "BANK_SAFE", "source_mapping": {"start": 102, "length": 1087, "filename_relative": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_short": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "is_dependency": false, "lines": [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69], "starting_column": 1, "ending_column": 2}}, "signature": "SetMinSum(uint256)"}}}}], "description": "Deprecated standard detected THROW (shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol#22):\\n\\t- Usage of \\"throw\\" should be replaced with \\"revert()\\"\\n", "markdown": "Deprecated standard detected [THROW](shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol#L22):\\n\\t- Usage of \\"throw\\" should be replaced with \\"revert()\\"\\n", "first_markdown_element": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol#L22", "id": "41865f9d2dfd9b91a8b5e85e31b1347b27ab4823f4e2cfa303baae6128d2298a", "check": "deprecated-standards", "impact": "Informational", "confidence": "High"}, {"elements": [{"type": "node", "name": "", "source_mapping": {"start": 449, "length": 5, "filename_relative": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_short": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "is_dependency": false, "lines": [29], "starting_column": 24, "ending_column": 29}, "type_specific_fields": {"parent": {"type": "function", "name": "SetLogFile", "source_mapping": {"start": 375, "length": 115, "filename_relative": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_short": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "is_dependency": false, "lines": [26, 27, 28, 29, 30, 31], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "BANK_SAFE", "source_mapping": {"start": 102, "length": 1087, "filename_relative": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_short": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "is_dependency": false, "lines": [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69], "starting_column": 1, "ending_column": 2}}, "signature": "SetLogFile(address)"}}}}], "description": "Deprecated standard detected THROW (shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol#29):\\n\\t- Usage of \\"throw\\" should be replaced with \\"revert()\\"\\n", "markdown": "Deprecated standard detected [THROW](shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol#L29):\\n\\t- Usage of \\"throw\\" should be replaced with \\"revert()\\"\\n", "first_markdown_element": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol#L29", "id": "81c9cb700532856659d85b690f3dbf126b2069acd5e75a8ab5d251b9dde2f01e", "check": "deprecated-standards", "impact": "Informational", "confidence": "High"}, {"elements": [], "description": "solc-0.4.19 is not recommended for deployment\\n", "markdown": "solc-0.4.19 is not recommended for deployment\\n", "first_markdown_element": "", "id": "6c57d3efd769b2c1ca361b3d06ff1f2677845be92f7b50762125a4196d71725a", "check": "solc-version", "impact": "Informational", "confidence": "High"}, {"elements": [{"type": "pragma", "name": "^0.4.19", "source_mapping": {"start": 76, "length": 24, "filename_relative": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_short": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "is_dependency": false, "lines": [7], "starting_column": 1, "ending_column": 25}, "type_specific_fields": {"directive": ["solidity", "^", "0.4", ".19"]}}], "description": "Pragma version^0.4.19 (shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol#7) allows old versions\\n", "markdown": "Pragma version[^0.4.19](shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol#L7) allows old versions\\n", "first_markdown_element": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol#L7", "id": "bfc92693b40b1ffa4e49d0af49878378cba237b780579b18aac51d825dec8e55", "check": "solc-version", "impact": "Informational", "confidence": "High"}, {"elements": [{"type": "function", "name": "Collect", "source_mapping": {"start": 740, "length": 366, "filename_relative": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_short": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "is_dependency": false, "lines": [47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "BANK_SAFE", "source_mapping": {"start": 102, "length": 1087, "filename_relative": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_short": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "is_dependency": false, "lines": [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69], "starting_column": 1, "ending_column": 2}}, "signature": "Collect(uint256)"}}, {"type": "node", "name": "msg.sender.call.value(_am)()", "source_mapping": {"start": 932, "length": 28, "filename_relative": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_short": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "is_dependency": false, "lines": [54], "starting_column": 16, "ending_column": 44}, "type_specific_fields": {"parent": {"type": "function", "name": "Collect", "source_mapping": {"start": 740, "length": 366, "filename_relative": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_short": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "is_dependency": false, "lines": [47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "BANK_SAFE", "source_mapping": {"start": 102, "length": 1087, "filename_relative": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_short": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "is_dependency": false, "lines": [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69], "starting_column": 1, "ending_column": 2}}, "signature": "Collect(uint256)"}}}}], "description": "Low level call in BANK_SAFE.Collect(uint256) (shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol#47-60):\\n\\t- msg.sender.call.value(_am)() (shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol#54)\\n", "markdown": "Low level call in [BANK_SAFE.Collect(uint256)](shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol#L47-L60):\\n\\t- [msg.sender.call.value(_am)()](shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol#L54)\\n", "first_markdown_element": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol#L47-L60", "id": "0d5101158d4d596915c60d75b255d2b41f50166ea7f4164bb1445c4e24675fa8", "check": "low-level-calls", "impact": "Informational", "confidence": "High"}, {"elements": [{"type": "variable", "name": "_am", "source_mapping": {"start": 757, "length": 8, "filename_relative": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_short": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "is_dependency": false, "lines": [47], "starting_column": 22, "ending_column": 30}, "type_specific_fields": {"parent": {"type": "function", "name": "Collect", "source_mapping": {"start": 740, "length": 366, "filename_relative": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_short": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "is_dependency": false, "lines": [47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "BANK_SAFE", "source_mapping": {"start": 102, "length": 1087, "filename_relative": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_short": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "is_dependency": false, "lines": [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69], "starting_column": 1, "ending_column": 2}}, "signature": "Collect(uint256)"}}}, "additional_fields": {"target": "parameter", "convention": "mixedCase"}}], "description": "Parameter BANK_SAFE.Collect(uint256)._am (shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol#47) is not in mixedCase\\n", "markdown": "Parameter [BANK_SAFE.Collect(uint256)._am](shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol#L47) is not in mixedCase\\n", "first_markdown_element": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol#L47", "id": "01b308c7ae6f90fc18ab0457b310567a18b8abc4991d9f54b7a00e3207106492", "check": "naming-convention", "impact": "Informational", "confidence": "High"}, {"elements": [{"type": "variable", "name": "MinSum", "source_mapping": {"start": 182, "length": 18, "filename_relative": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_short": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "is_dependency": false, "lines": [13], "starting_column": 5, "ending_column": 23}, "type_specific_fields": {"parent": {"type": "contract", "name": "BANK_SAFE", "source_mapping": {"start": 102, "length": 1087, "filename_relative": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_short": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "is_dependency": false, "lines": [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69], "starting_column": 1, "ending_column": 2}}}, "additional_fields": {"target": "variable", "convention": "mixedCase"}}], "description": "Variable BANK_SAFE.MinSum (shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol#13) is not in mixedCase\\n", "markdown": "Variable [BANK_SAFE.MinSum](shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol#L13) is not in mixedCase\\n", "first_markdown_element": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol#L13", "id": "0a64fb358cad009809c51404447e598803bbd0f58470555e07cae795a8966fde", "check": "naming-convention", "impact": "Informational", "confidence": "High"}, {"elements": [{"type": "function", "name": "Collect", "source_mapping": {"start": 740, "length": 366, "filename_relative": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_short": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "is_dependency": false, "lines": [47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "BANK_SAFE", "source_mapping": {"start": 102, "length": 1087, "filename_relative": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_short": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "is_dependency": false, "lines": [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69], "starting_column": 1, "ending_column": 2}}, "signature": "Collect(uint256)"}, "additional_fields": {"target": "function", "convention": "mixedCase"}}], "description": "Function BANK_SAFE.Collect(uint256) (shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol#47-60) is not in mixedCase\\n", "markdown": "Function [BANK_SAFE.Collect(uint256)](shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol#L47-L60) is not in mixedCase\\n", "first_markdown_element": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol#L47-L60", "id": "443fd470dc8d93b6b8deb87bb8550ebdd9ebde5a99ba5e0a614c9d6003fc0473", "check": "naming-convention", "impact": "Informational", "confidence": "High"}, {"elements": [{"type": "function", "name": "Initialized", "source_mapping": {"start": 500, "length": 73, "filename_relative": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_short": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "is_dependency": false, "lines": [33, 34, 35, 36, 37], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "BANK_SAFE", "source_mapping": {"start": 102, "length": 1087, "filename_relative": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_short": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "is_dependency": false, "lines": [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69], "starting_column": 1, "ending_column": 2}}, "signature": "Initialized()"}, "additional_fields": {"target": "function", "convention": "mixedCase"}}], "description": "Function BANK_SAFE.Initialized() (shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol#33-37) is not in mixedCase\\n", "markdown": "Function [BANK_SAFE.Initialized()](shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol#L33-L37) is not in mixedCase\\n", "first_markdown_element": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol#L33-L37", "id": "4e82b4aabd6cc8500622753da60eaae67763bce26ef70a62ac130bedaf308285", "check": "naming-convention", "impact": "Informational", "confidence": "High"}, {"elements": [{"type": "variable", "name": "_log", "source_mapping": {"start": 395, "length": 12, "filename_relative": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_short": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "is_dependency": false, "lines": [26], "starting_column": 25, "ending_column": 37}, "type_specific_fields": {"parent": {"type": "function", "name": "SetLogFile", "source_mapping": {"start": 375, "length": 115, "filename_relative": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_short": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "is_dependency": false, "lines": [26, 27, 28, 29, 30, 31], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "BANK_SAFE", "source_mapping": {"start": 102, "length": 1087, "filename_relative": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_short": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "is_dependency": false, "lines": [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69], "starting_column": 1, "ending_column": 2}}, "signature": "SetLogFile(address)"}}}, "additional_fields": {"target": "parameter", "convention": "mixedCase"}}], "description": "Parameter BANK_SAFE.SetLogFile(address)._log (shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol#26) is not in mixedCase\\n", "markdown": "Parameter [BANK_SAFE.SetLogFile(address)._log](shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol#L26) is not in mixedCase\\n", "first_markdown_element": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol#L26", "id": "5135a63af8cb5244c80920d9094c56ca17eb48aa4baac7bcaaf456267e362e06", "check": "naming-convention", "impact": "Informational", "confidence": "High"}, {"elements": [{"type": "contract", "name": "BANK_SAFE", "source_mapping": {"start": 102, "length": 1087, "filename_relative": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_short": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "is_dependency": false, "lines": [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69], "starting_column": 1, "ending_column": 2}, "additional_fields": {"target": "contract", "convention": "CapWords"}}], "description": "Contract BANK_SAFE (shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol#9-69) is not in CapWords\\n", "markdown": "Contract [BANK_SAFE](shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol#L9-L69) is not in CapWords\\n", "first_markdown_element": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol#L9-L69", "id": "6364127e3e67b39fe2c6709df85a13527d94adfd0a7fdbd371d2f31012be16dd", "check": "naming-convention", "impact": "Informational", "confidence": "High"}, {"elements": [{"type": "variable", "name": "_adr", "source_mapping": {"start": 1417, "length": 12, "filename_relative": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_short": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "is_dependency": false, "lines": [87], "starting_column": 25, "ending_column": 37}, "type_specific_fields": {"parent": {"type": "function", "name": "AddMessage", "source_mapping": {"start": 1397, "length": 227, "filename_relative": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_short": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "is_dependency": false, "lines": [87, 88, 89, 90, 91, 92, 93, 94, 95], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "LogFile", "source_mapping": {"start": 1193, "length": 433, "filename_relative": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_short": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "is_dependency": false, "lines": [73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97], "starting_column": 1, "ending_column": 0}}, "signature": "AddMessage(address,uint256,string)"}}}, "additional_fields": {"target": "parameter", "convention": "mixedCase"}}], "description": "Parameter LogFile.AddMessage(address,uint256,string)._adr (shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol#87) is not in mixedCase\\n", "markdown": "Parameter [LogFile.AddMessage(address,uint256,string)._adr](shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol#L87) is not in mixedCase\\n", "first_markdown_element": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol#L87", "id": "7b7de59d0d9e60917cb218805b775a225e9faf2333b016b49958c53a659e18df", "check": "naming-convention", "impact": "Informational", "confidence": "High"}, {"elements": [{"type": "variable", "name": "LastMsg", "source_mapping": {"start": 1371, "length": 15, "filename_relative": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_short": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "is_dependency": false, "lines": [85], "starting_column": 5, "ending_column": 20}, "type_specific_fields": {"parent": {"type": "contract", "name": "LogFile", "source_mapping": {"start": 1193, "length": 433, "filename_relative": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_short": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "is_dependency": false, "lines": [73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97], "starting_column": 1, "ending_column": 0}}}, "additional_fields": {"target": "variable", "convention": "mixedCase"}}], "description": "Variable LogFile.LastMsg (shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol#85) is not in mixedCase\\n", "markdown": "Variable [LogFile.LastMsg](shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol#L85) is not in mixedCase\\n", "first_markdown_element": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol#L85", "id": "7f7486569b8c251dba34fa1cbdb901b671516d3339b1fb0d7a8260fc460724a6", "check": "naming-convention", "impact": "Informational", "confidence": "High"}, {"elements": [{"type": "variable", "name": "_val", "source_mapping": {"start": 1430, "length": 9, "filename_relative": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_short": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "is_dependency": false, "lines": [87], "starting_column": 38, "ending_column": 47}, "type_specific_fields": {"parent": {"type": "function", "name": "AddMessage", "source_mapping": {"start": 1397, "length": 227, "filename_relative": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_short": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "is_dependency": false, "lines": [87, 88, 89, 90, 91, 92, 93, 94, 95], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "LogFile", "source_mapping": {"start": 1193, "length": 433, "filename_relative": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_short": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "is_dependency": false, "lines": [73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97], "starting_column": 1, "ending_column": 0}}, "signature": "AddMessage(address,uint256,string)"}}}, "additional_fields": {"target": "parameter", "convention": "mixedCase"}}], "description": "Parameter LogFile.AddMessage(address,uint256,string)._val (shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol#87) is not in mixedCase\\n", "markdown": "Parameter [LogFile.AddMessage(address,uint256,string)._val](shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol#L87) is not in mixedCase\\n", "first_markdown_element": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol#L87", "id": "83f648c50c08d6777cac9b9404c7cd5ebdded4db0b3aaf3ae8767a405e3d34d6", "check": "naming-convention", "impact": "Informational", "confidence": "High"}, {"elements": [{"type": "function", "name": "SetMinSum", "source_mapping": {"start": 260, "length": 105, "filename_relative": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_short": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "is_dependency": false, "lines": [19, 20, 21, 22, 23, 24], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "BANK_SAFE", "source_mapping": {"start": 102, "length": 1087, "filename_relative": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_short": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "is_dependency": false, "lines": [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69], "starting_column": 1, "ending_column": 2}}, "signature": "SetMinSum(uint256)"}, "additional_fields": {"target": "function", "convention": "mixedCase"}}], "description": "Function BANK_SAFE.SetMinSum(uint256) (shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol#19-24) is not in mixedCase\\n", "markdown": "Function [BANK_SAFE.SetMinSum(uint256)](shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol#L19-L24) is not in mixedCase\\n", "first_markdown_element": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol#L19-L24", "id": "95968e71815958e017c006ced3955594921ba7cb763019fb496f276e7c90c578", "check": "naming-convention", "impact": "Informational", "confidence": "High"}, {"elements": [{"type": "variable", "name": "Log", "source_mapping": {"start": 211, "length": 11, "filename_relative": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_short": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "is_dependency": false, "lines": [15], "starting_column": 5, "ending_column": 16}, "type_specific_fields": {"parent": {"type": "contract", "name": "BANK_SAFE", "source_mapping": {"start": 102, "length": 1087, "filename_relative": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_short": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "is_dependency": false, "lines": [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69], "starting_column": 1, "ending_column": 2}}}, "additional_fields": {"target": "variable", "convention": "mixedCase"}}], "description": "Variable BANK_SAFE.Log (shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol#15) is not in mixedCase\\n", "markdown": "Variable [BANK_SAFE.Log](shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol#L15) is not in mixedCase\\n", "first_markdown_element": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol#L15", "id": "a38f6f73f21b6f7085216bc23d7abdf49c7f6ba83f647e11c154b211315227d7", "check": "naming-convention", "impact": "Informational", "confidence": "High"}, {"elements": [{"type": "variable", "name": "_data", "source_mapping": {"start": 1440, "length": 12, "filename_relative": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_short": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "is_dependency": false, "lines": [87], "starting_column": 48, "ending_column": 60}, "type_specific_fields": {"parent": {"type": "function", "name": "AddMessage", "source_mapping": {"start": 1397, "length": 227, "filename_relative": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_short": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "is_dependency": false, "lines": [87, 88, 89, 90, 91, 92, 93, 94, 95], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "LogFile", "source_mapping": {"start": 1193, "length": 433, "filename_relative": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_short": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "is_dependency": false, "lines": [73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97], "starting_column": 1, "ending_column": 0}}, "signature": "AddMessage(address,uint256,string)"}}}, "additional_fields": {"target": "parameter", "convention": "mixedCase"}}], "description": "Parameter LogFile.AddMessage(address,uint256,string)._data (shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol#87) is not in mixedCase\\n", "markdown": "Parameter [LogFile.AddMessage(address,uint256,string)._data](shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol#L87) is not in mixedCase\\n", "first_markdown_element": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol#L87", "id": "a6f2a0ac722b4593384968d36061cec8fc4a6b47fc330ab890529adb383f824c", "check": "naming-convention", "impact": "Informational", "confidence": "High"}, {"elements": [{"type": "variable", "name": "History", "source_mapping": {"start": 1336, "length": 24, "filename_relative": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_short": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "is_dependency": false, "lines": [83], "starting_column": 5, "ending_column": 29}, "type_specific_fields": {"parent": {"type": "contract", "name": "LogFile", "source_mapping": {"start": 1193, "length": 433, "filename_relative": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_short": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "is_dependency": false, "lines": [73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97], "starting_column": 1, "ending_column": 0}}}, "additional_fields": {"target": "variable", "convention": "mixedCase"}}], "description": "Variable LogFile.History (shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol#83) is not in mixedCase\\n", "markdown": "Variable [LogFile.History](shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol#L83) is not in mixedCase\\n", "first_markdown_element": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol#L83", "id": "b8959d9d2a75b6d3dc23575557af2bbedbf431be60d598fd962b395014d6161c", "check": "naming-convention", "impact": "Informational", "confidence": "High"}, {"elements": [{"type": "function", "name": "AddMessage", "source_mapping": {"start": 1397, "length": 227, "filename_relative": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_short": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "is_dependency": false, "lines": [87, 88, 89, 90, 91, 92, 93, 94, 95], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "LogFile", "source_mapping": {"start": 1193, "length": 433, "filename_relative": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_short": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "is_dependency": false, "lines": [73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97], "starting_column": 1, "ending_column": 0}}, "signature": "AddMessage(address,uint256,string)"}, "additional_fields": {"target": "function", "convention": "mixedCase"}}], "description": "Function LogFile.AddMessage(address,uint256,string) (shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol#87-95) is not in mixedCase\\n", "markdown": "Function [LogFile.AddMessage(address,uint256,string)](shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol#L87-L95) is not in mixedCase\\n", "first_markdown_element": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol#L87-L95", "id": "c41211972cdd4933efc27c9f5968e9bc2825027b81e30a2717370b67b0dc86e9", "check": "naming-convention", "impact": "Informational", "confidence": "High"}, {"elements": [{"type": "variable", "name": "_val", "source_mapping": {"start": 279, "length": 9, "filename_relative": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_short": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "is_dependency": false, "lines": [19], "starting_column": 24, "ending_column": 33}, "type_specific_fields": {"parent": {"type": "function", "name": "SetMinSum", "source_mapping": {"start": 260, "length": 105, "filename_relative": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_short": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "is_dependency": false, "lines": [19, 20, 21, 22, 23, 24], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "BANK_SAFE", "source_mapping": {"start": 102, "length": 1087, "filename_relative": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_short": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "is_dependency": false, "lines": [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69], "starting_column": 1, "ending_column": 2}}, "signature": "SetMinSum(uint256)"}}}, "additional_fields": {"target": "parameter", "convention": "mixedCase"}}], "description": "Parameter BANK_SAFE.SetMinSum(uint256)._val (shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol#19) is not in mixedCase\\n", "markdown": "Parameter [BANK_SAFE.SetMinSum(uint256)._val](shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol#L19) is not in mixedCase\\n", "first_markdown_element": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol#L19", "id": "c4a8b6b29301d5eca2f711e1877e4c78265a2255897ae4a97936b9e4cecd2efa", "check": "naming-convention", "impact": "Informational", "confidence": "High"}, {"elements": [{"type": "function", "name": "Deposit", "source_mapping": {"start": 583, "length": 147, "filename_relative": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_short": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "is_dependency": false, "lines": [39, 40, 41, 42, 43, 44, 45], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "BANK_SAFE", "source_mapping": {"start": 102, "length": 1087, "filename_relative": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_short": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "is_dependency": false, "lines": [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69], "starting_column": 1, "ending_column": 2}}, "signature": "Deposit()"}, "additional_fields": {"target": "function", "convention": "mixedCase"}}], "description": "Function BANK_SAFE.Deposit() (shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol#39-45) is not in mixedCase\\n", "markdown": "Function [BANK_SAFE.Deposit()](shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol#L39-L45) is not in mixedCase\\n", "first_markdown_element": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol#L39-L45", "id": "c9c18724e7f34e76b9ece2328f372dca3febffba2b0c202a2c934eaaf08e6de6", "check": "naming-convention", "impact": "Informational", "confidence": "High"}, {"elements": [{"type": "function", "name": "SetLogFile", "source_mapping": {"start": 375, "length": 115, "filename_relative": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_short": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "is_dependency": false, "lines": [26, 27, 28, 29, 30, 31], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "BANK_SAFE", "source_mapping": {"start": 102, "length": 1087, "filename_relative": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_short": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "is_dependency": false, "lines": [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69], "starting_column": 1, "ending_column": 2}}, "signature": "SetLogFile(address)"}, "additional_fields": {"target": "function", "convention": "mixedCase"}}], "description": "Function BANK_SAFE.SetLogFile(address) (shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol#26-31) is not in mixedCase\\n", "markdown": "Function [BANK_SAFE.SetLogFile(address)](shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol#L26-L31) is not in mixedCase\\n", "first_markdown_element": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol#L26-L31", "id": "f36a96501fd841c32dbd2fe5385970fa00e3e85d5f5ebcbd6221dd60d1e1d244", "check": "naming-convention", "impact": "Informational", "confidence": "High"}, {"elements": [{"type": "function", "name": "AddMessage", "source_mapping": {"start": 1397, "length": 227, "filename_relative": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_short": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "is_dependency": false, "lines": [87, 88, 89, 90, 91, 92, 93, 94, 95], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "LogFile", "source_mapping": {"start": 1193, "length": 433, "filename_relative": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "filename_short": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol", "is_dependency": false, "lines": [73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97], "starting_column": 1, "ending_column": 0}}, "signature": "AddMessage(address,uint256,string)"}}], "description": "AddMessage(address,uint256,string) should be declared external:\\n\\t- LogFile.AddMessage(address,uint256,string) (shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol#87-95)\\n", "markdown": "AddMessage(address,uint256,string) should be declared external:\\n\\t- [LogFile.AddMessage(address,uint256,string)](shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol#L87-L95)\\n", "first_markdown_element": "shared/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31.sol#L87-L95", "id": "25d2235fb844b90cf9e56ea1c1b8b9cc6e32b18540f2108e0523adc1b1b6c004", "check": "external-function", "impact": "Optimization", "confidence": "High"}]}}\n' 

2024-07-04 18:41:33,792 - root - INFO - 
Found 2 vulnerabilities of severity Medium 

2024-07-04 18:41:38,997 - root - INFO - 
NEW CODE: pragma solidity ^0.4.19;

contract BANK_SAFE {
    mapping (address => uint256) public balances;
    
    uint public MinSum;
    
    LogFile Log;
    
    bool initialized;
    
    function SetMinSum(uint _val) public {
        require(!initialized);
        MinSum = _val;
    }
    
    function SetLogFile(address _log) public {
        require(!initialized);
        Log = LogFile(_log);
    }
    
    function Initialized() public {
        initialized = true;
    }
    
    function Deposit() public payable {
        balances[msg.sender] += msg.value;
        Log.AddMessage(msg.sender, msg.value, "Put");
    }
    
    function Collect(uint _am) public {
        require(balances[msg.sender] >= MinSum && balances[msg.sender] >= _am);
        
        uint amount = _am;
        balances[msg.sender] -= amount;
        Log.AddMessage(msg.sender, amount, "Collect");
        
        require(msg.sender.call.value(amount)());
    }
    
    function() public payable {
        Deposit();
    }
}

contract LogFile {
    struct Message {
        address Sender;
        string Data;
        uint Val;
        uint Time;
    }
    
    Message[] public History;
    
    function AddMessage(address _adr, uint _val, string _data) public {
        Message memory newMessage;
        newMessage.Sender = _adr;
        newMessage.Time = now;
        newMessage.Val = _val;
        newMessage.Data = _data;
        History.push(newMessage);
    }
} 

2024-07-04 18:41:38,997 - root - INFO - 
try 2/4: /home/mokita/sc_study/smartbugs-curated/dataset/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31_2round.sol  

2024-07-04 18:41:38,997 - root - INFO - 
Found 2 vulnerabilities of severity Medium 

2024-07-04 18:41:43,909 - root - INFO - 
NEW CODE: Here is the fixed contract with the vulnerabilities addressed:

```solidity
pragma solidity ^0.4.19;

contract BANK_SAFE {
    mapping (address => uint256) public balances;
    uint public MinSum;
    LogFile Log;
    bool initialized;

    function SetMinSum(uint _val) public {
        require(!initialized);
        MinSum = _val;
    }

    function SetLogFile(address _log) public {
        require(!initialized);
        Log = LogFile(_log);
    }

    function Initialized() public {
        initialized = true;
    }

    function Deposit() public payable {
        balances[msg.sender] += msg.value;
        Log.AddMessage(msg.sender, msg.value, "Put");
    }

    function Collect(uint _am) public {
        require(balances[msg.sender] >= MinSum && balances[msg.sender] >= _am);
        
        balances[msg.sender] -= _am;
        Log.AddMessage(msg.sender, _am, "Collect");
        
        require(msg.sender.call.value(_am)());
    }

    function() public payable {
        Deposit();
    }
}

contract LogFile {
    struct Message {
        address Sender;
        string Data;
        uint Val;
        uint Time;
    }

    Message[] public History;

    function AddMessage(address _adr, uint _val, string _data) public {
        Message memory newMessage;
        newMessage.Sender = _adr;
        newMessage.Time = now;
        newMessage.Val = _val;
        newMessage.Data = _data;
        History.push(newMessage);
    }
}
```

Changes made:
1. Added `require` statements to check if the contract is initialized before setting MinSum and LogFile.
2. Removed the reentrancy vulnerability in the Collect function by updating the order of operations and using `require` before the external call.
3. Updated the LogFile contract to create a new Message struct instance before pushing it to the History array to prevent sharing the same struct instance across multiple messages. 

2024-07-04 18:41:43,909 - root - INFO - 
try 3/4: /home/mokita/sc_study/smartbugs-curated/dataset/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31_3round.sol  

2024-07-04 18:41:43,910 - root - INFO - 
Found 2 vulnerabilities of severity Medium 

2024-07-04 18:41:48,825 - root - INFO - 
NEW CODE: pragma solidity ^0.4.19;

contract BANK_SAFE {
    mapping (address => uint256) public balances;
    
    uint public MinSum;
    
    LogFile Log;
    
    bool initialized;
    
    function SetMinSum(uint _val) public {
        require(!initialized);
        MinSum = _val;
    }
    
    function SetLogFile(address _log) public {
        require(!initialized);
        Log = LogFile(_log);
    }
    
    function Initialized() public {
        initialized = true;
    }
    
    function Deposit() public payable {
        balances[msg.sender] += msg.value;
        Log.AddMessage(msg.sender, msg.value, "Put");
    }
    
    function Collect(uint _am) public {
        require(balances[msg.sender] >= MinSum && balances[msg.sender] >= _am);
        
        uint amount = _am;
        balances[msg.sender] -= amount;
        Log.AddMessage(msg.sender, amount, "Collect");
        
        msg.sender.transfer(amount);
    }
    
    function() public payable {
        Deposit();
    }
}

contract LogFile {
    struct Message {
        address Sender;
        string Data;
        uint Val;
        uint Time;
    }
    
    Message[] public History;
    
    function AddMessage(address _adr, uint _val, string _data) public {
        Message memory newMessage;
        newMessage.Sender = _adr;
        newMessage.Time = now;
        newMessage.Val = _val;
        newMessage.Data = _data;
        History.push(newMessage);
    }
} 

2024-07-04 18:41:48,825 - root - INFO - 
try 4/4: /home/mokita/sc_study/smartbugs-curated/dataset/reentrancy/0x561eac93c92360949ab1f1403323e6db345cbf31_4round.sol  

2024-07-04 18:41:48,825 - root - INFO - 
Found 2 vulnerabilities of severity Medium 

2024-07-04 18:41:54,220 - root - INFO - 
NEW CODE: Here is the fixed contract with the vulnerabilities addressed:

```solidity
pragma solidity ^0.4.19;

contract BANK_SAFE {
    mapping (address => uint256) public balances;
    uint public MinSum;
    LogFile Log;
    bool initialized;

    function SetMinSum(uint _val) public {
        require(!initialized);
        MinSum = _val;
    }

    function SetLogFile(address _log) public {
        require(!initialized);
        Log = LogFile(_log);
    }

    function Initialized() public {
        initialized = true;
    }

    function Deposit() public payable {
        balances[msg.sender] += msg.value;
        Log.AddMessage(msg.sender, msg.value, "Put");
    }

    function Collect(uint _am) public {
        require(balances[msg.sender] >= MinSum && balances[msg.sender] >= _am);
        
        balances[msg.sender] -= _am;
        Log.AddMessage(msg.sender, _am, "Collect");
        
        require(msg.sender.call.value(_am)());
    }

    function() public payable {
        Deposit();
    }
}

contract LogFile {
    struct Message {
        address Sender;
        string Data;
        uint Val;
        uint Time;
    }

    Message[] public History;

    function AddMessage(address _adr, uint _val, string _data) public {
        Message memory newMessage;
        newMessage.Sender = _adr;
        newMessage.Time = now;
        newMessage.Val = _val;
        newMessage.Data = _data;
        History.push(newMessage);
    }
}
```

Changes made:
1. Added `require` statements to check if the contract is initialized before setting MinSum and LogFile.
2. Moved the deduction of balance and logging before the external call in the Collect function to prevent reentrancy issues.
3. Used a local variable to store the new message in the LogFile contract to prevent sharing the same struct instance across multiple calls. 

