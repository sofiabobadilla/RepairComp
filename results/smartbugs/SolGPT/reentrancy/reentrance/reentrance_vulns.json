{"success": true, "error": null, "results": {"detectors": [{"elements": [{"type": "function", "name": "withdraw", "source_mapping": {"start": 451, "length": 236, "filename_relative": "shared/reentrancy/reentrance.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/reentrance.sol", "filename_short": "shared/reentrancy/reentrance.sol", "is_dependency": false, "lines": [21, 22, 23, 24, 25, 26, 27, 28, 29], "starting_column": 3, "ending_column": 4}, "type_specific_fields": {"parent": {"type": "contract", "name": "Reentrance", "source_mapping": {"start": 192, "length": 529, "filename_relative": "shared/reentrancy/reentrance.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/reentrance.sol", "filename_short": "shared/reentrancy/reentrance.sol", "is_dependency": false, "lines": [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32], "starting_column": 1, "ending_column": 2}}, "signature": "withdraw(uint256)"}}, {"type": "node", "name": "msg.sender.call.value(_amount)()", "source_mapping": {"start": 578, "length": 32, "filename_relative": "shared/reentrancy/reentrance.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/reentrance.sol", "filename_short": "shared/reentrancy/reentrance.sol", "is_dependency": false, "lines": [24], "starting_column": 10, "ending_column": 42}, "type_specific_fields": {"parent": {"type": "function", "name": "withdraw", "source_mapping": {"start": 451, "length": 236, "filename_relative": "shared/reentrancy/reentrance.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/reentrance.sol", "filename_short": "shared/reentrancy/reentrance.sol", "is_dependency": false, "lines": [21, 22, 23, 24, 25, 26, 27, 28, 29], "starting_column": 3, "ending_column": 4}, "type_specific_fields": {"parent": {"type": "contract", "name": "Reentrance", "source_mapping": {"start": 192, "length": 529, "filename_relative": "shared/reentrancy/reentrance.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/reentrance.sol", "filename_short": "shared/reentrancy/reentrance.sol", "is_dependency": false, "lines": [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32], "starting_column": 1, "ending_column": 2}}, "signature": "withdraw(uint256)"}}}, "additional_fields": {"underlying_type": "external_calls"}}, {"type": "node", "name": "balances[msg.sender] -= _amount", "source_mapping": {"start": 645, "length": 31, "filename_relative": "shared/reentrancy/reentrance.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/reentrance.sol", "filename_short": "shared/reentrancy/reentrance.sol", "is_dependency": false, "lines": [27], "starting_column": 7, "ending_column": 38}, "type_specific_fields": {"parent": {"type": "function", "name": "withdraw", "source_mapping": {"start": 451, "length": 236, "filename_relative": "shared/reentrancy/reentrance.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/reentrance.sol", "filename_short": "shared/reentrancy/reentrance.sol", "is_dependency": false, "lines": [21, 22, 23, 24, 25, 26, 27, 28, 29], "starting_column": 3, "ending_column": 4}, "type_specific_fields": {"parent": {"type": "contract", "name": "Reentrance", "source_mapping": {"start": 192, "length": 529, "filename_relative": "shared/reentrancy/reentrance.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/reentrance.sol", "filename_short": "shared/reentrancy/reentrance.sol", "is_dependency": false, "lines": [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32], "starting_column": 1, "ending_column": 2}}, "signature": "withdraw(uint256)"}}}, "additional_fields": {"underlying_type": "variables_written", "variable_name": "balances"}}], "description": "Reentrancy in Reentrance.withdraw(uint256) (shared/reentrancy/reentrance.sol#21-29):\n\tExternal calls:\n\t- msg.sender.call.value(_amount)() (shared/reentrancy/reentrance.sol#24)\n\tState variables written after the call(s):\n\t- balances[msg.sender] -= _amount (shared/reentrancy/reentrance.sol#27)\n\tReentrance.balances (shared/reentrancy/reentrance.sol#11) can be used in cross function reentrancies:\n\t- Reentrance.balanceOf(address) (shared/reentrancy/reentrance.sol#17-19)\n\t- Reentrance.balances (shared/reentrancy/reentrance.sol#11)\n\t- Reentrance.donate(address) (shared/reentrancy/reentrance.sol#13-15)\n\t- Reentrance.withdraw(uint256) (shared/reentrancy/reentrance.sol#21-29)\n", "markdown": "Reentrancy in [Reentrance.withdraw(uint256)](shared/reentrancy/reentrance.sol#L21-L29):\n\tExternal calls:\n\t- [msg.sender.call.value(_amount)()](shared/reentrancy/reentrance.sol#L24)\n\tState variables written after the call(s):\n\t- [balances[msg.sender] -= _amount](shared/reentrancy/reentrance.sol#L27)\n\t[Reentrance.balances](shared/reentrancy/reentrance.sol#L11) can be used in cross function reentrancies:\n\t- [Reentrance.balanceOf(address)](shared/reentrancy/reentrance.sol#L17-L19)\n\t- [Reentrance.balances](shared/reentrancy/reentrance.sol#L11)\n\t- [Reentrance.donate(address)](shared/reentrancy/reentrance.sol#L13-L15)\n\t- [Reentrance.withdraw(uint256)](shared/reentrancy/reentrance.sol#L21-L29)\n", "first_markdown_element": "shared/reentrancy/reentrance.sol#L21-L29", "id": "2d6cfd0c151db295794da1454d48155befd5f364c7688964e14db6af6139545b", "check": "reentrancy-eth", "impact": "High", "confidence": "Medium"}, {"elements": [{"type": "pragma", "name": "^0.4.18", "source_mapping": {"start": 166, "length": 24, "filename_relative": "shared/reentrancy/reentrance.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/reentrance.sol", "filename_short": "shared/reentrancy/reentrance.sol", "is_dependency": false, "lines": [7], "starting_column": 1, "ending_column": 25}, "type_specific_fields": {"directive": ["solidity", "^", "0.4", ".18"]}}], "description": "Pragma version^0.4.18 (shared/reentrancy/reentrance.sol#7) allows old versions\n", "markdown": "Pragma version[^0.4.18](shared/reentrancy/reentrance.sol#L7) allows old versions\n", "first_markdown_element": "shared/reentrancy/reentrance.sol#L7", "id": "4252555b888a0ebae5301c9951b1f677963f723bd13c952a92913caf465f3c6e", "check": "solc-version", "impact": "Informational", "confidence": "High"}, {"elements": [], "description": "solc-0.4.18 is not recommended for deployment\n", "markdown": "solc-0.4.18 is not recommended for deployment\n", "first_markdown_element": "", "id": "d780a9ee0403516f20d8088a98408a088ad9a9e2173b73cd90b7830e00be1dd4", "check": "solc-version", "impact": "Informational", "confidence": "High"}, {"elements": [{"type": "function", "name": "withdraw", "source_mapping": {"start": 451, "length": 236, "filename_relative": "shared/reentrancy/reentrance.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/reentrance.sol", "filename_short": "shared/reentrancy/reentrance.sol", "is_dependency": false, "lines": [21, 22, 23, 24, 25, 26, 27, 28, 29], "starting_column": 3, "ending_column": 4}, "type_specific_fields": {"parent": {"type": "contract", "name": "Reentrance", "source_mapping": {"start": 192, "length": 529, "filename_relative": "shared/reentrancy/reentrance.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/reentrance.sol", "filename_short": "shared/reentrancy/reentrance.sol", "is_dependency": false, "lines": [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32], "starting_column": 1, "ending_column": 2}}, "signature": "withdraw(uint256)"}}, {"type": "node", "name": "msg.sender.call.value(_amount)()", "source_mapping": {"start": 578, "length": 32, "filename_relative": "shared/reentrancy/reentrance.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/reentrance.sol", "filename_short": "shared/reentrancy/reentrance.sol", "is_dependency": false, "lines": [24], "starting_column": 10, "ending_column": 42}, "type_specific_fields": {"parent": {"type": "function", "name": "withdraw", "source_mapping": {"start": 451, "length": 236, "filename_relative": "shared/reentrancy/reentrance.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/reentrance.sol", "filename_short": "shared/reentrancy/reentrance.sol", "is_dependency": false, "lines": [21, 22, 23, 24, 25, 26, 27, 28, 29], "starting_column": 3, "ending_column": 4}, "type_specific_fields": {"parent": {"type": "contract", "name": "Reentrance", "source_mapping": {"start": 192, "length": 529, "filename_relative": "shared/reentrancy/reentrance.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/reentrance.sol", "filename_short": "shared/reentrancy/reentrance.sol", "is_dependency": false, "lines": [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32], "starting_column": 1, "ending_column": 2}}, "signature": "withdraw(uint256)"}}}}], "description": "Low level call in Reentrance.withdraw(uint256) (shared/reentrancy/reentrance.sol#21-29):\n\t- msg.sender.call.value(_amount)() (shared/reentrancy/reentrance.sol#24)\n", "markdown": "Low level call in [Reentrance.withdraw(uint256)](shared/reentrancy/reentrance.sol#L21-L29):\n\t- [msg.sender.call.value(_amount)()](shared/reentrancy/reentrance.sol#L24)\n", "first_markdown_element": "shared/reentrancy/reentrance.sol#L21-L29", "id": "50adb208a8bc6e84608467e2e95fe62e06e3aedbff5fbca25b4718ffffa85d9c", "check": "low-level-calls", "impact": "Informational", "confidence": "High"}, {"elements": [{"type": "variable", "name": "_who", "source_mapping": {"start": 366, "length": 12, "filename_relative": "shared/reentrancy/reentrance.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/reentrance.sol", "filename_short": "shared/reentrancy/reentrance.sol", "is_dependency": false, "lines": [17], "starting_column": 22, "ending_column": 34}, "type_specific_fields": {"parent": {"type": "function", "name": "balanceOf", "source_mapping": {"start": 347, "length": 100, "filename_relative": "shared/reentrancy/reentrance.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/reentrance.sol", "filename_short": "shared/reentrancy/reentrance.sol", "is_dependency": false, "lines": [17, 18, 19], "starting_column": 3, "ending_column": 4}, "type_specific_fields": {"parent": {"type": "contract", "name": "Reentrance", "source_mapping": {"start": 192, "length": 529, "filename_relative": "shared/reentrancy/reentrance.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/reentrance.sol", "filename_short": "shared/reentrancy/reentrance.sol", "is_dependency": false, "lines": [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32], "starting_column": 1, "ending_column": 2}}, "signature": "balanceOf(address)"}}}, "additional_fields": {"target": "parameter", "convention": "mixedCase"}}], "description": "Parameter Reentrance.balanceOf(address)._who (shared/reentrancy/reentrance.sol#17) is not in mixedCase\n", "markdown": "Parameter [Reentrance.balanceOf(address)._who](shared/reentrancy/reentrance.sol#L17) is not in mixedCase\n", "first_markdown_element": "shared/reentrancy/reentrance.sol#L17", "id": "0c9ca9668911f43b0d68bedc5e042f5ef3a3122d790a1dbd04b862c43e69bbe6", "check": "naming-convention", "impact": "Informational", "confidence": "High"}, {"elements": [{"type": "variable", "name": "_amount", "source_mapping": {"start": 469, "length": 12, "filename_relative": "shared/reentrancy/reentrance.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/reentrance.sol", "filename_short": "shared/reentrancy/reentrance.sol", "is_dependency": false, "lines": [21], "starting_column": 21, "ending_column": 33}, "type_specific_fields": {"parent": {"type": "function", "name": "withdraw", "source_mapping": {"start": 451, "length": 236, "filename_relative": "shared/reentrancy/reentrance.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/reentrance.sol", "filename_short": "shared/reentrancy/reentrance.sol", "is_dependency": false, "lines": [21, 22, 23, 24, 25, 26, 27, 28, 29], "starting_column": 3, "ending_column": 4}, "type_specific_fields": {"parent": {"type": "contract", "name": "Reentrance", "source_mapping": {"start": 192, "length": 529, "filename_relative": "shared/reentrancy/reentrance.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/reentrance.sol", "filename_short": "shared/reentrancy/reentrance.sol", "is_dependency": false, "lines": [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32], "starting_column": 1, "ending_column": 2}}, "signature": "withdraw(uint256)"}}}, "additional_fields": {"target": "parameter", "convention": "mixedCase"}}], "description": "Parameter Reentrance.withdraw(uint256)._amount (shared/reentrancy/reentrance.sol#21) is not in mixedCase\n", "markdown": "Parameter [Reentrance.withdraw(uint256)._amount](shared/reentrancy/reentrance.sol#L21) is not in mixedCase\n", "first_markdown_element": "shared/reentrancy/reentrance.sol#L21", "id": "4964ce8b89bc827fe3f014148cf52f520ddffd5ea47e24b090cde2a6d31044a8", "check": "naming-convention", "impact": "Informational", "confidence": "High"}, {"elements": [{"type": "variable", "name": "_to", "source_mapping": {"start": 278, "length": 11, "filename_relative": "shared/reentrancy/reentrance.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/reentrance.sol", "filename_short": "shared/reentrancy/reentrance.sol", "is_dependency": false, "lines": [13], "starting_column": 19, "ending_column": 30}, "type_specific_fields": {"parent": {"type": "function", "name": "donate", "source_mapping": {"start": 262, "length": 81, "filename_relative": "shared/reentrancy/reentrance.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/reentrance.sol", "filename_short": "shared/reentrancy/reentrance.sol", "is_dependency": false, "lines": [13, 14, 15], "starting_column": 3, "ending_column": 4}, "type_specific_fields": {"parent": {"type": "contract", "name": "Reentrance", "source_mapping": {"start": 192, "length": 529, "filename_relative": "shared/reentrancy/reentrance.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/reentrance.sol", "filename_short": "shared/reentrancy/reentrance.sol", "is_dependency": false, "lines": [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32], "starting_column": 1, "ending_column": 2}}, "signature": "donate(address)"}}}, "additional_fields": {"target": "parameter", "convention": "mixedCase"}}], "description": "Parameter Reentrance.donate(address)._to (shared/reentrancy/reentrance.sol#13) is not in mixedCase\n", "markdown": "Parameter [Reentrance.donate(address)._to](shared/reentrancy/reentrance.sol#L13) is not in mixedCase\n", "first_markdown_element": "shared/reentrancy/reentrance.sol#L13", "id": "e34d72100b63c3631cb5c091604e1c910754558ad359e402e63e27632f6a0df9", "check": "naming-convention", "impact": "Informational", "confidence": "High"}, {"elements": [{"type": "node", "name": "_amount", "source_mapping": {"start": 622, "length": 7, "filename_relative": "shared/reentrancy/reentrance.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/reentrance.sol", "filename_short": "shared/reentrancy/reentrance.sol", "is_dependency": false, "lines": [25], "starting_column": 9, "ending_column": 16}, "type_specific_fields": {"parent": {"type": "function", "name": "withdraw", "source_mapping": {"start": 451, "length": 236, "filename_relative": "shared/reentrancy/reentrance.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/reentrance.sol", "filename_short": "shared/reentrancy/reentrance.sol", "is_dependency": false, "lines": [21, 22, 23, 24, 25, 26, 27, 28, 29], "starting_column": 3, "ending_column": 4}, "type_specific_fields": {"parent": {"type": "contract", "name": "Reentrance", "source_mapping": {"start": 192, "length": 529, "filename_relative": "shared/reentrancy/reentrance.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/reentrance.sol", "filename_short": "shared/reentrancy/reentrance.sol", "is_dependency": false, "lines": [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32], "starting_column": 1, "ending_column": 2}}, "signature": "withdraw(uint256)"}}}}, {"type": "contract", "name": "Reentrance", "source_mapping": {"start": 192, "length": 529, "filename_relative": "shared/reentrancy/reentrance.sol", "filename_absolute": "/home/ethsec/shared/reentrancy/reentrance.sol", "filename_short": "shared/reentrancy/reentrance.sol", "is_dependency": false, "lines": [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32], "starting_column": 1, "ending_column": 2}}], "description": "Redundant expression \"_amount (shared/reentrancy/reentrance.sol#25)\" inReentrance (shared/reentrancy/reentrance.sol#9-32)\n", "markdown": "Redundant expression \"[_amount](shared/reentrancy/reentrance.sol#L25)\" in[Reentrance](shared/reentrancy/reentrance.sol#L9-L32)\n", "first_markdown_element": "shared/reentrancy/reentrance.sol#L25", "id": "4fd0cc9e7b7cb8dadc5b119203db65795916f2ab1ac0f832f89ee9b43d1617ed", "check": "redundant-statements", "impact": "Informational", "confidence": "High"}]}}